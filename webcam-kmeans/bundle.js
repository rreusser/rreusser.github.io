!function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return i(n||e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(e,t,n){(function(n){"use strict";function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return n.Buffer&&"function"==typeof n.Buffer.isBuffer?n.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=e("util/"),a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,c="foo"===function(){}.name;function u(e){return Object.prototype.toString.call(e)}function f(e){return!i(e)&&("function"==typeof n.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var l=t.exports=g,p=/\s*function\s+([^\(\s]*)\s*/;function d(e){if(o.isFunction(e)){if(c)return e.name;var t=e.toString().match(p);return t&&t[1]}}function h(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function m(e){if(c||!o.isFunction(e))return o.inspect(e);var t=d(e);return"[Function"+(t?": "+t:"")+"]"}function v(e,t,n,r,i){throw new l.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function g(e,t){e||v(e,!0,t,"==",l.ok)}function b(e,t,n,a){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(f(e)&&f(t)&&u(e)===u(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;var c=(a=a||{actual:[],expected:[]}).actual.indexOf(e);return-1!==c&&c===a.expected.indexOf(t)||(a.actual.push(e),a.expected.push(t),function(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=y(e),a=y(t);if(i&&!a||!i&&a)return!1;if(i)return e=s.call(e),t=s.call(t),b(e,t,n);var c,u,f=_(e),l=_(t);if(f.length!==l.length)return!1;for(f.sort(),l.sort(),u=f.length-1;u>=0;u--)if(f[u]!==l[u])return!1;for(u=f.length-1;u>=0;u--)if(c=f[u],!b(e[c],t[c],n,r))return!1;return!0}(e,t,n,a))}return n?e===t:e==t}function y(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function w(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function x(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&v(i,n,"Missing expected exception"+r);var a="string"==typeof r,s=!e&&o.isError(i),c=!e&&i&&!n;if((s&&a&&w(i,n)||c)&&v(i,n,"Got unwanted exception"+r),e&&i&&n&&!w(i,n)||!e&&i)throw i}l.AssertionError=function(e){var t;this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=h(m((t=this).actual),128)+" "+t.operator+" "+h(m(t.expected),128),this.generatedMessage=!0);var n=e.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,n);else{var r=new Error;if(r.stack){var i=r.stack,o=d(n),a=i.indexOf("\n"+o);if(a>=0){var s=i.indexOf("\n",a+1);i=i.substring(s+1)}this.stack=i}}},o.inherits(l.AssertionError,Error),l.fail=v,l.ok=g,l.equal=function(e,t,n){e!=t&&v(e,t,n,"==",l.equal)},l.notEqual=function(e,t,n){e==t&&v(e,t,n,"!=",l.notEqual)},l.deepEqual=function(e,t,n){b(e,t,!1)||v(e,t,n,"deepEqual",l.deepEqual)},l.deepStrictEqual=function(e,t,n){b(e,t,!0)||v(e,t,n,"deepStrictEqual",l.deepStrictEqual)},l.notDeepEqual=function(e,t,n){b(e,t,!1)&&v(e,t,n,"notDeepEqual",l.notDeepEqual)},l.notDeepStrictEqual=function e(t,n,r){b(t,n,!0)&&v(t,n,r,"notDeepStrictEqual",e)},l.strictEqual=function(e,t,n){e!==t&&v(e,t,n,"===",l.strictEqual)},l.notStrictEqual=function(e,t,n){e===t&&v(e,t,n,"!==",l.notStrictEqual)},l.throws=function(e,t,n){x(!0,e,t,n)},l.doesNotThrow=function(e,t,n){x(!1,e,t,n)},l.ifError=function(e){if(e)throw e};var _=Object.keys||function(e){var t=[];for(var n in e)a.call(e,n)&&t.push(n);return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"util/":56}],2:[function(e,t,n){"use strict";n.byteLength=function(e){return 3*e.length/4-u(e)},n.toByteArray=function(e){var t,n,r,a,s,c=e.length;a=u(e),s=new o(3*c/4-a),n=a>0?c-4:c;var f=0;for(t=0;t<n;t+=4)r=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)],s[f++]=r>>16&255,s[f++]=r>>8&255,s[f++]=255&r;2===a?(r=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4,s[f++]=255&r):1===a&&(r=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2,s[f++]=r>>8&255,s[f++]=255&r);return s},n.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o="",a=[],s=0,c=n-i;s<c;s+=16383)a.push(f(e,s,s+16383>c?c:s+16383));1===i?(t=e[n-1],o+=r[t>>2],o+=r[t<<4&63],o+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],o+=r[t>>10],o+=r[t>>4&63],o+=r[t<<2&63],o+="=");return a.push(o),a.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function f(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],3:[function(e,t,n){"use strict";var r=e("base64-js"),i=e("ieee754");n.Buffer=s,n.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},n.INSPECT_MAX_BYTES=50;var o=2147483647;function a(e){if(e>o)throw new RangeError("Invalid typed array length");var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(e)}return c(e,t,n)}function c(e,t,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return F(e)||e&&F(e.buffer)?function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n);return r.__proto__=s.prototype,r}(e,t,n):"string"==typeof e?function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|d(e,t),r=a(n),i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t):function(e){if(s.isBuffer(e)){var t=0|p(e.length),n=a(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}if(e){if(ArrayBuffer.isView(e)||"length"in e)return"number"!=typeof e.length||N(e.length)?a(0):l(e);if("Buffer"===e.type&&Array.isArray(e.data))return l(e.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e){return u(e),a(e<0?0:0|p(e))}function l(e){for(var t=e.length<0?0:0|p(e.length),n=a(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function d(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||F(e))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(r)return z(e).length;t=(""+t).toLowerCase(),r=!0}}function h(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),N(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var f=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===c)return f*a}else-1!==f&&(o-=o-f),f=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var l=!0,p=0;p<c;p++)if(u(e,o+p)!==u(t,p)){l=!1;break}if(l)return o}return-1}function g(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(N(s))return a;e[n+a]=s}return a}function b(e,t,n,r){return U(z(t,e.length-n),e,n,r)}function y(e,t,n,r){return U(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return y(e,t,n,r)}function x(e,t,n,r){return U(I(t),e,n,r)}function _(e,t,n,r){return U(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,c,u=e[i],f=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l<=n)switch(l){case 1:u<128&&(f=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(f=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=l}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=k));return n}(r)}n.kMaxLength=o,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{get:function(){if(this instanceof s)return this.buffer}}),Object.defineProperty(s.prototype,"offset",{get:function(){if(this instanceof s)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,n){return c(e,t,n)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},s.allocUnsafe=function(e){return f(e)},s.allocUnsafeSlow=function(e){return f(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer},s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=s.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(ArrayBuffer.isView(o)&&(o=s.from(o)),!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return S(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},s.prototype.compare=function(e,t,n,r,i){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,a=n-t,c=Math.min(o,a),u=this.slice(r,i),f=e.slice(t,n),l=0;l<c;++l)if(u[l]!==f[l]){o=u[l],a=f[l];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return y(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function S(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function A(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=L(e[o]);return i}function P(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(e,t,n,r,o){return t=+t,n>>>=0,o||D(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return t=+t,n>>>=0,o||D(e,0,n,8),i.write(e,t,n,r,52,8),n+8}s.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=s.prototype,r},s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},s.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);j(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);j(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,n){return R(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return R(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var o=i-1;o>=0;--o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=s.isBuffer(e)?e:new s(e,r),c=a.length;if(0===c)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%c]}return this};var M=/[^+/0-9A-Za-z-_]/g;function L(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function I(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function F(e){return e instanceof ArrayBuffer||null!=e&&null!=e.constructor&&"ArrayBuffer"===e.constructor.name&&"number"==typeof e.byteLength}function N(e){return e!=e}},{"base64-js":2,ieee754:29}],4:[function(e,t,n){(function(e){var r,i;r=this,i=function(){"use strict";var t=function(){},n={},r=[],i=[];function o(e,o){var a,s,c,u,f=i;for(u=arguments.length;2<u--;)r.push(arguments[u]);for(o&&null!=o.children&&(r.length||r.push(o.children),delete o.children);r.length;)if((s=r.pop())&&void 0!==s.pop)for(u=s.length;u--;)r.push(s[u]);else"boolean"==typeof s&&(s=null),(c="function"!=typeof e)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(c=!1)),c&&a?f[f.length-1]+=s:f===i?f=[s]:f.push(s),a=c;var l=new t;return l.nodeName=e,l.children=f,l.attributes=null==o?void 0:o,l.key=null==o?void 0:o.key,void 0!==n.vnode&&n.vnode(l),l}function a(e,t){for(var n in t)e[n]=t[n];return e}function s(e,t){null!=e&&("function"==typeof e?e(t):e.current=t)}var c="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function u(e,t){return o(e.nodeName,a(a({},e.attributes),t),2<arguments.length?[].slice.call(arguments,2):e.children)}var f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,l=[];function p(e){!e._dirty&&(e._dirty=!0)&&1==l.push(e)&&(n.debounceRendering||c)(d)}function d(){for(var e;e=l.pop();)e._dirty&&j(e)}function h(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function m(e){var t=a({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function v(e){var t=e.parentNode;t&&t.removeChild(e)}function g(e,t,n,r,i){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)s(n,null),s(r,e);else if("class"!==t||i)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(e.style[o]="");for(var o in r)e.style[o]="number"==typeof r[o]&&!1===f.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,b,a):e.removeEventListener(t,b,a),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!i&&t in e){try{e[t]=null==r?"":r}catch(e){}null!=r&&!1!==r||"spellcheck"==t||e.removeAttribute(t)}else{var c=i&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?c?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(c?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function b(e){return this._listeners[e.type](n.event&&n.event(e)||e)}var y=[],w=0,x=!1,_=!1;function C(){for(var e;e=y.shift();)n.afterMount&&n.afterMount(e),e.componentDidMount&&e.componentDidMount()}function E(e,t,n,r,i,o){w++||(x=null!=i&&void 0!==i.ownerSVGElement,_=null!=e&&!("__preactattr_"in e));var a=function e(t,n,r,i,o){var a=t,s=x;if(null!=n&&"boolean"!=typeof n||(n=""),"string"==typeof n||"number"==typeof n)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||o)?t.nodeValue!=n&&(t.nodeValue=n):(a=document.createTextNode(n),t&&(t.parentNode&&t.parentNode.replaceChild(a,t),k(t,!0))),a.__preactattr_=!0,a;var c=n.nodeName;if("function"==typeof c)return function(e,t,n,r){for(var i=e&&e._component,o=i,a=e,s=i&&e._componentConstructor===t.nodeName,c=s,u=m(t);i&&!c&&(i=i._parentComponent);)c=i.constructor===t.nodeName;return i&&c&&(!r||i._component)?(O(i,u,3,n,r),e=i.base):(o&&!s&&(D(o),e=a=null),i=A(t.nodeName,u,n),e&&!i.nextBase&&(i.nextBase=e,a=null),O(i,u,1,n,r),e=i.base,a&&e!==a&&(a._component=null,k(a,!1))),e}(t,n,r,i);if(x="svg"===c||"foreignObject"!==c&&x,c=String(c),(!t||!h(t,c))&&(a=function(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}(c,x),t)){for(;t.firstChild;)a.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(a,t),k(t,!0)}var u=a.firstChild,f=a.__preactattr_,l=n.children;if(null==f){f=a.__preactattr_={};for(var p=a.attributes,d=p.length;d--;)f[p[d].name]=p[d].value}return!_&&l&&1===l.length&&"string"==typeof l[0]&&null!=u&&void 0!==u.splitText&&null==u.nextSibling?u.nodeValue!=l[0]&&(u.nodeValue=l[0]):(l&&l.length||null!=u)&&function(t,n,r,i,o){var a,s,c,u,f,l,p,d,m=t.childNodes,g=[],b={},y=0,w=0,x=m.length,_=0,C=n?n.length:0;if(0!==x)for(var E=0;E<x;E++){var T=m[E],S=T.__preactattr_,A=C&&S?T._component?T._component.__key:S.key:null;null!=A?(y++,b[A]=T):(S||(void 0!==T.splitText?!o||T.nodeValue.trim():o))&&(g[_++]=T)}if(0!==C)for(var E=0;E<C;E++){u=n[E],f=null;var A=u.key;if(null!=A)y&&void 0!==b[A]&&(f=b[A],b[A]=void 0,y--);else if(w<_)for(a=w;a<_;a++)if(void 0!==g[a]&&(l=s=g[a],d=o,"string"==typeof(p=u)||"number"==typeof p?void 0!==l.splitText:"string"==typeof p.nodeName?!l._componentConstructor&&h(l,p.nodeName):d||l._componentConstructor===p.nodeName)){f=s,g[a]=void 0,a===_-1&&_--,a===w&&w++;break}f=e(f,u,r,i),c=m[E],f&&f!==t&&f!==c&&(null==c?t.appendChild(f):f===c.nextSibling?v(c):t.insertBefore(f,c))}if(y)for(var E in b)void 0!==b[E]&&k(b[E],!1);for(;w<=_;)void 0!==(f=g[_--])&&k(f,!1)}(a,l,r,i,_||null!=f.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||g(e,r,n[r],n[r]=void 0,x);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||g(e,r,n[r],n[r]=t[r],x)}(a,n.attributes,f),x=s,a}(e,t,n,r,o);return i&&a.parentNode!==i&&i.appendChild(a),--w||(_=!1,o||C()),a}function k(e,t){var n=e._component;n?D(n):(null!=e.__preactattr_&&s(e.__preactattr_.ref,null),!1!==t&&null!=e.__preactattr_||v(e),T(e))}function T(e){for(e=e.lastChild;e;){var t=e.previousSibling;k(e,!0),e=t}}var S=[];function A(e,t,n){var r,i=S.length;for(e.prototype&&e.prototype.render?(r=new e(t,n),R.call(r,t,n)):((r=new R(t,n)).constructor=e,r.render=P);i--;)if(S[i].constructor===e)return r.nextBase=S[i].nextBase,S.splice(i,1),r;return r}function P(e,t,n){return this.constructor(e,n)}function O(e,t,r,i,o){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||o?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,i)),i&&i!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=i),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==r&&(1!==r&&!1===n.syncComponentUpdates&&e.base?p(e):j(e,1,o)),s(e.__ref,e))}function j(e,t,r,i){if(!e._disable){var o,s,c,u=e.props,f=e.state,l=e.context,p=e.prevProps||u,d=e.prevState||f,h=e.prevContext||l,v=e.base,g=e.nextBase,b=v||g,x=e._component,_=!1,T=h;if(e.constructor.getDerivedStateFromProps&&(f=a(a({},f),e.constructor.getDerivedStateFromProps(u,f)),e.state=f),v&&(e.props=p,e.state=d,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(u,f,l)?_=!0:e.componentWillUpdate&&e.componentWillUpdate(u,f,l),e.props=u,e.state=f,e.context=l),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!_){o=e.render(u,f,l),e.getChildContext&&(l=a(a({},l),e.getChildContext())),v&&e.getSnapshotBeforeUpdate&&(T=e.getSnapshotBeforeUpdate(p,d));var S,P,R=o&&o.nodeName;if("function"==typeof R){var B=m(o);(s=x)&&s.constructor===R&&B.key==s.__key?O(s,B,1,l,!1):(S=s,e._component=s=A(R,B,l),s.nextBase=s.nextBase||g,s._parentComponent=e,O(s,B,0,l,!1),j(s,1,r,!0)),P=s.base}else c=b,(S=x)&&(c=e._component=null),(b||1===t)&&(c&&(c._component=null),P=E(c,o,l,r||!v,b&&b.parentNode,!0));if(b&&P!==b&&s!==x){var M=b.parentNode;M&&P!==M&&(M.replaceChild(P,b),S||(b._component=null,k(b,!1)))}if(S&&D(S),(e.base=P)&&!i){for(var L=e,z=e;z=z._parentComponent;)(L=z).base=P;P._component=L,P._componentConstructor=L.constructor}}for(!v||r?y.push(e):_||(e.componentDidUpdate&&e.componentDidUpdate(p,d,T),n.afterUpdate&&n.afterUpdate(e));e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);w||i||C()}}function D(e){n.beforeUnmount&&n.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var r=e._component;r?D(r):t&&(null!=t.__preactattr_&&s(t.__preactattr_.ref,null),v(e.nextBase=t),S.push(e),T(t)),s(e.__ref,null)}function R(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}function B(e,t,n){return E(n,e,{},!1,t,!1)}function M(){return{}}a(R.prototype,{setState:function(e,t){this.prevState||(this.prevState=this.state),this.state=a(a({},this.state),"function"==typeof e?e(this.state,this.props):e),t&&this._renderCallbacks.push(t),p(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),j(this,2)},render:function(){}});var L={h:o,createElement:o,cloneElement:u,createRef:M,Component:R,render:B,rerender:d,options:n},z=Object.freeze({default:L,h:o,createElement:o,cloneElement:u,createRef:M,Component:R,render:B,rerender:d,options:n}),I=[],U=[];function F(e,t){if(t=t||{},void 0===e)throw new Error("insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).");var n,r=!0===t.prepend?"prepend":"append",i=void 0!==t.container?t.container:document.querySelector("head"),o=I.indexOf(i);return-1===o&&(o=I.push(i)-1,U[o]={}),void 0!==U[o]&&void 0!==U[o][r]?n=U[o][r]:(n=U[o][r]=function(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}(),"prepend"==r?i.insertBefore(n,i.childNodes[0]):i.appendChild(n)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),n.styleSheet?n.styleSheet.cssText+=e:n.textContent+=e,n}var N=F,H=F;N.insertCss=H;var V,G,Y=(function(t){var n=function(){function t(n,i,o,a){"object"==typeof i&&(o=i.depth,a=i.prototype,i.filter,i=i.circular);var s=[],c=[],u=void 0!==e;return void 0===i&&(i=!0),void 0===o&&(o=1/0),function n(o,f){if(null===o)return null;if(0==f)return o;var l,p;if("object"!=typeof o)return o;if(t.__isArray(o))l=[];else if(t.__isRegExp(o))l=new RegExp(o.source,r(o)),o.lastIndex&&(l.lastIndex=o.lastIndex);else if(t.__isDate(o))l=new Date(o.getTime());else{if(u&&e.isBuffer(o))return l=e.allocUnsafe?e.allocUnsafe(o.length):new e(o.length),o.copy(l),l;void 0===a?(p=Object.getPrototypeOf(o),l=Object.create(p)):(l=Object.create(a),p=a)}if(i){var d=s.indexOf(o);if(-1!=d)return c[d];s.push(o),c.push(l)}for(var h in o){var m;p&&(m=Object.getOwnPropertyDescriptor(p,h)),m&&null==m.set||(l[h]=n(o[h],f-1))}return l}(n,o)}function n(e){return Object.prototype.toString.call(e)}function r(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return t.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},t.__objToStr=n,t.__isDate=function(e){return"object"==typeof e&&"[object Date]"===n(e)},t.__isArray=function(e){return"object"==typeof e&&"[object Array]"===n(e)},t.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===n(e)},t.__getRegExpFlags=r,t}();t.exports&&(t.exports=n)}(V={exports:{}}),V.exports),q=function(e,t){return e=e||{},Object.keys(t).forEach(function(n){void 0===e[n]&&(e[n]=Y(t[n]))}),e},W=(G=z)&&G.default||G,$=function(e){function t(){for(var t in W.Component.apply(this,arguments),e)"render"!==t&&"function"==typeof e[t]&&(this[t]=e[t].bind(this));e.init&&e.init.call(this)}return(t.prototype=Object.assign(Object.create(W.Component.prototype),e)).constructor=t},X=function(e){return/^[0-9\.\s]*$/.test(e=""+e)?e+"px":e},Q={fontFamily:"'Helvetica', sans-serif",fontSize:13,sliderHeight:22,controlBgColor:"#444",fieldBgColor:"#333",fieldHoverColor:"#383838",fieldActiveColor:"#383838",fieldBorderColor:"#232323",fieldHeight:30,sectionHeadingBgColor:"#222",sectionHeadingHoverColor:"#444",sectionHeadingColor:"#e8e8e8",sectionHeadingBorderColor:"#222",inactiveTabBgColor:"#333",inactiveTabColor:"#ccc",inactiveTabHoverBgColor:"#444",inactiveTabHoverColor:"#ccc",activeTabBgColor:"#555",activeTabColor:"#fff",controlBorderColor:"#666",sliderThumbColor:"#888",fontColor:"#e8e8e8",sectionHeadingHeight:24,minLabelWidth:110,minControlWidth:130,visibilityFontColor:"rgba(0, 0, 0, 0.3)",focusBorderColor:"#888",controlBorderRadius:2},J=W.h,Z={name:"select",component:$({render:function(){var e=this,t=this.props.field,n=t.$config,r=this.props.className;return J("div",{className:r+"__field "+r+"__field--select"},J("label",{className:r+"__label",htmlFor:r+"-"+t.path},J("span",{className:r+"__labelText"},n.label||t.name)," ",J("span",{className:r+"__container"},J("select",{name:t.path,id:r+"-"+t.path,onChange:function(t){return e.props.field.value=t.target.value}},t.options.map(function(e){return J("option",{value:e,selected:e===t.value},e)})))))}}),css:function(e,t){return"\n      ."+e+"__field--select select {\n        font-family: inherit;\n        font-size: inherit;\n        height: "+t.sliderHeight+";\n        width: 100%;\n        color: inherit;\n        -webkit-appearance: none;\n        -moz-appearance: none;\n        appearance: none;\n        background-color: "+t.controlBgColor+";\n        border: 1px solid "+t.controlBorderColor+";\n        outline: none;\n        margin: 0;\n        padding: 0 5px;\n        border-radius: "+t.controlBorderRadius+";\n        background-image: linear-gradient("+t.controlBorderColor+", "+t.controlBorderColor+"),\n          linear-gradient(-130deg, transparent 50%, "+t.controlBgColor+" 52%),\n          linear-gradient(-230deg, transparent 50%, "+t.controlBgColor+" 52%),\n          linear-gradient("+t.fontColor+" 42%, "+t.controlBgColor+" 42%);\n        background-repeat: no-repeat, no-repeat, no-repeat, no-repeat;\n        background-size: 1px 100%, 20px 16px, 20px 16px, 20px 60%;\n        background-position: right 20px center, right bottom, right bottom, right bottom;\n      }\n\n      ."+e+"__field--select select:focus {\n        "+t.focusBorder+"\n      }\n    "}},K=function(e){var t,n=window.getComputedStyle(e),r=n.display,i=n.position,o=n.visibility,a=n.maxHeight,s=a.replace("px","").replace("%","");return"none"!==r&&"0"!==s?e.offsetHeight:(e.style.maxHeight="",e.style.position="absolute",e.style.visibility="hidden",e.style.display="block",t=e.offsetHeight,e.style.maxHeight=a,e.style.display=r,e.style.position=i,e.style.visibility=o,t)},ee=function(e,t){if("0"===e.style.maxHeight.replace("px","").replace("%","")){var n=K(e)+"px";e.style.transition="max-height 0.1s ease-in-out",e.style.overflowY="hidden",e.style.maxHeight="0",e.style.display="block";var r=function(){e.style.transition="none",e.style.overflowY="visible",e.style.maxHeight="",e.removeEventListener("transitionend",r),t&&t()};e.addEventListener("transitionend",r),setTimeout(function(){e.style.maxHeight=n},20)}else n=K(e)+"px",e.style.transition="max-height 0.1s ease-in-out",e.style.overflowY="hidden",e.style.maxHeight=n,e.style.display="block",r=function(){e.style.transition="none",e.removeEventListener("transitionend",r),t&&t()},e.addEventListener("transitionend",r),setTimeout(function(){e.style.maxHeight="0"},20)},te=W.h,ne={name:"section",component:$({init:function(){var e=this.props.field.$config.expanded;e=void 0===e||!!e,this.state={expanded:e}},toggleCollapsed:function(e){e.stopPropagation(),ee(this.contentsEl),this.setState({expanded:!this.state.expanded})},getRef:function(e){this.contentsEl=e,!1===this.state.expanded&&ee(this.contentsEl)},render:function(){var e=this,t=this.props.field,n=t.$config.label||t.name,r=this.props.className,i=!t.parent||"tabs"!==t.parent.type;return t.parentField||n||(n="Controls"),te("fieldset",{className:r+"__section "+(this.state.expanded?r+"__section--expanded":"")+" "+(i?r+"__section--wrapped":"")},i&&te("legend",{className:r+"__sectionHeading"},te("button",{onClick:this.toggleCollapsed},n)),te("div",{ref:this.getRef,className:r+"__sectionFields"},Object.keys(t.value.$displayFields).map(function(n){return te(e.props.ControlComponent,{field:t.value.$path[n].$field})})))}}),css:function(e,t){return"\n      ."+e+"__section {\n        margin: 0;\n        margin-top: -1px;\n        padding: 0;\n        border: none;\n      }\n\n      ."+e+"__sectionHeading {\n        border: 1px solid "+t.sectionHeadingBorderColor+";\n        position: relative;\n        z-index: 1;\n        box-sizing: border-box;\n      }\n\n      ."+e+"__section--wrapped > ."+e+"__sectionFields {\n        margin-left: 4px;\n      }\n\n      ."+e+"__sectionFields {\n        box-sizing: border-box;\n      }\n\n      ."+e+"__sectionFields ."+e+"__field {\n        border-bottom: 1px solid "+t.fieldBorderColor+";\n        box-sizing: border-box;\n      }\n\n      ."+e+"__sectionFields ."+e+"__sectionFields {\n        border-right: none;\n        margin-right: 0;\n      }\n\n      ."+e+" > ."+e+"__section:first-child > ."+e+"__sectionHeading:first-child {\n        border-right: 1px solid "+t.sectionHeadingBorderColor+";\n      }\n\n      ."+e+"__sectionHeading {\n        padding: 0;\n        font-family: inherit;\n        user-select: none;\n        -moz-user-select: -moz-none;\n        text-indent: 5px;\n        cursor: pointer;\n        width: 100%;\n\n        color: "+t.sectionHeadingColor+";\n        background-color: "+t.sectionHeadingBgColor+";\n        height: "+t.sectionHeadingHeight+";\n        line-height: "+t.sectionHeadingHeight+";\n      }\n\n      ."+e+"__sectionHeading button:focus {\n        background-color: "+t.sectionHeadingHoverColor+";\n      }\n\n      ."+e+"__sectionHeading > button {\n        height: 100%;\n        vertical-align: middle;\n        font-size: 1.0em;\n        cursor: pointer;\n        text-align: left;\n        outline: none;\n        color: inherit;\n        font-size: inherit;\n        font-family: inherit;\n        background: transparent;\n        border: none;\n        border-radius: 0;\n        display: block;\n        width: 100%;\n      }\n\n      ."+e+"__sectionHeading:hover {\n        background-color: "+t.sectionHeadingHoverColor+";\n      }\n\n      ."+e+"__sectionHeading > button::before {\n        transform: translate(0, -1px) rotate(90deg);\n      }\n\n      ."+e+"__sectionHeading > button::before {\n        content: '▲';\n        display: inline-block;\n        transform-origin: 50% 50%;\n        margin-right: 0.5em;\n        font-size: 0.5em;\n        vertical-align: middle;\n      }\n\n      ."+e+"__section--expanded > ."+e+"__sectionHeading > button::before {\n        transform: none;\n        content: '▼';\n      }\n    "}},re=W.h,ie={name:"tabs",component:$({init:function(){var e=this.props.field,t=Object.keys(e.value.$displayFields);this.state={activeTab:t[0]}},getRef:function(e){this.contentsEl=e},activateTab:function(e,t){this.setState({activeTab:e}),t.preventDefault()},preventDefault:function(e){},render:function(){var e=this,t=this.props.field,n=t.$config.label||t.name,r=this.props.className;t.parentField||""!==n||(n="Controls");for(var i=Object.keys(t.value.$displayFields),o={},a=0;a<i.length;a++){var s=i[a];o[s]=s;var c=t.value.$path[s];if(c){var u=c.$field;if(u){var f=u.$config;f&&f.label&&(o[s]=f.label)}}}return re("div",{className:r+"__tabs"},re("ul",{className:r+"__tabList"},i.map(function(n){return re("li",{className:r+"__tabItem "+(n===e.state.activeTab?r+"__tabItem--active":"")},re("a",{href:"#"+r+"-"+t.path+"-"+n,onClick:function(t){return e.activateTab(n,t)}},o[n]))})),i.map(function(n){return n===e.state.activeTab&&re("div",{className:r+"__tabPanel",id:r+"-"+t.path+"-"+n},re(e.props.ControlComponent,{field:t.value.$path[n].$field}))}))}}),css:function(e,t){return"\n      ."+e+"__tabs {\n        margin: 0;\n        margin-top: -1px;\n        padding: 0;\n        border: none;\n      }\n\n      ."+e+"__tabList {\n        background-color: "+t.sectionHeadingBgColor+";\n        border-bottom: 6px solid "+t.activeTabBgColor+";\n        display: flex;\n        flex-wrap: wrap;\n        flex-direction: row;\n        margin: 0;\n        padding: 0;\n        padding-top: 6px;\n        align-items: flex-end;\n      }\n\n      ."+e+"__tabItem {\n        -moz-user-select: none;\n        -webkit-user-select: none;\n        user-select: none;\n        list-style-type: none;\n        border-top-left-radius: 2px;\n        border-top-right-radius: 2px;\n        margin-left: 6px;\n        display: inline-block;\n        background-color: "+t.inactiveTabBgColor+";\n        color: "+t.inactiveTabColor+";\n        padding: 5px 7px;\n        padding-bottom: 3px;\n        margin-top: 5px;\n      }\n\n      ."+e+"__tabItem:before {\n        content: none;\n      }\n\n      ."+e+"__tabItem:hover {\n        background-color: "+t.inactiveTabHoverBgColor+";\n        color: "+t.inactiveTabHoverColor+";\n      }\n\n      ."+e+"__tabItem--active {\n        background-color: "+t.activeTabBgColor+";\n        color: "+t.activeTabColor+";\n        padding-bottom: 5px;\n        margin-top: 3px;\n      }\n\n      ."+e+"__tabItem--active:hover {\n        background-color: "+t.activeTabBgColor+";\n        color: "+t.activeTabColor+";\n      }\n\n      ."+e+"__tabItem a {\n        color: inherit;\n        text-decoration: none;\n      }\n    "}},oe=W.h,ae={name:"slider",component:$({render:function(){var e=this,t=this.props.field,n=t.$config,r=this.props.className;return oe("div",{className:r+"__field "+r+"__field--slider"},oe("label",{className:r+"__label",htmlFor:r+"-"+t.path},oe("span",{className:r+"__labelText"},n.label||t.name)," ",oe("span",{className:r+"__container"},oe("input",{id:r+"-"+t.path,name:t.path,type:"range",min:t.min,max:t.max,step:t.step,value:t.value,onInput:function(t){return e.props.field.value=parseFloat(t.target.value)}}),oe("span",{className:r+"__sliderValue"},t.value.toFixed(4).replace(/\.?0*$/,"")))))}}),css:function(e,t){return"\n      ."+e+"__field--slider input[type=range] {\n        width: 100%;\n        height: "+t.sliderHeight+";\n        -webkit-appearance: none;\n        vertical-align: middle;\n        border-radius: "+t.controlBorderRadius+";\n        margin: 0;\n        cursor: resize-ew;\n        border: 1px solid "+t.controlBorderColor+";\n      }\n\n      ."+e+"__field--slider input[type=range]:focus {\n        "+t.focusBorder+"\n      }\n\n      ."+e+"__field--slider input[type=range]::-webkit-slider-thumb {\n        height: "+t.sliderHeight+";\n        width: "+t.sliderHeight+";\n        background: "+t.sliderThumbColor+";\n        border-radius: 0;\n        cursor: ew-resize;\n        -webkit-appearance: none;\n      }\n\n      ."+e+"__field--slider input[type=range]::-moz-range-thumb {\n        height: "+t.sliderHeight+";\n        width: "+t.sliderHeight+";\n        border-radius: 0;\n        background: "+t.sliderThumbColor+";\n        cursor: ew-resize;\n      }\n\n      ."+e+"__field--slider input[type=range]::-ms-thumb {\n        height: "+t.sliderHeight+";\n        width: "+t.sliderHeight+";\n        border-radius: 0;\n        background: "+t.sliderThumbColor+";\n        cursor: ew-resize;\n      }\n\n      ."+e+"__field--slider input[type=range]::-webkit-slider-runnable-track {\n        height: "+t.sliderHeight+";\n        cursor: ew-resize;\n        background: "+t.controlBgColor+";\n      }\n\n      ."+e+"__field--slider input[type=range]::-moz-range-track {\n        height: "+t.sliderHeight+";\n        cursor: ew-resize;\n        background: "+t.controlBgColor+";\n      }\n\n      ."+e+"__field--slider input[type=range]::-ms-track {\n        height: "+t.sliderHeight+";\n        cursor: ew-resize;\n        background: transparent;\n        border-color: transparent;\n        color: transparent;\n      }\n\n      ."+e+"__field--slider input[type=range]::-ms-fill-lower {\n        background: "+t.controlBgColor+";\n      }\n\n      ."+e+"__field--slider input[type=range]::-ms-fill-upper {\n        background: "+t.controlBgColor+";\n      }\n\n      ."+e+"__field--slider input[type=range]:focus::-ms-fill-lower {\n        background: "+t.controlBgColor+";\n        "+t.focusBorder+"\n      }\n\n      ."+e+"__field--slider input[type=range]:focus::-ms-fill-upper {\n        background: "+t.controlBgColor+";\n        "+t.focusBorder+"\n      }\n\n      ."+e+"__sliderValue {\n        position: absolute;\n        pointer-events: none;\n        top: 0;\n        z-index: 11;\n        line-height: "+t.fieldHeight+";\n        height: "+t.fieldHeight+";\n        display: inline-block;\n        right: 15px;\n        text-shadow:  1px  0   "+t.visibilityFontColor+",\n                      0    1px "+t.visibilityFontColor+",\n                     -1px  0   "+t.visibilityFontColor+",\n                      0   -1px "+t.visibilityFontColor+",\n                      1px  1px "+t.visibilityFontColor+",\n                      1px -1px "+t.visibilityFontColor+",\n                     -1px  1px "+t.visibilityFontColor+",\n                     -1px -1px "+t.visibilityFontColor+";\n      }\n    "}},se=W.h,ce={name:"checkbox",component:$({render:function(){var e=this,t=this.props.field,n=t.$config,r=this.props.className;return se("div",{className:r+"__field "+r+"__field--checkbox"},se("label",{className:r+"__label",htmlFor:r+"-"+t.path},se("span",{className:r+"__labelText"},n.label||t.name)," ",se("span",{className:r+"__container"},se("input",{id:r+"-"+t.path,name:t.path,type:"checkbox",checked:t.value,onInput:function(t){return e.props.field.value=t.target.checked}}))))}}),css:function(e,t){return"\n      ."+e+"__field--checkbox input[type=checkbox] {\n        height: 20px;\n        width: 20px;\n        margin-bottom: 0.2em;\n      }\n\n      ."+e+"__field--checkbox input[type=checkbox]:focus {\n        "+t.focusBorder+"\n      }\n    "}},ue=W.h,fe={name:"textinput",component:$({render:function(){var e=this,t=this.props.field,n=t.$config,r=this.props.className;return ue("div",{className:r+"__field "+r+"__field--text"},ue("label",{className:r+"__label",htmlFor:r+"-"+t.path},ue("span",{className:r+"__labelText"},n.label||t.name)," ",ue("span",{className:r+"__container"},ue("input",{id:r+"-"+t.path,name:t.path,type:"text",value:t.value,onInput:function(t){return e.props.field.value=t.target.value}}))))}}),css:function(e,t){return"\n      ."+e+"__field--text input[type=text] {\n        font-size: inherit;\n        font-family: inherit;\n        width: 100%;\n        margin: 0;\n        padding: 0 5px;\n        border: none;\n        height: "+t.sliderHeight+";\n        border-radius: "+t.controlBorderRadius+";\n        background-color: "+t.controlBgColor+";\n        border: 1px solid "+t.controlBorderColor+";\n        color: inherit;\n      }\n\n      ."+e+"__field--text input[type=text]:focus {\n        "+t.focusBorder+"\n      }\n    "}},le=W.h,pe={name:"button",component:$({render:function(){var e=this.props.field,t=e.$config,n=this.props.className;return le("div",{className:n+"__field "+n+"__field--button"},le("button",{onClick:e.value},t.label||e.name))}}),css:function(e,t){return"\n      ."+e+"__field--button button {\n        height: "+t.fieldHeight+";\n        font-size: inherit;\n        font-family: inherit;\n        outline: none;\n        cursor: pointer;\n        text-align: center;\n        display: block;\n        background: transparent;\n        color: inherit;\n        font-size: 1.0em;\n        width: 100%;\n        border: none;\n        border-radius: 0;\n      }\n\n      ."+e+"__field--button > button:hover {\n        background-color: "+t.fieldHoverColor+";\n      }\n\n      ."+e+"__field--button > button:active {\n        background-color: "+t.fieldActiveColor+";\n      }\n\n      ."+e+"__field--button > button:focus {\n        "+t.focusBorder+"\n      }\n\n      ."+e+"__field--button > button::before {\n        content: '';\n        width: 3px;\n        display: inline-block;\n        vertical-align: middle;\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n      }\n    "}},de=W.h,he={name:"color",component:$({render:function(){var e=this,t=this.props.field,n=t.$config,r=this.props.className;return de("div",{className:r+"__field "+r+"__field--color"},de("label",{className:r+"__label",htmlFor:r+"-"+t.path},de("span",{className:r+"__labelText"},n.label||t.name)," ",de("span",{className:r+"__container"},de("input",{id:r+"-"+t.path,name:t.path,type:"color",value:t.value,onInput:function(t){e.props.field.value=t.target.value}}))))}}),css:function(e,t){return"\n      ."+e+"__field--color input[type=color] {\n        margin: 0;\n        border: 1px solid #aaa;\n        width: 50px;\n        height: "+t.sliderHeight+";\n        border-radius: "+t.controlBorderRadius+";\n        padding: 0;\n      }\n\n      ."+e+"__field--color input[type=color]::-webkit-color-swatch-wrapper {\n        padding: 0px;\n        background-color: #888;\n      }\n\n      ."+e+"__field--color input[type=color]:focus {\n        "+t.focusBorder+"\n      }\n    "}},me=W.h,ve={name:"raw",component:$({getRef:function(e){this.el=e},getContent:function(e){return this.content=e.field.value,"function"==typeof this.content&&(this.content=this.content(me,{field:e.field,state:e.state})),this.content},render:function(){var e=this.props.className;return me("div",{className:e+"__field--raw "+e+"__field"},me("div",{ref:this.getRef,className:e+"__rawContent"},this.getContent(this.props)))}}),css:function(e,t){return"\n      ."+e+"__field--raw {\n        height: auto;\n        padding: 0 7px 0 10px;\n        overflow: hidden;\n      }\n\n      ."+e+"__rawContent {\n        max-width: 100%;\n        margin: 0;\n        padding: 0;\n      }\n\n      ."+e+"__rawContent a {\n        color: inherit;\n      }\n\n      ."+e+"__rawContent::before {\n        background-color: #aaa;\n      }\n\n      ."+e+"__rawContent::before {\n        content: '';\n        width: 3px;\n        display: inline-block;\n        vertical-align: middle;\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n      }\n\n      ."+e+"__rawContent > p:first-child {\n        margin-top: 5px;\n      }\n\n      ."+e+"__rawContent > p:last-child{\n        margin-bottom: 5px;\n      }\n\n      ."+e+"__rawContent p {\n        line-height: 1.8;\n      }\n\n      ."+e+"__rawContent pre {\n        line-height: 1.3;\n        font-size: 0.8em;\n        margin: 0;\n      }\n    "}},ge=function(){var e={};function t(t,n){(n=q(n||{},{containerCSS:"position:fixed;top:0;right:8px",style:!0,className:"controlPanel-"+Math.random().toString(36).substring(2,15)})).root=n.root||document.body;var r=n.className,i=$({render:function(){return W.h(function(t){var n=e[t];if(!n)throw new Error('Unrecognized component, "'+t+'"');return n}(this.props.field.type).component,{ControlComponent:i,className:r,field:this.props.field,state:t,h:W.h})}}),o=$({state:{dummy:0},componentDidMount:function(){var e=this;this.props.state.$field.onChanges(function(t){e.setState({dummy:e.state.dummy+1})})},getRef:function(e){for(var t=["mousedown","mouseup","mousemove","touchstart","touchmove","touchend","wheel"],r=0;r<t.length;r++)e.addEventListener(t[r],function(e){e.stopPropagation()});n.containerCSS&&(e.style.cssText=n.containerCSS)},render:function(){return W.h("div",{className:""+r,ref:this.getRef},W.h(i,{field:this.props.state.$field}))}});return n.style&&N(function(e,t,n){return(t=Object.assign({},q(t||{},Q))).fontSize=X(t.fontSize),t.sliderHeight=X(t.sliderHeight),t.fieldHeight=X(t.fieldHeight),t.sectionHeadingHeight=X(t.sectionHeadingHeight),t.minLabelWidth=X(t.minLabelWidth),t.minControlWidth=X(t.minControlWidth),t.controlBorderRadius=X(t.controlBorderRadius),t.focusBorder="\n    outline: none;\n    border-color: "+t.focusBorderColor+";\n    box-shadow: 0 0 3px "+t.focusBorderColor+";\n  ","\n    ."+e+" {\n      color: "+t.fontColor+";\n      "+(t.fontSize?"font-size: "+t.fontSize:"")+";\n      "+(t.fontFamily?"font-family: "+t.fontFamily:"")+";\n      max-width: 100%;\n    }\n\n    ."+e+"__field {\n      position: relative;\n      background-color: "+t.fieldBgColor+";\n      border-right: 1px solid "+t.fieldBorderColor+";\n    }\n\n    ."+e+"__label {\n      display: block;\n      height: "+t.fieldHeight+";\n      line-height: "+t.fieldHeight+";\n      display: flex;\n      flex-direction: row;\n      background-color: "+t.fieldBgColor+";\n    }\n\n    ."+e+"__field:hover {\n      background-color: "+t.fieldHoverColor+";\n    }\n\n    ."+e+"__container {\n      display: flex;\n      flex-direction: row;\n      align-content: stretch;\n      justify-content: stretch;\n    \n      height: "+t.fieldHeight+";\n      flex: 1;\n      position: relative;\n      align-items: center;\n      position: relative;\n\n      min-width: "+t.minControlWidth+";\n      width: "+t.fieldHeight+";\n      padding-right: 8px;\n      text-indent: 8px;\n    }\n\n    ."+e+"__labelText {\n      user-select: none;\n      -moz-user-select: -moz-none;\n      text-indent: 8px;\n      margin-right: 4px;\n      display: inline-block;\n      min-width: "+t.minLabelWidth+";\n      line-height: "+t.fieldHeight+";\n    }\n\n    ."+e+"__field::before {\n      content: '';\n      width: 3px;\n      display: inline-block;\n      vertical-align: middle;\n      position: absolute;\n      top: 0;\n      left: 0;\n      bottom: 0;\n    }\n\n    ."+e+"__field--text::before { background-color: #49f; }\n    ."+e+"__field--color::before { background-color: #94f; }\n    ."+e+"__field--checkbox::before { background-color: #f49; }\n    ."+e+"__field--slider::before { background-color: #f84; }\n    ."+e+"__field--select::before { background-color: #8f4; }\n    ."+e+"__field--button > button::before { background-color: #8ff; }\n\n    "+Object.keys(n).map(function(r){var i=n[r].css;return i?i(e,t):""}).join("\n")+"\n  "}(r,n.theme,e)),W.render(W.h(o,{state:t}),n.root),t}return t.registerComponent=function(n){return e[n.name]=n,t},t.registerComponents=function(e){for(var n=0;n<e.length;n++)t.registerComponent(e[n]);return t},t}();return ge.registerComponents([Z,ne,ie,ae,ce,fe,pe,he,ve]),ge.preact=W,ge.preact.createClass=$,ge},"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):(r=r||self).ControlsGUI=i()}).call(this,e("buffer").Buffer)},{buffer:3}],5:[function(e,t,n){(function(e,r){var i,o;i=this,o=function(){"use strict";var t="undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:{};function n(e,t){return e(t={exports:{}},t.exports),t.exports}for(var i,o,a=function(e){return null!=e},s=Object.keys,c=function(){try{return!0}catch(e){return!1}}()?Object.keys:function(e){return s(a(e)?Object(e):e)},u=Math.max,f="function"==typeof(o=Object.assign)&&(o(i={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),i.foo+i.bar+i.trzy==="razdwatrzy")?Object.assign:function(e,t){var n,r,i,o=u(arguments.length,2);for(e=Object(function(e){if(!a(e))throw new TypeError("Cannot use null or undefined");return e}(e)),i=function(r){try{e[r]=t[r]}catch(r){n||(n=r)}},r=1;r<o;++r)t=arguments[r],c(t).forEach(i);if(void 0!==n)throw n;return e},l=Array.prototype.forEach,p=Object.create,d=function(e){var t=p(null);return l.call(arguments,function(e){a(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t},h=function(e){return"function"==typeof e},m="razdwatrzy",v=String.prototype.indexOf,g="function"==typeof m.contains&&!0===m.contains("dwa")&&!1===m.contains("foo")?String.prototype.contains:function(e){return-1<v.call(this,e,arguments[1])},b=n(function(e){(e.exports=function(e,t){var n,r,i,o,a;return arguments.length<2||"string"!=typeof e?(o=t,t=e,e=null):o=arguments[2],null==e?(n=i=!0,r=!1):(n=g.call(e,"c"),r=g.call(e,"e"),i=g.call(e,"w")),a={value:t,configurable:n,enumerable:r,writable:i},o?f(d(o),a):a}).gs=function(e,t,n){var r,i,o,a;return"string"!=typeof e?(o=n,n=t,t=e,e=null):o=arguments[3],null==t?t=void 0:h(t)?null==n?n=void 0:h(n)||(o=n,n=void 0):(o=t,t=n=void 0),i=null==e?!(r=!0):(r=g.call(e,"c"),g.call(e,"e")),a={get:t,set:n,configurable:r,enumerable:i},o?f(d(o),a):a}}),y=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},w=n(function(e,t){var n,r,i,o,a,s,c,u=Function.prototype.apply,f=Function.prototype.call,l=Object.create,p=Object.defineProperty,d=Object.defineProperties,h=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0};r=function(e,t){var r,o;return y(t),n.call(o=this,e,r=function(){i.call(o,e,r),u.call(t,this,arguments)}),r.__eeOnceListener__=t,this},a={on:n=function(e,t){var n;return y(t),h.call(this,"__ee__")?n=this.__ee__:(n=m.value=l(null),p(this,"__ee__",m),m.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:r,off:i=function(e,t){var n,r,i,o;if(y(t),!h.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(o=0;i=r[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:o=function(e){var t,n,r,i,o;if(h.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)u.call(r,this,o)}else switch(arguments.length){case 1:f.call(i,this);break;case 2:f.call(i,this,arguments[1]);break;case 3:f.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];u.call(i,this,o)}}},s={on:b(n),once:b(r),off:b(i),emit:b(o)},c=d({},s),e.exports=t=function(e){return null==e?l(c):d(Object(e),s)},t.methods=a}),x=(w.methods,n(function(n){(function(){var t,r,i,o,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?n.exports=function(){return performance.now()}:void 0!==e&&null!==e&&e.hrtime?(n.exports=function(){return(t()-a)/1e6},r=e.hrtime,o=(t=function(){var e;return 1e9*(e=r())[0]+e[1]})(),s=1e9*e.uptime(),a=o-s):i=Date.now?(n.exports=function(){return Date.now()-i},Date.now()):(n.exports=function(){return(new Date).getTime()-i},(new Date).getTime())}).call(t)})),_="undefined"==typeof window?t:window,C=["moz","webkit"],E="AnimationFrame",k=_["request"+E],T=_["cancel"+E]||_["cancelRequest"+E],S=0;!k&&S<C.length;S++)k=_[C[S]+"Request"+E],T=_[C[S]+"Cancel"+E]||_[C[S]+"CancelRequest"+E];if(!k||!T){var A=0,P=0,O=[];k=function(e){if(0===O.length){var t=x(),n=Math.max(0,1e3/60-(t-A));A=n+t,setTimeout(function(){for(var e=O.slice(0),t=O.length=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(A)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return O.push({handle:++P,callback:e,cancelled:!1}),P},T=function(e){for(var t=0;t<O.length;t++)O[t].handle===e&&(O[t].cancelled=!0)}}var j=function(e){return k.call(_,e)};j.cancel=function(){T.apply(_,arguments)},j.polyfill=function(e){e||(e=_),e.requestAnimationFrame=k,e.cancelAnimationFrame=T};var D=R;function R(e,t,n,r){if(/\./.test(e))throw new Error("Field names may not contain a period");r=r||{};var i=t;this.parent=n||null,this.events=new w,this.type=null,this.name=e,this.batchedUpdates={},this.batchUpdatePaths=[],this.batchUpdateRaf=null,Object.defineProperties(this,{$field:{enumerable:!1,value:this},$config:{enumerable:!1,value:r},value:{get:function(){return i},set:function(e){var t={field:this,name:this.name,path:this.path,fullPath:this.path,oldValue:i,value:e},n=[],r=this;do{t.path=n.join(".");var o={};o[t.path||this.name]=Object.assign({},t),r.events.emit&&(r.events.emit("beforeChange",Object.assign({},t)),r.events.emit("beforeChanges",o)),r._batchEmit&&r._batchEmit(t.path,Object.assign({},t)),n.unshift(r.name)}while(r=r.parent);i=e}},path:{enumerable:!0,get:function(){var e=(this.parent||{}).path;return this.name?(e?e+".":"")+this.name:null}}})}R.prototype={onBeforeChange:function(e){return this.events.on("beforeChange",e),this},offBeforeChange:function(e){return this.events.off("beforeChange",e),this},onBeforeChanges:function(e){return this.events.on("beforeChanges",e),this},offBeforeChanges:function(e){return this.events.off("beforeChanges",e),this},onChange:function(e){return this.events.on("change",e),this},offChange:function(e){return this.events.off("change",e),this},onChanges:function(e){return this.events.on("changes",e),this},offChanges:function(e){return this.events.off("changes",e),this},_emitUpdate:function(){for(this.events.emit("changes",Object.assign({},this.batchedUpdates));this.batchUpdatePaths.length;)for(var e=Object.keys(this.batchedUpdates),t=0;t<e.length;t++){var n=this.batchedUpdates[e[t]],r=this.batchUpdatePaths.pop();this.events.emit("change",n),this.events.emit("change:"+r,n)}this.batchedUpdates={},this.batchUpdateRaf=null},_batchEmit:function(e,t){var n=this.batchedUpdates[t.path];n&&(t.oldValue=n.oldValue),this.batchUpdatePaths.push(e),this.batchedUpdates[e]=t,this.batchUpdateRaf||(this.batchUpdateRaf=j(this._emitUpdate.bind(this)))}};var B=M;function M(e,t,n,r){if(!(this instanceof M))return new M(e,t,n,r);D.call(this,e,t,r,n),this.type="raw"}M.prototype=Object.create(D.prototype);var L=z;function z(e,t,n,r){if(!(this instanceof z))return new z(e,t,n,r);t=void 0===t?0:t,n=n||{},D.call(this,e,t,r,n);var i=void 0===n.min?Math.min(t,0):n.min,o=void 0===n.max?Math.max(t,1):n.max,a=void 0===n.step?1:n.step;this.type="slider",this.min=i,this.max=o,this.step=a}z.prototype=Object.create(D.prototype);var I=U;function U(e,t,n,r){if(!(this instanceof U))return new U(e,t,n,r);D.call(this,e,t,r,n),this.type="button"}U.prototype=Object.create(D.prototype);var F=N;function N(e,t,n,r){if(!(this instanceof N))return new N(e,t,n,r);t=void 0===t?"":t,D.call(this,e,t,r,n),this.type="textinput"}N.prototype=Object.create(D.prototype);var H=V;function V(e,t,n,r){if(!(this instanceof V))return new V(e,t,n);t=void 0===t?"#ffffff":t,D.call(this,e,t,r,n),this.type="color"}V.prototype=Object.create(D.prototype);var G=Y;function Y(e,t,n,r){if(!(this instanceof Y))return new Y(e,t,n,r);t=void 0===t||!!t,D.call(this,e,t,r,n),this.type="checkbox"}Y.prototype=Object.create(D.prototype);var q="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},W=/(#(?:[0-9a-fA-F]{2,4}){2,4}|(#[0-9a-fA-F]{3})|(rgb|hsl)a?((-?\d+%?[,\s]+){2,3}\s*[\d.]+%?))/,$=function(e){if(e&&e.type)return e.type+"field";if(function(e){return q.Element&&e instanceof q.Element||q.HTMLDocument&&e instanceof q.HTMLDocument}(e))return"rawfield";if("function"==typeof e)return"button";switch(typeof e){case"string":return W.test(e)?"color":"textinput";case"number":return"number";case"boolean":return"boolean";case"raw":return"raw";case"button":return"button";case"object":return"object"}},X=Q;function Q(e,t,n,r){var i=this;n=n||{};var o={},a={},s={};D.call(this,e,s,r,n),this.type="section",Object.defineProperty(a,"$field",{enumerable:!1,value:this}),Object.defineProperties(s,{$field:{enumerable:!1,value:this},$path:{enumerable:!1,value:a},$displayFields:{enumerable:!1,value:o}}),Object.keys(t).forEach(function(e){var n=o[e]=function(e,t,n){switch($(t)){case"rawfield":case"buttonfield":case"colorfield":case"textfield":case"sliderfield":case"selectfield":case"rangesliderfield":case"checkboxfield":case"sectionfield":case"tabsfield":if(t.path)throw new Error("You may only add an field to a set of controls once.");return t.$field.parent=n,t.name=e,t;case"color":return new H(e,t,{},n);case"raw":return new B(e,t,{},n);case"button":return new I(e,t,{},n);case"textinput":return new F(e,t,{},n);case"number":return new L(e,t,{},n);case"boolean":return new G(e,t,{},n);case"object":return new Q(e,t,{},n);default:return null}}(e,t[e],i),r=n.$config;if("raw"===n.type||"button"===n.type){var c=void 0!==r.enumerable&&!!r.enumerable;Object.defineProperty(s,e,{enumerable:c,get:function(){return n.value}}),Object.defineProperty(a,e,{enumerable:c,get:function(){return n}})}else"section"===n.type||"tabs"===n.type?(c=void 0===r.enumerable||!!r.enumerable,Object.defineProperty(s,e,{enumerable:c,value:n.value}),Object.defineProperty(a,e,{enumerable:c,value:n.value.$path})):(c=void 0===r.enumerable||!!r.enumerable,Object.defineProperty(s,e,{enumerable:c,get:function(){return n.value},set:function(e){n.value=e}}),Object.defineProperty(a,e,{enumerable:c,get:function(){return n}}))}),Object.defineProperties(s,{$onBeforeChanges:{enumerable:!1,value:this.onBeforeChanges.bind(this)},$onBeforeChange:{enumerable:!1,value:this.onBeforeChange.bind(this)},$offBeforeChanges:{enumerable:!1,value:this.offBeforeChanges.bind(this)},$offBeforeChange:{enumerable:!1,value:this.offBeforeChange.bind(this)},$onChanges:{enumerable:!1,value:this.onChanges.bind(this)},$onChange:{enumerable:!1,value:this.onChange.bind(this)},$offChanges:{enumerable:!1,value:this.offChanges.bind(this)},$offChange:{enumerable:!1,value:this.offChange.bind(this)}})}Q.prototype=Object.create(D.prototype);var J=Z;function Z(e,t,n,r){if(!(this instanceof Z))return new Z(e,t,n,r);t=void 0===t?null:t,D.call(this,e,t,r,n),this.options=n.options,this.type="select"}function K(e,t){return new X("",e,t).value}return Z.prototype=Object.create(D.prototype),K.Slider=function(e,t){return new L(null,e,t)},K.Textinput=function(e,t){return new F(null,e,t)},K.Select=function(e,t){return new J(null,e,t)},K.Checkbox=function(e,t){return new G(null,e,t)},K.Color=function(e,t){return new H(null,e,t)},K.Section=function(e,t){return new X(null,e,t)},K.Tabs=function(e,t){return new function(e,t,n,r){var i=new X(e,t,n,r);return i.type="tabs",i}(null,e,t)},K.Raw=function(e,t){return new B(null,e,t)},K},"object"==typeof n&&void 0!==t?t.exports=o():"function"==typeof define&&define.amd?define(o):(i=i||self).ControlsState=o()}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:51}],6:[function(e,t,n){"use strict";var r=e("es5-ext/object/assign"),i=e("es5-ext/object/normalize-options"),o=e("es5-ext/object/is-callable"),a=e("es5-ext/string/#/contains");(t.exports=function(e,t){var n,o,s,c,u;return arguments.length<2||"string"!=typeof e?(c=t,t=e,e=null):c=arguments[2],null==e?(n=s=!0,o=!1):(n=a.call(e,"c"),o=a.call(e,"e"),s=a.call(e,"w")),u={value:t,configurable:n,enumerable:o,writable:s},c?r(i(c),u):u}).gs=function(e,t,n){var s,c,u,f;return"string"!=typeof e?(u=n,n=t,t=e,e=null):u=arguments[3],null==t?t=void 0:o(t)?null==n?n=void 0:o(n)||(u=n,n=void 0):(u=t,t=n=void 0),null==e?(s=!0,c=!1):(s=a.call(e,"c"),c=a.call(e,"e")),f={get:t,set:n,configurable:s,enumerable:c},u?r(i(u),f):f}},{"es5-ext/object/assign":8,"es5-ext/object/is-callable":11,"es5-ext/object/normalize-options":16,"es5-ext/string/#/contains":19}],7:[function(e,t,n){"use strict";t.exports=function(){}},{}],8:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":9,"./shim":10}],9:[function(e,t,n){"use strict";t.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},{}],10:[function(e,t,n){"use strict";var r=e("../keys"),i=e("../valid-value"),o=Math.max;t.exports=function(e,t){var n,a,s,c=o(arguments.length,2);for(e=Object(i(e)),s=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},a=1;a<c;++a)t=arguments[a],r(t).forEach(s);if(void 0!==n)throw n;return e}},{"../keys":13,"../valid-value":18}],11:[function(e,t,n){"use strict";t.exports=function(e){return"function"==typeof e}},{}],12:[function(e,t,n){"use strict";var r=e("../function/noop")();t.exports=function(e){return e!==r&&null!==e}},{"../function/noop":7}],13:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":14,"./shim":15}],14:[function(e,t,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],15:[function(e,t,n){"use strict";var r=e("../is-value"),i=Object.keys;t.exports=function(e){return i(r(e)?Object(e):e)}},{"../is-value":12}],16:[function(e,t,n){"use strict";var r=e("./is-value"),i=Array.prototype.forEach,o=Object.create;t.exports=function(e){var t=o(null);return i.call(arguments,function(e){r(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t}},{"./is-value":12}],17:[function(e,t,n){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],18:[function(e,t,n){"use strict";var r=e("./is-value");t.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":12}],19:[function(e,t,n){"use strict";t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":20,"./shim":21}],20:[function(e,t,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"==typeof r.contains&&(!0===r.contains("dwa")&&!1===r.contains("foo"))}},{}],21:[function(e,t,n){"use strict";var r=String.prototype.indexOf;t.exports=function(e){return r.call(this,e,arguments[1])>-1}},{}],22:[function(e,t,n){"use strict";var r,i,o,a,s,c,u,f=e("d"),l=e("es5-ext/object/valid-callable"),p=Function.prototype.apply,d=Function.prototype.call,h=Object.create,m=Object.defineProperty,v=Object.defineProperties,g=Object.prototype.hasOwnProperty,b={configurable:!0,enumerable:!1,writable:!0};s={on:r=function(e,t){var n;return l(t),g.call(this,"__ee__")?n=this.__ee__:(n=b.value=h(null),m(this,"__ee__",b),b.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:i=function(e,t){var n,i;return l(t),i=this,r.call(this,e,n=function(){o.call(i,e,n),p.call(t,this,arguments)}),n.__eeOnceListener__=t,this},off:o=function(e,t){var n,r,i,o;if(l(t),!g.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(o=0;i=r[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===r.length?n[e]=r[o?0:1]:r.splice(o,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:a=function(e){var t,n,r,i,o;if(g.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;r=i[t];++t)p.call(r,this,o)}else switch(arguments.length){case 1:d.call(i,this);break;case 2:d.call(i,this,arguments[1]);break;case 3:d.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),t=1;t<n;++t)o[t-1]=arguments[t];p.call(i,this,o)}}},c={on:f(r),once:f(i),off:f(o),emit:f(a)},u=v({},c),t.exports=n=function(e){return null==e?h(u):v(Object(e),c)},n.methods=s},{d:6,"es5-ext/object/valid-callable":17}],23:[function(e,t,n){"use strict";var r=e("h");t.exports=function(e,t){return t=t||{},function(n,i){if(!n)return e&&e(i);if(n instanceof Error)n=n.name+": "+n.message;else if("string"!=typeof n)throw new Error("fail-nicely: Oops! the message must be a String or an Error. How ironic.");var o=void 0===t.zIndex?9999:parseInt(t.zIndex),a=void 0===t.bg?"#333":t.bg,s=void 0===t.fg?"#fff":t.fg,c=void 0===t.title?"Sorry!":t.title,u=void 0===t.fontFamily?"Helvetica, Arial, sans-serif":t.fontFamily,f=void 0===t.position?"fixed":t.position;if(void 0!==t.invert&&t.invert){var l=s;s=a,a=l}var p={position:f,top:0,right:0,bottom:0,left:0,"background-color":a,color:s,"text-align":"center","z-index":o},d={"font-family":u},h={"font-family":u,"max-width":"640px","margin-left":"auto","margin-right":"auto","line-height":"1.4",padding:"0 15px"};document.body.appendChild(r("div",{style:p},[r("div",{style:{transform:"translate(0, -50%)","margin-top":"50vh"}},[r("h1",c,{style:d}),r("p",n,{style:h})])]))}}},{h:28}],24:[function(e,t,n){e("webrtc-adapter");t.exports=function(e,t){var n,r="PermissionDeniedError";return 2===arguments.length||(t=e,e={video:!0,audio:!0}),"undefined"!=typeof navigator&&navigator.getUserMedia?e.audio||e.video?void navigator.mediaDevices.getUserMedia(e).then(function(e){t(null,e)}).catch(function(e){var n;"string"==typeof e?(n=new Error("MediaStreamError")).name=e===r||"PERMISSION_DENIED"===e?r:"ConstraintNotSatisfiedError":(n=e).name||(n[r]?e.name=r:e.name="ConstraintNotSatisfiedError"),t(n)}):((n=new Error("MediaStreamError")).name="NoMediaRequestedError",setTimeout(function(){t(n)},0)):((n=new Error("MediaStreamError")).name="NotSupportedError",setTimeout(function(){t(n)},0))}},{"webrtc-adapter":57}],25:[function(e,t,n){t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],26:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],u=t[6],f=t[7],l=t[8],p=t[9],d=t[10],h=t[11],m=t[12],v=t[13],g=t[14],b=t[15],y=n[0],w=n[1],x=n[2],_=n[3];return e[0]=y*r+w*s+x*l+_*m,e[1]=y*i+w*c+x*p+_*v,e[2]=y*o+w*u+x*d+_*g,e[3]=y*a+w*f+x*h+_*b,y=n[4],w=n[5],x=n[6],_=n[7],e[4]=y*r+w*s+x*l+_*m,e[5]=y*i+w*c+x*p+_*v,e[6]=y*o+w*u+x*d+_*g,e[7]=y*a+w*f+x*h+_*b,y=n[8],w=n[9],x=n[10],_=n[11],e[8]=y*r+w*s+x*l+_*m,e[9]=y*i+w*c+x*p+_*v,e[10]=y*o+w*u+x*d+_*g,e[11]=y*a+w*f+x*h+_*b,y=n[12],w=n[13],x=n[14],_=n[15],e[12]=y*r+w*s+x*l+_*m,e[13]=y*i+w*c+x*p+_*v,e[14]=y*o+w*u+x*d+_*g,e[15]=y*a+w*f+x*h+_*b,e}},{}],27:[function(e,t,n){t.exports=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}},{}],28:[function(e,t,n){!function(){function e(){var e=[].slice.call(arguments),t=null;function n(e){if(null==e);else if("string"==typeof e)t?t.appendChild(document.createTextNode(e)):e.split(/([\.#]?[a-zA-Z0-9_-]+)/).forEach(function(e){var n=e.substring(1,e.length);e&&(t?"."===e[0]?t.classList.add(n):"#"===e[0]&&t.setAttribute("id",n):t=document.createElement(e))});else if("number"==typeof e||"boolean"==typeof e||e instanceof Date||e instanceof RegExp)t.appendChild(document.createTextNode(e.toString()));else if(Array.isArray(e))e.forEach(n);else if(e instanceof HTMLElement)t.appendChild(e);else if("object"==typeof e)for(var r in e)if("function"==typeof e[r])t.addEventListener(r,e[r]);else if("style"===r)for(var i in e[r])t.style.setProperty(i,e[r][i]);else t.setAttribute(r,e[r])}for(;e.length;)n(e.shift());return t}"object"==typeof t?t.exports=e:this.h=e}()},{}],29:[function(e,t,n){n.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,f=-7,l=n?i-1:0,p=n?-1:1,d=e[t+l];for(l+=p,o=d&(1<<-f)-1,d>>=-f,f+=s;f>0;o=256*o+e[t+l],l+=p,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=r;f>0;a=256*a+e[t+l],l+=p,f-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,f=(1<<u)-1,l=f>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=f):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+l>=1?p/c:p*Math.pow(2,1-l))*c>=2&&(a++,c/=2),a+l>=f?(s=0,a=f):a+l>=1?(s=(t*c-1)*Math.pow(2,i),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+d]=255&a,d+=h,a/=256,u-=8);e[n+d-h]|=128*m}},{}],30:[function(e,t,n){"use strict";var r=e("gl-vec3/transformMat4"),i=e("gl-vec3/rotateY"),o=e("gl-vec3/rotateX"),a=e("gl-vec3/equals"),s=e("gl-vec3/add"),c=e("gl-vec3/scaleAndAdd"),u=e("gl-vec3/copy"),f=e("gl-vec3/normalize"),l=e("gl-mat4/identity"),p=e("gl-mat4/invert"),d=e("gl-mat4/translate"),h=e("gl-mat4/scale"),m=e("gl-mat4/lookAt"),v=e("gl-mat4/perspective"),g=.5*Math.PI-1e-4,b=.5*-Math.PI+1e-4;t.exports=function(e){var t=!0,n={aspectRatio:(e=e||{}).aspectRatio?e.aspectRatio:1,zoomAboutCursor:void 0===e.zoomAboutCursor||e.zoomAboutCursor,distance:void 0===e.distance?10:e.distance,phi:void 0===e.phi?0:e.phi,theta:void 0===e.theta?0:e.theta,fovY:void 0===e.fovY?Math.PI/4:e.fovY,near:void 0===e.near?.1:e.near,far:void 0===e.far?100:e.far,panDecayTime:e.panDecayTime||100,zoomDecayTime:e.zoomDecayTime||100,rotationDecayTime:e.rotationDecayTime||100,dirty:!0,up:e.up||new Float32Array([0,1,0]),center:e.center||new Float32Array(3),rotationCenter:e.rotationCenter||e.center&&e.center.slice()||new Float32Array(3),zoom:0,panX:0,panY:0,panZ:0,pitch:0,yaw:0,dTheta:0,dPhi:0,mouseX:0,mouseY:0},y=null,w={tick:function(e){if(B.zoom&&(n.zoom=B.zoom),B.dTheta&&(n.dTheta=B.dTheta),B.dPhi&&(n.dPhi=B.dPhi),B.panX&&(n.panX=B.panX),B.panY&&(n.panY=B.panY),B.panZ&&(n.panZ=B.panZ),B.yaw&&(n.yaw=B.yaw),B.pitch&&(n.pitch=B.pitch),R(B),e){var r=n.dPhi,i=n.dTheta,o=n.zoom,s=n.panX,c=n.panY,u=n.panZ,f=n.pitch,l=n.yaw;Object.assign(n,e),void 0!==e.dPhi&&(n.dPhi+=r),void 0!==e.dTheta&&(n.dTheta+=i),void 0!==e.zoom&&(n.zoom+=o),void 0!==e.panX&&(n.panX+=s),void 0!==e.panY&&(n.panY+=c),void 0!==e.panZ&&(n.panZ+=u),void 0!==e.pitch&&(n.pitch+=f),void 0!==e.yaw&&(n.yaw+=l)}a(n.up,S.up)&&a(n.center,S.center)&&n.near===S.near&&n.far===S.far&&n.phi===S.phi&&n.theta===S.theta&&n.distance===S.distance&&n.fovY===S.fovY||(P.dPhi=n.phi-S.phi,P.dTheta=n.theta-S.theta,P.zoom=n.distance/S.distance-1,n.theta=S.theta,n.distance=S.distance,n.phi=S.phi,P.yaw=0,P.pitch=0,P.panX=0,P.panY=0,P.panZ=0,P.mouseX=0,P.mouseY=0,M(P)),!function(){if(Math.abs(n.zoom)>1e-4)return!0;if(Math.abs(n.panX)>1e-4)return!0;if(Math.abs(n.panY)>1e-4)return!0;if(Math.abs(n.panZ)>1e-4)return!0;if(Math.abs(n.dTheta)>1e-4)return!0;if(Math.abs(n.dPhi)>1e-4)return!0;if(Math.abs(n.yaw)>1e-4)return!0;if(Math.abs(n.pitch)>1e-4)return!0}()?R(n):M(n);var p,d,h,m,v=Date.now();null!==y&&(p=v-y,d=n.panDecayTime?Math.exp(-p/n.panDecayTime/Math.LN2):0,h=n.zoomDecayTime?Math.exp(-p/n.zoomDecayTime/Math.LN2):0,m=n.rotationDecayTime?Math.exp(-p/n.rotationDecayTime/Math.LN2):0,n.zoom*=h,n.panX*=d,n.panY*=d,n.panZ*=d,n.dTheta*=m,n.dPhi*=m,n.yaw*=m,n.pitch*=m),y=v,w.state.dirty=t,t=!1,A()},taint:j,resize:D,params:n,rotate:function(e,t){B.dTheta+=e,B.dPhi+=t},pivot:function(e,t){var r=w.params.fovY;B.yaw+=e*r*n.aspectRatio,B.pitch+=t*r},pan:function(e,t){var r=w.params.distance*Math.tan(.5*w.params.fovY)*2;return B.panX+=e*n.aspectRatio*r,B.panY+=t*r,w},zoom:function(e,t,r){return B.zoom+=r,n.mouseX=e,n.mouseY=t,w},state:{}};w.state.projection=new Float32Array(16),w.state.viewInv=new Float32Array(16),w.state.view=new Float32Array(16),w.state.width=null,w.state.height=null,w.state.eye=new Float32Array(3);var x=new Float32Array(3),_=new Float32Array(3),C=new Float32Array(3),E=new Float32Array(3),k=new Float32Array(3),T=new Float32Array(16),S={up:new Float32Array(3),center:new Float32Array(3)};function A(){u(S.up,n.up),u(S.center,n.center),S.near=n.near,S.far=n.far,S.distance=n.distance,S.phi=n.phi,S.theta=n.theta,S.fovY=n.fovY}A();var P={};function O(){w.state.eye[0]=0,w.state.eye[1]=0,w.state.eye[2]=n.distance,o(w.state.eye,w.state.eye,k,-n.phi),i(w.state.eye,w.state.eye,k,n.theta),s(w.state.eye,w.state.eye,n.center),m(w.state.view,w.state.eye,n.center,n.up),v(w.state.projection,n.fovY,w.params.aspectRatio,n.near,n.far),p(w.state.viewInv,w.state.view)}function j(){t=!0}function D(e){w.params.aspectRatio=e,O(),j()}function R(e){e.zoom=0,e.dTheta=0,e.dPhi=0,e.panX=0,e.panY=0,e.panZ=0,e.yaw=0,e.pitch=0}var B={};function M(e){var t;l(T),n.zoomAboutCursor&&(t=n.distance*Math.tan(.5*n.fovY),x[0]=e.mouseX*n.aspectRatio*t,x[1]=e.mouseY*t,x[2]=0,d(T,T,x)),x[0]=1+e.zoom,x[1]=1+e.zoom,x[2]=1,h(T,T,x),n.zoomAboutCursor&&(t=n.distance*Math.tan(.5*n.fovY),x[0]=-e.mouseX*n.aspectRatio*t,x[1]=-e.mouseY*t,x[2]=0,d(T,T,x)),T[12]-=.5*e.panX,T[13]-=.5*e.panY,r(n.center,n.center,w.state.view),r(n.center,n.center,T),r(n.center,n.center,w.state.viewInv),n.rotateAboutCenter&&u(n.rotationCenter,n.center),n.distance*=1+e.zoom;var a=n.phi;n.phi+=e.dPhi,n.phi=Math.min(g,Math.max(b,n.phi));var s=n.phi-a,p=n.theta;n.theta+=e.dTheta;var m=n.theta-p;if(i(n.center,n.center,n.rotationCenter,m-n.theta),o(n.center,n.center,n.rotationCenter,-s),i(n.center,n.center,n.rotationCenter,n.theta),0!==e.yaw||0!==e.pitch){C[0]=w.state.view[0],C[1]=w.state.view[4],C[2]=w.state.view[8],f(C,C),_[0]=w.state.view[1],_[1]=w.state.view[5],_[2]=w.state.view[9],f(_,_),E[0]=w.state.view[2],E[1]=w.state.view[6],E[2]=w.state.view[10],f(E,E);var v=Math.min(g,Math.max(b,n.phi+.5*e.pitch)),y=v-n.phi;c(n.center,n.center,C,-Math.sin(.5*e.yaw)*n.distance),c(n.center,n.center,_,-Math.sin(y)*n.distance),c(n.center,n.center,E,(2-Math.cos(.5*e.yaw)-Math.cos(y))*n.distance),n.phi=v,n.theta+=.5*e.yaw}O(),j()}return R(B),D(w.params.aspectRatio),w}},{"gl-mat4/identity":31,"gl-mat4/invert":32,"gl-mat4/lookAt":33,"gl-mat4/perspective":34,"gl-mat4/scale":35,"gl-mat4/translate":36,"gl-vec3/add":37,"gl-vec3/copy":38,"gl-vec3/equals":40,"gl-vec3/normalize":41,"gl-vec3/rotateX":42,"gl-vec3/rotateY":43,"gl-vec3/scaleAndAdd":44,"gl-vec3/transformMat4":45}],31:[function(e,t,n){t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],32:[function(e,t,n){t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],u=t[7],f=t[8],l=t[9],p=t[10],d=t[11],h=t[12],m=t[13],v=t[14],g=t[15],b=n*s-r*a,y=n*c-i*a,w=n*u-o*a,x=r*c-i*s,_=r*u-o*s,C=i*u-o*c,E=f*m-l*h,k=f*v-p*h,T=f*g-d*h,S=l*v-p*m,A=l*g-d*m,P=p*g-d*v,O=b*P-y*A+w*S+x*T-_*k+C*E;if(!O)return null;return O=1/O,e[0]=(s*P-c*A+u*S)*O,e[1]=(i*A-r*P-o*S)*O,e[2]=(m*C-v*_+g*x)*O,e[3]=(p*_-l*C-d*x)*O,e[4]=(c*T-a*P-u*k)*O,e[5]=(n*P-i*T+o*k)*O,e[6]=(v*w-h*C-g*y)*O,e[7]=(f*C-p*w+d*y)*O,e[8]=(a*A-s*T+u*E)*O,e[9]=(r*T-n*A-o*E)*O,e[10]=(h*_-m*w+g*b)*O,e[11]=(l*w-f*_-d*b)*O,e[12]=(s*k-a*S-c*E)*O,e[13]=(n*S-r*k+i*E)*O,e[14]=(m*y-h*x-v*b)*O,e[15]=(f*x-l*y+p*b)*O,e}},{}],33:[function(e,t,n){var r=e("./identity");t.exports=function(e,t,n,i){var o,a,s,c,u,f,l,p,d,h,m=t[0],v=t[1],g=t[2],b=i[0],y=i[1],w=i[2],x=n[0],_=n[1],C=n[2];if(Math.abs(m-x)<1e-6&&Math.abs(v-_)<1e-6&&Math.abs(g-C)<1e-6)return r(e);l=m-x,p=v-_,d=g-C,h=1/Math.sqrt(l*l+p*p+d*d),o=y*(d*=h)-w*(p*=h),a=w*(l*=h)-b*d,s=b*p-y*l,(h=Math.sqrt(o*o+a*a+s*s))?(o*=h=1/h,a*=h,s*=h):(o=0,a=0,s=0);c=p*s-d*a,u=d*o-l*s,f=l*a-p*o,(h=Math.sqrt(c*c+u*u+f*f))?(c*=h=1/h,u*=h,f*=h):(c=0,u=0,f=0);return e[0]=o,e[1]=c,e[2]=l,e[3]=0,e[4]=a,e[5]=u,e[6]=p,e[7]=0,e[8]=s,e[9]=f,e[10]=d,e[11]=0,e[12]=-(o*m+a*v+s*g),e[13]=-(c*m+u*v+f*g),e[14]=-(l*m+p*v+d*g),e[15]=1,e}},{"./identity":31}],34:[function(e,t,n){t.exports=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e}},{}],35:[function(e,t,n){t.exports=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],36:[function(e,t,n){t.exports=function(e,t,n){var r,i,o,a,s,c,u,f,l,p,d,h,m=n[0],v=n[1],g=n[2];t===e?(e[12]=t[0]*m+t[4]*v+t[8]*g+t[12],e[13]=t[1]*m+t[5]*v+t[9]*g+t[13],e[14]=t[2]*m+t[6]*v+t[10]*g+t[14],e[15]=t[3]*m+t[7]*v+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],c=t[5],u=t[6],f=t[7],l=t[8],p=t[9],d=t[10],h=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=c,e[6]=u,e[7]=f,e[8]=l,e[9]=p,e[10]=d,e[11]=h,e[12]=r*m+s*v+l*g+t[12],e[13]=i*m+c*v+p*g+t[13],e[14]=o*m+u*v+d*g+t[14],e[15]=a*m+f*v+h*g+t[15]);return e}},{}],37:[function(e,t,n){t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},{}],38:[function(e,t,n){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],39:[function(e,t,n){t.exports=1e-6},{}],40:[function(e,t,n){t.exports=function(e,t){var n=e[0],i=e[1],o=e[2],a=t[0],s=t[1],c=t[2];return Math.abs(n-a)<=r*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=r*Math.max(1,Math.abs(o),Math.abs(c))};var r=e("./epsilon")},{"./epsilon":39}],41:[function(e,t,n){t.exports=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o);return e}},{}],42:[function(e,t,n){t.exports=function(e,t,n,r){var i=n[1],o=n[2],a=t[1]-i,s=t[2]-o,c=Math.sin(r),u=Math.cos(r);return e[0]=t[0],e[1]=i+a*u-s*c,e[2]=o+a*c+s*u,e}},{}],43:[function(e,t,n){t.exports=function(e,t,n,r){var i=n[0],o=n[2],a=t[0]-i,s=t[2]-o,c=Math.sin(r),u=Math.cos(r);return e[0]=i+s*c+a*u,e[1]=t[1],e[2]=o+s*u-a*c,e}},{}],44:[function(e,t,n){t.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},{}],45:[function(e,t,n){arguments[4][27][0].apply(n,arguments)},{dup:27}],46:[function(e,t,n){var r=[],i=[],o="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function a(e,t){if(t=t||{},void 0===e)throw new Error(o);var n,a=!0===t.prepend?"prepend":"append",s=void 0!==t.container?t.container:document.querySelector("head"),c=r.indexOf(s);return-1===c&&(c=r.push(s)-1,i[c]={}),void 0!==i[c]&&void 0!==i[c][a]?n=i[c][a]:(n=i[c][a]=function(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}(),"prepend"===a?s.insertBefore(n,s.childNodes[0]):s.appendChild(n)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),n.styleSheet?n.styleSheet.cssText+=e:n.textContent+=e,n}t.exports=a,t.exports.insertCss=a},{}],47:[function(e,t,n){"use strict";t.exports=function(e,t){t||(t=e,e=window);var n=0,i=0,o=0,a={shift:!1,alt:!1,control:!1,meta:!1},s=!1;function c(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==a.alt,a.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==a.shift,a.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==a.control,a.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==a.meta,a.meta=!!e.metaKey),t}function u(e,s){var u=r.x(s),f=r.y(s);"buttons"in s&&(e=0|s.buttons),(e!==n||u!==i||f!==o||c(s))&&(n=0|e,i=u||0,o=f||0,t&&t(n,i,o,a))}function f(e){u(0,e)}function l(){(n||i||o||a.shift||a.alt||a.meta||a.control)&&(i=o=0,n=0,a.shift=a.alt=a.control=a.meta=!1,t&&t(0,0,0,a))}function p(e){c(e)&&t&&t(n,i,o,a)}function d(e){0===r.buttons(e)?u(0,e):u(n,e)}function h(e){u(n|r.buttons(e),e)}function m(e){u(n&~r.buttons(e),e)}function v(){s||(s=!0,e.addEventListener("mousemove",d),e.addEventListener("mousedown",h),e.addEventListener("mouseup",m),e.addEventListener("mouseleave",f),e.addEventListener("mouseenter",f),e.addEventListener("mouseout",f),e.addEventListener("mouseover",f),e.addEventListener("blur",l),e.addEventListener("keyup",p),e.addEventListener("keydown",p),e.addEventListener("keypress",p),e!==window&&(window.addEventListener("blur",l),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}v();var g={element:e};return Object.defineProperties(g,{enabled:{get:function(){return s},set:function(t){t?v():s&&(s=!1,e.removeEventListener("mousemove",d),e.removeEventListener("mousedown",h),e.removeEventListener("mouseup",m),e.removeEventListener("mouseleave",f),e.removeEventListener("mouseenter",f),e.removeEventListener("mouseout",f),e.removeEventListener("mouseover",f),e.removeEventListener("blur",l),e.removeEventListener("keyup",p),e.removeEventListener("keydown",p),e.removeEventListener("keypress",p),e!==window&&(window.removeEventListener("blur",l),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))},enumerable:!0},buttons:{get:function(){return n},enumerable:!0},x:{get:function(){return i},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return a},enumerable:!0}}),g};var r=e("mouse-event")},{"mouse-event":49}],48:[function(e,t,n){var r={left:0,top:0};t.exports=function(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var i=e.clientX||0,o=e.clientY||0,a=(s=t,s===window||s===document||s===document.body?r:s.getBoundingClientRect());var s;return n[0]=i-a.left,n[1]=o-a.top,n}},{}],49:[function(e,t,n){"use strict";function r(e){return e.target||e.srcElement||window}n.buttons=function(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){if(2===(t=e.which))return 4;if(3===t)return 2;if(t>0)return 1<<t-1}else if("button"in e){var t;if(1===(t=e.button))return 4;if(2===t)return 2;if(t>=0)return 1<<t}}return 0},n.element=r,n.x=function(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=r(e).getBoundingClientRect();return e.clientX-t.left}return 0},n.y=function(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=r(e).getBoundingClientRect();return e.clientY-t.top}return 0}},{}],50:[function(e,t,n){"use strict";t.exports=function(e){e=e||window;var t,n,a,s,c=o(),u=[null,null],f=[null,null],l=[null,null],p=[null,null],d=0,h={},m=e===window?function(){t=window.innerWidth,n=window.innerHeight}:function(){t=e.clientWidth,n=e.clientHeight},v=0,g={},b=r(e,function(e,t,n,r){a=t,s=n,v=e,g=r});function y(r){i(r,e,l),m(),h.buttons=v,h.mods=g,h.x0=h.x=h.x1=2*l[0]/t-1,h.y0=h.y=h.y1=1-2*l[1]/n,h.x2=null,h.y2=null,h.dx=2*r.deltaX/t,h.dy=-2*r.deltaY/n,h.dz=2*r.deltaZ/t,h.active=1,h.zoomx=1,h.zoomy=1,h.theta=0,h.dtheta=0,h.originalEvent=r,c.emit("wheel",h),u[0]=l[0],u[1]=l[1]}var w=null,x=null,_=0;function C(r){i(r,e,l),_=0,m(),h.buttons=v,h.mods=g,h.x=h.x1=2*l[0]/t-1,h.y=h.y1=1-2*l[1]/n,h.x2=null,h.y2=null,h.active=_,h.x0=2*w/t-1,h.y0=1-2*x/n,h.dx=0,h.dy=0,h.dz=0,h.zoomx=1,h.zoomy=1,h.theta=0,h.dtheta=0,h.originalEvent=r,c.emit("mouseup",h),w=x=null,u[0]=l[0],u[1]=l[1]}function E(r){i(r,e,l),_=1,m(),w=a,x=s,h.buttons=v,h.mods=g,h.x=h.x0=h.x1=2*l[0]/t-1,h.y=h.y0=h.y1=1-2*l[1]/n,h.x2=null,h.y2=null,h.active=_,h.dx=0,h.dy=0,h.dz=0,h.zoomx=1,h.zoomy=1,h.theta=0,h.dtheta=0,h.originalEvent=r,c.emit("mousedown",h),u[0]=l[0],u[1]=l[1]}function k(r){i(r,e,l),m(),h.buttons=v,h.mods=g,h.x0=2*w/t-1,h.y0=1-2*x/n,h.x=h.x1=2*l[0]/t-1,h.y=h.y1=1-2*l[1]/n,h.x2=null,h.y2=null,h.dx=2*(l[0]-u[0])/t,h.dy=-2*(l[1]-u[1])/n,h.active=_,h.dz=0,h.zoomx=1,h.zoomy=1,h.theta=0,h.dtheta=0,h.originalEvent=r,c.emit("mousemove",h),u[0]=l[0],u[1]=l[1]}function T(e){for(var t=e.identifier,n=0;n<p.length;n++)if(p[n]&&p[n].touch&&p[n].touch.identifier===t)return n;return-1}function S(r){f[0]=null,f[1]=null;for(var o=0;o<r.changedTouches.length;o++){var a=r.changedTouches[o],s=a.identifier,u=T(s);if(-1===u&&d<2){var l=p[0]?1:0,v=p[0]?0:1,g={position:[0,0],touch:null};p[l]=g,d++,g.touch=a,i(a,e,g.position);p[v]&&p[v].touch}}for(var b=0,y=0,_=0,o=0;o<p.length;o++)p[o]&&(b+=p[o].position[0],y+=p[o].position[1],_++);if(b/=_,y/=_,d>0){if(h.theta=0,_>1){var C=p[1].position[0]-p[0].position[0],E=(p[0].position[1]-p[1].position[1])*t/n;h.theta=Math.atan2(E,C)}m(),h.buttons=0,h.mods={},h.active=d,w=b,x=y,h.x0=2*w/t-1,h.y0=1-2*x/n,h.x=2*b/t-1,h.y=1-2*y/n,h.x1=2*p[0].position[0]/t-1,h.y1=1-2*p[0].position[1]/n,d>1&&(h.x2=2*p[1].position[0]/t-1,h.y2=1-2*p[1].position[1]/n),h.active=d,h.dx=0,h.dy=0,h.dz=0,h.zoomx=1,h.zoomy=1,h.dtheta=0,h.originalEvent=r,c.emit(1===d?"touchstart":"pinchstart",h)}}function A(r){for(var o,a=!1,s=0;s<r.changedTouches.length;s++){var u=r.changedTouches[s];-1!==(o=T(u))&&(a=!0,p[o].touch=u,i(u,e,p[o].position))}if(a)if(1===d){for(o=0;o<p.length&&!p[o];o++);if(p[o]&&f[o]){var l=p[o].position[0],m=p[o].position[1],v=l-f[o][0],b=m-f[o][1];h.buttons=0,h.mods={},h.active=d,h.x=h.x1=2*l/t-1,h.y=h.y1=1-2*m/n,h.x2=null,h.y2=null,h.x0=2*w/t-1,h.y0=1-2*x/n,h.dx=2*v/t,h.dy=-2*b/n,h.dz=0,h.zoomx=1,h.zoomy=1,h.theta=0,h.dtheta=0,h.originalEvent=r,c.emit("touchmove",h)}}else if(2===d&&f[0]&&f[1]){var y=f[0],_=f[1],C=_[0]-y[0],E=(_[1]-y[1])*t/n,k=p[0].position,S=p[1].position,A=S[0]-k[0],P=(k[1]-S[1])*t/n,O=.5*Math.sqrt(C*C+E*E),j=Math.atan2(E,C),D=.5*Math.sqrt(A*A+P*P),R=Math.atan2(P,A),B=.5*(_[0]+y[0]),M=.5*(_[1]+y[1]),v=.5*(S[0]+k[0]-y[0]-_[0]),b=.5*(S[1]+k[1]-y[1]-_[1]),L=D/O,z=R-j;h.buttons=0,h.mods=g,h.active=d,h.x=2*B/t-1,h.y=1-2*M/n,h.x0=2*w/t-1,h.y0=1-2*x/n,h.x1=2*k[0]/t-1,h.y1=1-2*k[1]/n,h.x2=2*S[0]/t-1,h.y2=1-2*S[1]/n,h.dx=2*v/t,h.dy=-2*b/n,h.dz=0,h.zoomx=L,h.zoomy=L,h.theta=R,h.dtheta=z,h.originalEvent=r,c.emit("pinchmove",h)}p[0]&&(f[0]=p[0].position.slice()),p[1]&&(f[1]=p[1].position.slice())}function P(e){for(var r,i=0;i<e.changedTouches.length;i++){var o=e.changedTouches[i],a=T(o);if(-1!==a){r=p[a],p[a]=null,d--;var s=0===a?1:0;p[s]&&p[s].touch}}var u=0,f=0;if(0===d)r&&(u=r.position[0],f=r.position[1]);else{for(var l=0,i=0;i<p.length;i++)p[i]&&(u+=p[i].position[0],f+=p[i].position[1],l++);u/=l,f/=l}d<2&&(h.buttons=0,h.mods=g,h.active=d,h.x=2*u/t-1,h.y=1-2*f/n,h.x0=2*w/t-1,h.y0=1-2*x/n,h.dx=0,h.dy=0,h.dz=0,h.zoomx=1,h.zoomy=1,h.theta=0,h.dtheta=0,h.originalEvent=e,c.emit(0===d?"touchend":"pinchend",h)),0===d&&(w=x=null)}var O=!1;function j(){O||(O=!0,b.enabled=!0,e.addEventListener("wheel",y,!1),e.addEventListener("mousedown",E,!1),window.addEventListener("mousemove",k,!1),window.addEventListener("mouseup",C,!1),e.addEventListener("touchstart",S,!1),window.addEventListener("touchmove",A,!1),window.addEventListener("touchend",P,!1),window.addEventListener("touchcancel",P,!1))}return j(),c.enable=j,c.disable=function(){O&&(O=!1,b.enabled=!1,e.removeEventListener("wheel",y,!1),e.removeEventListener("mousedown",E,!1),window.removeEventListener("mousemove",k,!1),window.removeEventListener("mouseup",C,!1),e.removeEventListener("touchstart",S,!1),window.removeEventListener("touchmove",A,!1),window.removeEventListener("touchend",P,!1),window.removeEventListener("touchcancel",P,!1))},c};var r=e("mouse-change"),i=e("mouse-event-offset"),o=e("event-emitter")},{"event-emitter":22,"mouse-change":47,"mouse-event-offset":48}],51:[function(e,t,n){var r,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,f=[],l=!1,p=-1;function d(){l&&u&&(l=!1,u.length?f=u.concat(f):p=-1,f.length&&h())}function h(){if(!l){var e=c(d);l=!0;for(var t=f.length;t;){for(u=f,f=[];++p<t;)u&&u[p].run();p=-1,t=f.length}u=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new m(e,t)),1!==f.length||l||c(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],52:[function(e,t,n){var r,i;r=this,i=function(){function e(e,t){this.id=N++,this.type=e,this.data=t}function t(e){return"["+function e(t){if(0===t.length)return[];var n=t.charAt(0),r=t.charAt(t.length-1);if(1<t.length&&n===r&&('"'===n||"'"===n))return['"'+t.substr(1,t.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t))return e(t.substr(0,n.index)).concat(e(n[1])).concat(e(t.substr(n.index+n[0].length)));if(1===(n=t.split(".")).length)return['"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(t=[],r=0;r<n.length;++r)t=t.concat(e(n[r]));return t}(e).join("][")+"]"}function n(e){return"string"==typeof e?e.split():e}function r(e){return"string"==typeof e?document.querySelector(e):e}function i(e){var t,i,o,a,s=e||{};e={};var c=[],u=[],f="undefined"==typeof window?1:window.devicePixelRatio,l=!1,p=function(e){},d=function(){};if("string"==typeof s?t=document.querySelector(s):"object"==typeof s&&("string"==typeof s.nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?t=s:"function"==typeof s.drawArrays||"function"==typeof s.drawElements?o=(a=s).canvas:("gl"in s?a=s.gl:"canvas"in s?o=r(s.canvas):"container"in s&&(i=r(s.container)),"attributes"in s&&(e=s.attributes),"extensions"in s&&(c=n(s.extensions)),"optionalExtensions"in s&&(u=n(s.optionalExtensions)),"onDone"in s&&(p=s.onDone),"profile"in s&&(l=!!s.profile),"pixelRatio"in s&&(f=+s.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?o=t:i=t),!a){if(!o){if(!(t=function(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;e!==document.body&&(t=(r=e.getBoundingClientRect()).right-r.left,r=r.bottom-r.top),i.width=n*t,i.height=n*r,F(i.style,{width:t+"px",height:r+"px"})}var i=document.createElement("canvas");return F(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",F(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(i)}}}(i||document.body,0,f)))return null;o=t.canvas,d=t.onDestroy}a=function(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(o,e)}return a?{gl:a,canvas:o,container:i,extensions:c,optionalExtensions:u,pixelRatio:f,profile:l,onDone:p,onDestroy:d}:(d(),p("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function o(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function a(e){var t,n;return t=(65535<e)<<4,t|=n=(255<(e>>>=t))<<3,(t|=n=(15<(e>>>=n))<<2)|(n=(3<(e>>>=n))<<1)|e>>>n>>1}function s(){function e(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}return 0<(t=n[a(e)>>2]).length?t.pop():new ArrayBuffer(e)}function t(e){n[a(e.byteLength)>>2].push(e)}var n=o(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,n){var r=null;switch(t){case 5120:r=new Int8Array(e(n),0,n);break;case 5121:r=new Uint8Array(e(n),0,n);break;case 5122:r=new Int16Array(e(2*n),0,n);break;case 5123:r=new Uint16Array(e(2*n),0,n);break;case 5124:r=new Int32Array(e(4*n),0,n);break;case 5125:r=new Uint32Array(e(4*n),0,n);break;case 5126:r=new Float32Array(e(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(e){t(e.buffer)}}}function c(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||W(e.data))}function u(e,t,n,r,i,o){for(var a=0;a<t;++a)for(var s=e[a],c=0;c<n;++c)for(var u=s[c],f=0;f<r;++f)i[o++]=u[f]}function f(e){return 0|Q[Object.prototype.toString.call(e)]}function l(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function p(e,t,n,r,i,o,a){for(var s=0,c=0;c<n;++c)for(var u=0;u<r;++u)e[s++]=t[i*c+o*u+a]}function d(e,t,n,r){function i(t){this.id=u++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,n.profile&&(this.stats={size:0})}function o(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function a(e,t,n,r,i,a){if(e.usage=n,Array.isArray(t)){if(e.dtype=r||5126,0<t.length)if(Array.isArray(t[0])){i=ee(t);for(var s=r=1;s<i.length;++s)r*=i[s];e.dimension=r,o(e,t=K(t,i,e.dtype),n),a?e.persistentData=t:Y.freeType(t)}else"number"==typeof t[0]?(e.dimension=i,l(i=Y.allocType(e.dtype,t.length),t),o(e,i,n),a?e.persistentData=i:Y.freeType(i)):W(t[0])&&(e.dimension=t[0].length,e.dtype=r||f(t[0])||5126,o(e,t=K(t,[t.length,t[0].length],e.dtype),n),a?e.persistentData=t:Y.freeType(t))}else if(W(t))e.dtype=r||f(t),e.dimension=i,o(e,t,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(c(t)){i=t.shape;var u=t.stride,d=(s=t.offset,0),h=0,m=0,v=0;1===i.length?(d=i[0],h=1,m=u[0],v=0):2===i.length&&(d=i[0],h=i[1],m=u[0],v=u[1]),e.dtype=r||f(t.data)||5126,e.dimension=h,p(i=Y.allocType(e.dtype,d*h),t.data,d,h,m,v,s),o(e,i,n),a?e.persistentData=i:Y.freeType(i)}}function s(n){t.bufferCount--;for(var i=0;i<r.state.length;++i){var o=r.state[i];o.buffer===n&&(e.disableVertexAttribArray(i),o.buffer=null)}e.deleteBuffer(n.buffer),n.buffer=null,delete d[n.id]}var u=0,d={};i.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},i.prototype.destroy=function(){s(this)};var h=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(d).forEach(function(t){e+=d[t].stats.size}),e}),{create:function(r,o,u,h){function m(t){var r=35044,i=null,o=0,s=0,u=1;return Array.isArray(t)||W(t)||c(t)?i=t:"number"==typeof t?o=0|t:t&&("data"in t&&(i=t.data),"usage"in t&&(r=Z[t.usage]),"type"in t&&(s=J[t.type]),"dimension"in t&&(u=0|t.dimension),"length"in t&&(o=0|t.length)),v.bind(),i?a(v,i,r,s,u,h):(o&&e.bufferData(v.type,o,r),v.dtype=s||5121,v.usage=r,v.dimension=u,v.byteLength=o),n.profile&&(v.stats.size=v.byteLength*te[v.dtype]),m}t.bufferCount++;var v=new i(o);return d[v.id]=v,u||m(r),m._reglType="buffer",m._buffer=v,m.subdata=function(t,n){var r,i=0|(n||0);if(v.bind(),W(t))e.bufferSubData(v.type,i,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var o=Y.allocType(v.dtype,t.length);l(o,t),e.bufferSubData(v.type,i,o),Y.freeType(o)}else(Array.isArray(t[0])||W(t[0]))&&(r=ee(t),o=K(t,r,v.dtype),e.bufferSubData(v.type,i,o),Y.freeType(o))}else if(c(t)){r=t.shape;var a=t.stride,s=o=0,u=0,d=0;1===r.length?(o=r[0],s=1,u=a[0],d=0):2===r.length&&(o=r[0],s=r[1],u=a[0],d=a[1]),r=Array.isArray(t.data)?v.dtype:f(t.data),p(r=Y.allocType(r,o*s),t.data,o,s,u,d,t.offset),e.bufferSubData(v.type,i,r),Y.freeType(r)}return m},n.profile&&(m.stats=v.stats),m.destroy=function(){s(v)},m},createStream:function(e,t){var n=h.pop();return n||(n=new i(e)),n.bind(),a(n,t,35040,0,1,!1),n},destroyStream:function(e){h.push(e)},clear:function(){$(d).forEach(s),h.forEach(s)},getBuffer:function(e){return e&&e._buffer instanceof i?e._buffer:null},restore:function(){$(d).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:a}}function h(e,t,n,r){function i(e){this.id=u++,s[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function o(r,i,o,a,s,u,f){if(r.buffer.bind(),i){var l=f;f||W(i)&&(!c(i)||W(i.data))||(l=t.oes_element_index_uint?5125:5123),n._initBuffer(r.buffer,i,o,l,3)}else e.bufferData(34963,u,o),r.buffer.dtype=l||5121,r.buffer.usage=o,r.buffer.dimension=3,r.buffer.byteLength=u;if(l=f,!f){switch(r.buffer.dtype){case 5121:case 5120:l=5121;break;case 5123:case 5122:l=5123;break;case 5125:case 5124:l=5125}r.buffer.dtype=l}r.type=l,0>(i=s)&&(i=r.buffer.byteLength,5123===l?i>>=1:5125===l&&(i>>=2)),r.vertCount=i,i=a,0>a&&(i=4,1===(a=r.buffer.dimension)&&(i=0),2===a&&(i=1),3===a&&(i=4)),r.primType=i}function a(e){r.elementsCount--,delete s[e.id],e.buffer.destroy(),e.buffer=null}var s={},u=0,f={uint8:5121,uint16:5123};t.oes_element_index_uint&&(f.uint32=5125),i.prototype.bind=function(){this.buffer.bind()};var l=[];return{create:function(e,t){function s(e){if(e)if("number"==typeof e)u(e),l.primType=4,l.vertCount=0|e,l.type=5121;else{var t=null,n=35044,r=-1,i=-1,a=0,p=0;Array.isArray(e)||W(e)||c(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(n=Z[e.usage]),"primitive"in e&&(r=ne[e.primitive]),"count"in e&&(i=0|e.count),"type"in e&&(p=f[e.type]),"length"in e?a=0|e.length:(a=i,5123===p||5122===p?a*=2:5125!==p&&5124!==p||(a*=4))),o(l,t,n,r,i,a,p)}else u(),l.primType=4,l.vertCount=0,l.type=5121;return s}var u=n.create(null,34963,!0),l=new i(u._buffer);return r.elementsCount++,s(e),s._reglType="elements",s._elements=l,s.subdata=function(e,t){return u.subdata(e,t),s},s.destroy=function(){a(l)},s},createStream:function(e){var t=l.pop();return t||(t=new i(n.create(null,34963,!0,!1)._buffer)),o(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){l.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof i?e._elements:null},clear:function(){$(s).forEach(a)}}}function m(e){for(var t=Y.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(1/0===e[n])t[n]=31744;else if(-1/0===e[n])t[n]=64512;else{re[0]=e[n];var r=(o=ie[0])>>>31<<15,i=(o<<1>>>24)-127,o=o>>13&1023;t[n]=-24>i?r:-14>i?r+(o+1024>>-14-i):15<i?r+31744:r+(i+15<<10)+o}return t}function v(e){return Array.isArray(e)||W(e)}function g(e){return"[object "+e+"]"}function b(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function y(e){return!(!Array.isArray(e)||0===e.length||!v(e[0]))}function w(e){return Object.prototype.toString.call(e)}function x(e){if(!e)return!1;var t=w(e);return 0<=de.indexOf(t)||(b(e)||y(e)||c(e))}function _(e,t){36193===e.type?(e.data=m(t),Y.freeType(t)):e.data=t}function C(e,t,n,r,i,o){if(e=void 0!==me[e]?me[e]:se[e]*he[t],o&&(e*=6),i){for(r=0;1<=n;)r+=e*n*n,n/=2;return r}return e*n*r}function E(e,t,n,r,i,o,a){function s(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function u(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function f(e,t){if("object"==typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=H[t.colorSpace]),"type"in t&&(e.type=V[t.type]);var n=e.width,r=e.height,i=e.channels,o=!1;"shape"in t?(n=t.shape[0],r=t.shape[1],3===t.shape.length&&(i=t.shape[2],o=!0)):("radius"in t&&(n=r=t.radius),"width"in t&&(n=t.width),"height"in t&&(r=t.height),"channels"in t&&(i=t.channels,o=!0)),e.width=0|n,e.height=0|r,e.channels=0|i,n=!1,"format"in t&&(n=t.format,r=e.internalformat=G[n],e.format=ie[r],n in V&&!("type"in t)&&(e.type=V[n]),n in q&&(e.compressed=!0),n=!0),!o&&n?e.channels=se[e.format]:o&&!n&&e.channels!==ae[e.format]&&(e.format=e.internalformat=ae[e.channels])}}function l(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function p(){s.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function d(e,t){var n=null;if(x(t)?n=t:t&&(f(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),x(t.data)&&(n=t.data)),t.copy){var r=i.viewportWidth,o=i.viewportHeight;e.width=e.width||r-e.xOffset,e.height=e.height||o-e.yOffset,e.needsCopy=!0}else if(n){if(W(n))e.channels=e.channels||4,e.data=n,"type"in t||5121!==e.type||(e.type=0|Q[Object.prototype.toString.call(n)]);else if(b(n)){switch(e.channels=e.channels||4,o=(r=n).length,e.type){case 5121:case 5123:case 5125:case 5126:(o=Y.allocType(e.type,o)).set(r),e.data=o;break;case 36193:e.data=m(r)}e.alignment=1,e.needsFree=!0}else if(c(n)){r=n.data,Array.isArray(r)||5121!==e.type||(e.type=0|Q[Object.prototype.toString.call(r)]);o=n.shape;var a,s,u,l,p=n.stride;3===o.length?(u=o[2],l=p[2]):l=u=1,a=o[0],s=o[1],o=p[0],p=p[1],e.alignment=1,e.width=a,e.height=s,e.channels=u,e.format=e.internalformat=ae[u],e.needsFree=!0,a=l,n=n.offset,u=e.width,l=e.height,s=e.channels;for(var d=Y.allocType(36193===e.type?5126:e.type,u*l*s),h=0,g=0;g<l;++g)for(var C=0;C<u;++C)for(var E=0;E<s;++E)d[h++]=r[o*C+p*g+a*E+n];_(e,d)}else if(w(n)===ce||w(n)===ue)w(n)===ce?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(w(n)===fe)e.element=n,e.width=n.width,e.height=n.height,e.channels=4;else if(w(n)===le)e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if(w(n)===pe)e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(y(n)){for(r=e.width||n[0].length,o=e.height||n.length,p=e.channels,p=v(n[0][0])?p||n[0][0].length:p||1,a=X.shape(n),u=1,l=0;l<a.length;++l)u*=a[l];u=Y.allocType(36193===e.type?5126:e.type,u),X.flatten(n,a,"",u),_(e,u),e.alignment=1,e.width=r,e.height=o,e.channels=p,e.format=e.internalformat=ae[p],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4}function h(t,n,i,o,a){var s=t.element,c=t.data,u=t.internalformat,f=t.format,p=t.type,d=t.width,h=t.height;l(t),s?e.texSubImage2D(n,a,i,o,f,p,s):t.compressed?e.compressedTexSubImage2D(n,a,i,o,u,d,h,c):t.needsCopy?(r(),e.copyTexSubImage2D(n,a,i,o,t.xOffset,t.yOffset,d,h)):e.texSubImage2D(n,a,i,o,d,h,f,p,c)}function g(){return de.pop()||new p}function E(e){e.needsFree&&Y.freeType(e.data),p.call(e),de.push(e)}function k(e,t,n){var r=e.images[0]=g();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function T(e,t){var n=null;if(x(t))u(n=e.images[0]=g(),e),d(n,t),e.mipmask=1;else if(f(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)u(n=e.images[i]=g(),e),n.width>>=i,n.height>>=i,d(n,r[i]),e.mipmask|=1<<i;else u(n=e.images[0]=g(),e),d(n,t),e.mipmask=1;u(e,e.images[0])}function S(t,n){for(var i=t.images,o=0;o<i.length&&i[o];++o){var a=i[o],s=n,c=o,u=a.element,f=a.data,p=a.internalformat,d=a.format,h=a.type,m=a.width,v=a.height,g=a.channels;l(a),u?e.texImage2D(s,c,d,d,h,u):a.compressed?e.compressedTexImage2D(s,c,p,m,v,0,f):a.needsCopy?(r(),e.copyTexImage2D(s,c,d,a.xOffset,a.yOffset,m,v,0)):((a=!f)&&(f=Y.zero.allocType(h,m*v*g)),e.texImage2D(s,c,d,m,v,0,d,h,f),a&&f&&Y.zero.freeType(f))}}function A(){var e=he.pop()||new function(){s.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)};s.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function P(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&E(t[n]),t[n]=null;he.push(e)}function O(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function j(e,t){"min"in t&&(e.minFilter=N[t.min],0<=oe.indexOf(e.minFilter)&&!("faces"in t)&&(e.genMipmaps=!0)),"mag"in t&&(e.magFilter=U[t.mag]);var n=e.wrapS,r=e.wrapT;if("wrap"in t){var i=t.wrap;"string"==typeof i?n=r=I[i]:Array.isArray(i)&&(n=I[i[0]],r=I[i[1]])}else"wrapS"in t&&(n=I[t.wrapS]),"wrapT"in t&&(r=I[t.wrapT]);if(e.wrapS=n,e.wrapT=r,"anisotropic"in t&&(e.anisotropic=t.anisotropic),"mipmap"in t){switch(n=!1,typeof t.mipmap){case"string":e.mipmapHint=z[t.mipmap],n=e.genMipmaps=!0;break;case"boolean":n=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,n=!0}!n||"min"in t||(e.minFilter=9984)}}function D(n,r){e.texParameteri(r,10241,n.minFilter),e.texParameteri(r,10240,n.magFilter),e.texParameteri(r,10242,n.wrapS),e.texParameteri(r,10243,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,34046,n.anisotropic),n.genMipmaps&&(e.hint(33170,n.mipmapHint),e.generateMipmap(r))}function R(t){s.call(this),this.mipmask=0,this.internalformat=6408,this.id=me++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new O,a.profile&&(this.stats={size:0})}function B(t){e.activeTexture(33984),e.bindTexture(t.target,t.texture)}function M(){var t=be[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function L(t){var n=t.texture,r=t.unit,i=t.target;0<=r&&(e.activeTexture(33984+r),e.bindTexture(i,null),be[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete ve[t.id],o.textureCount--}var z={"don't care":4352,"dont care":4352,nice:4354,fast:4353},I={repeat:10497,clamp:33071,mirror:33648},U={nearest:9728,linear:9729},N=F({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},U),H={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},G={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},q={};t.ext_srgb&&(G.srgb=35904,G.srgba=35906),t.oes_texture_float&&(V.float32=V.float=5126),t.oes_texture_half_float&&(V.float16=V["half float"]=36193),t.webgl_depth_texture&&(F(G,{depth:6402,"depth stencil":34041}),F(V,{uint16:5123,uint32:5125,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&F(q,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&F(q,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&F(q,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&(q["rgb etc1"]=36196);var J=Array.prototype.slice.call(e.getParameter(34467));Object.keys(q).forEach(function(e){var t=q[e];0<=J.indexOf(t)&&(G[e]=t)});var Z=Object.keys(G);n.textureFormats=Z;var K=[];Object.keys(G).forEach(function(e){K[G[e]]=e});var ee=[];Object.keys(V).forEach(function(e){ee[V[e]]=e});var te=[];Object.keys(U).forEach(function(e){te[U[e]]=e});var ne=[];Object.keys(N).forEach(function(e){ne[N[e]]=e});var re=[];Object.keys(I).forEach(function(e){re[I[e]]=e});var ie=Z.reduce(function(e,t){var n=G[t];return 6409===n||6406===n||6409===n||6410===n||6402===n||34041===n?e[n]=n:32855===n||0<=t.indexOf("rgba")?e[n]=6408:e[n]=6407,e},{}),de=[],he=[],me=0,ve={},ge=n.maxTextureUnits,be=Array(ge).map(function(){return null});return F(R.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var n=0;n<ge;++n){var r=be[n];if(r){if(0<r.bindCount)continue;r.unit=-1}be[n]=this,t=n;break}a.profile&&o.maxTextureUnits<t+1&&(o.maxTextureUnits=t+1),this.unit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&L(this)}}),a.profile&&(o.getTotalTextureSize=function(){var e=0;return Object.keys(ve).forEach(function(t){e+=ve[t].stats.size}),e}),{create2D:function(t,n){function r(e,t){var n=i.texInfo;O.call(n);var o=A();return"number"==typeof e?k(o,0|e,"number"==typeof t?0|t:0|e):e?(j(n,e),T(o,e)):k(o,1,1),n.genMipmaps&&(o.mipmask=(o.width<<1)-1),i.mipmask=o.mipmask,u(i,o),i.internalformat=o.internalformat,r.width=o.width,r.height=o.height,B(i),S(o,3553),D(n,3553),M(),P(o),a.profile&&(i.stats.size=C(i.internalformat,i.type,o.width,o.height,n.genMipmaps,!1)),r.format=K[i.internalformat],r.type=ee[i.type],r.mag=te[n.magFilter],r.min=ne[n.minFilter],r.wrapS=re[n.wrapS],r.wrapT=re[n.wrapT],r}var i=new R(3553);return ve[i.id]=i,o.textureCount++,r(t,n),r.subimage=function(e,t,n,o){t|=0,n|=0,o|=0;var a=g();return u(a,i),a.width=0,a.height=0,d(a,e),a.width=a.width||(i.width>>o)-t,a.height=a.height||(i.height>>o)-n,B(i),h(a,3553,t,n,o),M(),E(a),r},r.resize=function(t,n){var o=0|t,s=0|n||o;if(o===i.width&&s===i.height)return r;r.width=i.width=o,r.height=i.height=s,B(i);for(var c,u=i.channels,f=i.type,l=0;i.mipmask>>l;++l){var p=o>>l,d=s>>l;if(!p||!d)break;c=Y.zero.allocType(f,p*d*u),e.texImage2D(3553,l,i.format,p,d,0,i.format,i.type,c),c&&Y.zero.freeType(c)}return M(),a.profile&&(i.stats.size=C(i.internalformat,i.type,o,s,!1,!1)),r},r._reglType="texture2d",r._texture=i,a.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},createCube:function(t,n,r,i,s,c){function l(e,t,n,r,i,o){var s,c=p.texInfo;for(O.call(c),s=0;6>s;++s)m[s]=A();if("number"!=typeof e&&e){if("object"==typeof e)if(t)T(m[0],e),T(m[1],t),T(m[2],n),T(m[3],r),T(m[4],i),T(m[5],o);else if(j(c,e),f(p,e),"faces"in e)for(e=e.faces,s=0;6>s;++s)u(m[s],p),T(m[s],e[s]);else for(s=0;6>s;++s)T(m[s],e)}else for(e=0|e||1,s=0;6>s;++s)k(m[s],e,e);for(u(p,m[0]),p.mipmask=c.genMipmaps?(m[0].width<<1)-1:m[0].mipmask,p.internalformat=m[0].internalformat,l.width=m[0].width,l.height=m[0].height,B(p),s=0;6>s;++s)S(m[s],34069+s);for(D(c,34067),M(),a.profile&&(p.stats.size=C(p.internalformat,p.type,l.width,l.height,c.genMipmaps,!0)),l.format=K[p.internalformat],l.type=ee[p.type],l.mag=te[c.magFilter],l.min=ne[c.minFilter],l.wrapS=re[c.wrapS],l.wrapT=re[c.wrapT],s=0;6>s;++s)P(m[s]);return l}var p=new R(34067);ve[p.id]=p,o.cubeCount++;var m=Array(6);return l(t,n,r,i,s,c),l.subimage=function(e,t,n,r,i){n|=0,r|=0,i|=0;var o=g();return u(o,p),o.width=0,o.height=0,d(o,t),o.width=o.width||(p.width>>i)-n,o.height=o.height||(p.height>>i)-r,B(p),h(o,34069+e,n,r,i),M(),E(o),l},l.resize=function(t){if((t|=0)!==p.width){l.width=p.width=t,l.height=p.height=t,B(p);for(var n=0;6>n;++n)for(var r=0;p.mipmask>>r;++r)e.texImage2D(34069+n,r,p.format,t>>r,t>>r,0,p.format,p.type,null);return M(),a.profile&&(p.stats.size=C(p.internalformat,p.type,l.width,l.height,!1,!0)),l}},l._reglType="textureCube",l._texture=p,a.profile&&(l.stats=p.stats),l.destroy=function(){p.decRef()},l},clear:function(){for(var t=0;t<ge;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),be[t]=null;$(ve).forEach(L),o.cubeCount=0,o.textureCount=0},getTexture:function(e){return null},restore:function(){$(ve).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;32>n;++n)if(0!=(t.mipmask&1<<n))if(3553===t.target)e.texImage2D(3553,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;6>r;++r)e.texImage2D(34069+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);D(t.texInfo,t.target)})}}}function k(e,t,n,r,i,o){function a(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=e=0;t?(e=t.width,r=t.height):n&&(e=n.width,r=n.height),this.width=e,this.height=r}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function c(e,t,n){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function u(t,n){n&&(n.texture?e.framebufferTexture2D(36160,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,n.renderbuffer._renderbuffer.renderbuffer))}function f(e){var t=3553,n=null,r=null,i=e;return"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),"texture2d"===(e=i._reglType)?n=i:"textureCube"===e?n=i:"renderbuffer"===e&&(r=i,t=36161),new a(t,n,r)}function l(e,t,n,o,s){return n?((e=r.create2D({width:e,height:t,format:o,type:s}))._texture.refCount=0,new a(3553,e,null)):((e=i.create({width:e,height:t,format:o}))._renderbuffer.refCount=0,new a(36161,null,e))}function p(e){return e&&(e.texture||e.renderbuffer)}function d(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function h(){this.id=C++,E[this.id]=this,this.framebuffer=e.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function m(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function v(t){e.deleteFramebuffer(t.framebuffer),t.framebuffer=null,o.framebufferCount--,delete E[t.id]}function g(t){var r;e.bindFramebuffer(36160,t.framebuffer);var i=t.colorAttachments;for(r=0;r<i.length;++r)u(36064+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(36160,36064+r,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0),e.framebufferTexture2D(36160,36096,3553,null,0),e.framebufferTexture2D(36160,36128,3553,null,0),u(36096,t.depthAttachment),u(36128,t.stencilAttachment),u(33306,t.depthStencilAttachment),e.checkFramebufferStatus(36160),e.bindFramebuffer(36160,y.next?y.next.framebuffer:null),y.cur=y.next,e.getError()}function b(e,t){function n(e,t){var i,o=0,a=0,s=!0,u=!0;i=null;var d=!0,h="rgba",v="uint8",b=1,y=null,_=null,C=null,E=!1;"number"==typeof e?(o=0|e,a=0|t||o):e?("shape"in e?(o=(a=e.shape)[0],a=a[1]):("radius"in e&&(o=a=e.radius),"width"in e&&(o=e.width),"height"in e&&(a=e.height)),("color"in e||"colors"in e)&&(i=e.color||e.colors,Array.isArray(i)),i||("colorCount"in e&&(b=0|e.colorCount),"colorTexture"in e&&(d=!!e.colorTexture,h="rgba4"),"colorType"in e&&(v=e.colorType,!d)&&("half float"===v||"float16"===v?h="rgba16f":"float"!==v&&"float32"!==v||(h="rgba32f")),"colorFormat"in e&&(h=e.colorFormat,0<=w.indexOf(h)?d=!0:0<=x.indexOf(h)&&(d=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(E=!(!e.depthTexture&&!e.depthStencilTexture)),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(y=e.depth,u=!1)),"stencil"in e&&("boolean"==typeof e.stencil?u=e.stencil:(_=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=u=e.depthStencil:(C=e.depthStencil,u=s=!1))):o=a=1;var k=null,T=null,S=null,A=null;if(Array.isArray(i))k=i.map(f);else if(i)k=[f(i)];else for(k=Array(b),i=0;i<b;++i)k[i]=l(o,a,d,h,v);for(o=o||k[0].width,a=a||k[0].height,y?T=f(y):s&&!u&&(T=l(o,a,E,"depth","uint32")),_?S=f(_):u&&!s&&(S=l(o,a,!1,"stencil","uint8")),C?A=f(C):!y&&!_&&u&&s&&(A=l(o,a,E,"depth stencil","depth stencil")),s=null,i=0;i<k.length;++i)c(k[i]),k[i]&&k[i].texture&&(u=be[k[i].texture._texture.format]*ye[k[i].texture._texture.type],null===s&&(s=u));return c(T),c(S),c(A),m(r),r.width=o,r.height=a,r.colorAttachments=k,r.depthAttachment=T,r.stencilAttachment=S,r.depthStencilAttachment=A,n.color=k.map(p),n.depth=p(T),n.stencil=p(S),n.depthStencil=p(A),n.width=r.width,n.height=r.height,g(r),n}var r=new h;return o.framebufferCount++,n(e,t),F(n,{resize:function(e,t){var i=0|e,o=0|t||i;if(i===r.width&&o===r.height)return n;for(var a=r.colorAttachments,s=0;s<a.length;++s)d(a[s],i,o);return d(r.depthAttachment,i,o),d(r.stencilAttachment,i,o),d(r.depthStencilAttachment,i,o),r.width=n.width=i,r.height=n.height=o,g(r),n},_reglType:"framebuffer",_framebuffer:r,destroy:function(){v(r),m(r)},use:function(e){y.setFBO({framebuffer:n},e)}})}var y={cur:null,next:null,dirty:!1,setFBO:null},w=["rgba"],x=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&x.push("srgba"),t.ext_color_buffer_half_float&&x.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&x.push("rgba32f");var _=["uint8"];t.oes_texture_half_float&&_.push("half float","float16"),t.oes_texture_float&&_.push("float","float32");var C=0,E={};return F(y,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer)instanceof h?e:null},create:b,createCube:function(e){function t(e){var i,o={color:null},a=0,s=null;i="rgba";var c="uint8",u=1;if("number"==typeof e?a=0|e:e?("shape"in e?a=e.shape[0]:("radius"in e&&(a=0|e.radius),"width"in e?a=0|e.width:"height"in e&&(a=0|e.height)),("color"in e||"colors"in e)&&(s=e.color||e.colors,Array.isArray(s)),s||("colorCount"in e&&(u=0|e.colorCount),"colorType"in e&&(c=e.colorType),"colorFormat"in e&&(i=e.colorFormat)),"depth"in e&&(o.depth=e.depth),"stencil"in e&&(o.stencil=e.stencil),"depthStencil"in e&&(o.depthStencil=e.depthStencil)):a=1,s)if(Array.isArray(s))for(e=[],i=0;i<s.length;++i)e[i]=s[i];else e=[s];else for(e=Array(u),s={radius:a,format:i,type:c},i=0;i<u;++i)e[i]=r.createCube(s);for(o.color=Array(e.length),i=0;i<e.length;++i)u=e[i],a=a||u.width,o.color[i]={target:34069,data:e[i]};for(i=0;6>i;++i){for(u=0;u<e.length;++u)o.color[u].target=34069+i;0<i&&(o.depth=n[0].depth,o.stencil=n[0].stencil,o.depthStencil=n[0].depthStencil),n[i]?n[i](o):n[i]=b(o)}return F(t,{width:a,height:a,color:e})}var n=Array(6);return t(e),F(t,{faces:n,resize:function(e){var r=0|e;if(r===t.width)return t;var i=t.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;6>e;++e)n[e].resize(r);return t.width=t.height=r,t},_reglType:"framebufferCube",destroy:function(){n.forEach(function(e){e.destroy()})}})},clear:function(){$(E).forEach(v)},restore:function(){$(E).forEach(function(t){t.framebuffer=e.createFramebuffer(),g(t)})}})}function T(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function S(e,t,n,r){function i(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function o(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,i){if(!(a=(i=35632===n?u:f)[r])){var o=t.str(r),a=e.createShader(n);e.shaderSource(a,o),e.compileShader(a),i[r]=a}return a}function s(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function c(n,s){var c,u;c=a(35632,n.fragId),u=a(35633,n.vertId);var f=n.program=e.createProgram();e.attachShader(f,c),e.attachShader(f,u),e.linkProgram(f);var l=e.getProgramParameter(f,35718);r.profile&&(n.stats.uniformsCount=l);var p=n.uniforms;for(c=0;c<l;++c)if(u=e.getActiveUniform(f,c))if(1<u.size)for(var d=0;d<u.size;++d){var h=u.name.replace("[0]","["+d+"]");o(p,new i(h,t.id(h),e.getUniformLocation(f,h),u))}else o(p,new i(u.name,t.id(u.name),e.getUniformLocation(f,u.name),u));for(l=e.getProgramParameter(f,35721),r.profile&&(n.stats.attributesCount=l),p=n.attributes,c=0;c<l;++c)(u=e.getActiveAttrib(f,c))&&o(p,new i(u.name,t.id(u.name),e.getAttribLocation(f,u.name),u))}var u={},f={},l={},p=[],d=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return p.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return p.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);$(u).forEach(t),u={},$(f).forEach(t),f={},p.forEach(function(t){e.deleteProgram(t.program)}),p.length=0,l={},n.shaderCount=0},program:function(e,t,r){var i=l[t];i||(i=l[t]={});var o=i[e];return o||(o=new s(t,e),n.shaderCount++,c(o),i[e]=o,p.push(o)),o},restore:function(){u={},f={};for(var e=0;e<p.length;++e)c(p[e])},shader:a,frag:-1,vert:-1}}function A(e,t,n,r,i,o,a){function s(i){var o;o=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var a=0,s=0,c=r.framebufferWidth,u=r.framebufferHeight,f=null;return W(i)?f=i:i&&(a=0|i.x,s=0|i.y,c=0|(i.width||r.framebufferWidth-a),u=0|(i.height||r.framebufferHeight-s),f=i.data||null),n(),i=c*u*4,f||(5121===o?f=new Uint8Array(i):5126===o&&(f=f||new Float32Array(i))),e.pixelStorei(3333,4),e.readPixels(a,s,c,u,6408,o,f),f}return function(e){return e&&"framebuffer"in e?function(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=s(e)}),n}(e):s(e)}}function P(e){return Array.prototype.slice.call(e)}function O(e){return P(e).join("")}function j(){function e(){var e=[],t=[];return F(function(){e.push.apply(e,P(arguments))},{def:function(){var r="v"+n++;return t.push(r),0<arguments.length&&(e.push(r,"="),e.push.apply(e,P(arguments)),e.push(";")),r},toString:function(){return O([0<t.length?"var "+t+";":"",O(e)])}})}function t(){function t(e,t){r(e,t,"=",n.def(e,t),";")}var n=e(),r=e(),i=n.toString,o=r.toString;return F(function(){n.apply(n,P(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,i){t(e,r),n(e,r,"=",i,";")},toString:function(){return i()+o()}})}var n=0,r=[],i=[],o=e(),a={};return{global:o,link:function(e){for(var t=0;t<i.length;++t)if(i[t]===e)return r[t];return t="g"+n++,r.push(t),i.push(e),t},block:e,proc:function(e,n){function r(){var e="a"+i.length;return i.push(e),e}var i=[];n=n||0;for(var o=0;o<n;++o)r();var s=(o=t()).toString;return a[e]=F(o,{arg:r,toString:function(){return O(["function(",i.join(),"){",s(),"}"])}})},scope:t,cond:function(){var e=O(arguments),n=t(),r=t(),i=n.toString,o=r.toString;return F(n,{then:function(){return n.apply(n,P(arguments)),this},else:function(){return r.apply(r,P(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),O(["if(",e,"){",i(),"}",t])}})},compile:function(){var e=['"use strict";',o,"return {"];Object.keys(a).forEach(function(t){e.push('"',t,'":',a[t].toString(),",")}),e.push("}");var t=O(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,i)}}}function D(e){return Array.isArray(e)||W(e)||c(e)}function R(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function B(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function M(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function L(e){return new B(!1,!1,!1,e)}function z(e,t){var n=e.type;return 0===n?new B(!0,1<=(n=e.data.length),2<=n,t):4===n?new B((n=e.data).thisDep,n.contextDep,n.propDep,t):new B(3===n,2===n,1===n,t)}function I(e,t,n,r,i,a,s,c,u,f,l,p,d,h,m){function g(e){return e.replace(".","_")}function b(e,t,n){var r=g(e);re.push(e),te[r]=ee[r]=!!n,ie[r]=t}function y(e,t,n){var r=g(e);re.push(e),Array.isArray(n)?(ee[r]=n.slice(),te[r]=n.slice()):ee[r]=te[r]=n,oe[r]=t}function w(){var e=j(),n=e.link,r=e.global;e.id=ce++,e.batchId="0";var i=n(ae),o=e.shared={props:"a0"};Object.keys(ae).forEach(function(e){o[e]=r.def(i,".",e)});var a=e.next={},s=e.current={};Object.keys(oe).forEach(function(e){Array.isArray(ee[e])&&(a[e]=r.def(o.next,".",e),s[e]=r.def(o.current,".",e))});var c=e.constants={};Object.keys(se).forEach(function(e){c[e]=r.def(JSON.stringify(se[e]))}),e.invoke=function(t,r){switch(r.type){case 0:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case 1:return t.def(o.props,r.data);case 2:return t.def(o.context,r.data);case 3:return t.def("this",r.data);case 4:return r.data.append(e,t),r.data.ref}},e.attribCache={};var u={};return e.scopeAttrib=function(e){if((e=t.id(e))in u)return u[e];var r=f.scope[e];return r||(r=f.scope[e]=new X),u[e]=n(r)},e}function x(e,t){var n=e.static,r=e.dynamic;if("framebuffer"in n){var i=n.framebuffer;return i?(i=c.getFramebuffer(i),L(function(e,t){var n=e.link(i),r=e.shared;return t.set(r.framebuffer,".next",n),r=r.context,t.set(r,".framebufferWidth",n+".width"),t.set(r,".framebufferHeight",n+".height"),n})):L(function(e,t){var n=e.shared;return t.set(n.framebuffer,".next","null"),n=n.context,t.set(n,".framebufferWidth",n+".drawingBufferWidth"),t.set(n,".framebufferHeight",n+".drawingBufferHeight"),"null"})}if("framebuffer"in r){var o=r.framebuffer;return z(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer;n=t.def(i,".getFramebuffer(",n,")");return t.set(i,".next",n),r=r.context,t.set(r,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),t.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n})}return null}function _(e){function n(e){if(e in r){var n=t.id(r[e]);return(e=L(function(){return n})).id=n,e}if(e in i){var o=i[e];return z(o,function(e,t){var n=e.invoke(t,o);return t.def(e.shared.strings,".id(",n,")")})}return null}var r=e.static,i=e.dynamic,o=n("frag"),a=n("vert"),s=null;return M(o)&&M(a)?(s=l.program(a.id,o.id),e=L(function(e,t){return e.link(s)})):e=new B(o&&o.thisDep||a&&a.thisDep,o&&o.contextDep||a&&a.contextDep,o&&o.propDep||a&&a.propDep,function(e,t){var n,r,i=e.shared.shader;return n=o?o.append(e,t):t.def(i,".","frag"),r=a?a.append(e,t):t.def(i,".","vert"),t.def(i+".program("+r+","+n+")")}),{frag:o,vert:a,progVar:e,program:s}}function C(e,t){function n(e,t){if(e in r){var n=0|r[e];return L(function(e,r){return t&&(e.OFFSET=n),n})}if(e in i){var a=i[e];return z(a,function(e,n){var r=e.invoke(n,a);return t&&(e.OFFSET=r),r})}return t&&o?L(function(e,t){return e.OFFSET="0",0}):null}var r=e.static,i=e.dynamic,o=function(){if("elements"in r){var e=r.elements;D(e)?e=a.getElements(a.create(e,!0)):e&&(e=a.getElements(e));var t=L(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r}return t.ELEMENTS=null});return t.value=e,t}if("elements"in i){var n=i.elements;return z(n,function(e,t){var r=(i=e.shared).isBufferArgs,i=i.elements,o=e.invoke(t,n),a=t.def("null");r=t.def(r,"(",o,")"),o=e.cond(r).then(a,"=",i,".createStream(",o,");").else(a,"=",i,".getElements(",o,");");return t.entry(o),t.exit(e.cond(r).then(i,".destroyStream(",a,");")),e.ELEMENTS=a})}return null}(),s=n("offset",!0);return{elements:o,primitive:function(){if("primitive"in r){var e=r.primitive;return L(function(t,n){return ne[e]})}if("primitive"in i){var t=i.primitive;return z(t,function(e,n){var r=e.constants.primTypes,i=e.invoke(n,t);return n.def(r,"[",i,"]")})}return o?M(o)?o.value?L(function(e,t){return t.def(e.ELEMENTS,".primType")}):L(function(){return 4}):new B(o.thisDep,o.contextDep,o.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)}):null}(),count:function(){if("count"in r){var e=0|r.count;return L(function(){return e})}if("count"in i){var t=i.count;return z(t,function(e,n){return e.invoke(n,t)})}return o?M(o)?o?s?new B(s.thisDep,s.contextDep,s.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):L(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):L(function(){return-1}):new B(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}):null}(),instances:n("instances",!1),offset:s}}function E(e,n){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach(function(e){var n=r[e],o=t.id(e),s=new X;if(D(n))s.state=1,s.buffer=i.getBuffer(i.create(n,34962,!1,!0)),s.type=0;else if(u=i.getBuffer(n))s.state=1,s.buffer=u,s.type=0;else if("constant"in n){var c=n.constant;s.buffer="null",s.state=2,"number"==typeof c?s.x=c:we.forEach(function(e,t){t<c.length&&(s[e]=c[t])})}else{var u=D(n.buffer)?i.getBuffer(i.create(n.buffer,34962,!1,!0)):i.getBuffer(n.buffer),f=0|n.offset,l=0|n.stride,p=0|n.size,d=!!n.normalized,h=0;"type"in n&&(h=J[n.type]),n=0|n.divisor,s.buffer=u,s.state=1,s.size=p,s.normalized=d,s.type=h||u.dtype,s.offset=f,s.stride=l,s.divisor=n}a[e]=L(function(e,t){var n=e.attribCache;if(o in n)return n[o];var r={isStream:!1};return Object.keys(s).forEach(function(e){r[e]=s[e]}),s.buffer&&(r.buffer=e.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[o]=r})}),Object.keys(o).forEach(function(e){var t=o[e];a[e]=z(t,function(e,n){function r(e){n(c[e],"=",i,".",e,"|0;")}var i=e.invoke(n,t),o=e.shared,a=o.isBufferArgs,s=o.buffer,c={isStream:n.def(!1)},u=new X;u.state=1,Object.keys(u).forEach(function(e){c[e]=n.def(""+u[e])});var f=c.buffer,l=c.type;return n("if(",a,"(",i,")){",c.isStream,"=true;",f,"=",s,".createStream(",34962,",",i,");",l,"=",f,".dtype;","}else{",f,"=",s,".getBuffer(",i,");","if(",f,"){",l,"=",f,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",2,";","if(typeof "+i+'.constant === "number"){',c[we[0]],"=",i,".constant;",we.slice(1).map(function(e){return c[e]}).join("="),"=0;","}else{",we.map(function(e,t){return c[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",a,"(",i,".buffer)){",f,"=",s,".createStream(",34962,",",i,".buffer);","}else{",f,"=",s,".getBuffer(",i,".buffer);","}",l,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",f,".dtype;",c.normalized,"=!!",i,".normalized;"),r("size"),r("offset"),r("stride"),r("divisor"),n("}}"),n.exit("if(",c.isStream,"){",s,".destroyStream(",f,");","}"),c})}),a}function k(e,t,n,r,i){var a=x(e),s=function(e,t,n){function r(e){if(e in i){var n=i[e];e=!0;var r,a,s=0|n.x,c=0|n.y;return"width"in n?r=0|n.width:e=!1,"height"in n?a=0|n.height:e=!1,new B(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,function(e,t){var i=e.shared.context,o=r;"width"in n||(o=t.def(i,".","framebufferWidth","-",s));var u=a;return"height"in n||(u=t.def(i,".","framebufferHeight","-",c)),[s,c,o,u]})}if(e in o){var u=o[e];return e=z(u,function(e,t){var n=e.invoke(t,u),r=e.shared.context,i=t.def(n,".x|0"),o=t.def(n,".y|0");return[i,o,t.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",i,")"),n=t.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",o,")")]}),t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep),e}return t?new B(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".","framebufferWidth"),t.def(n,".","framebufferHeight")]}):null}var i=e.static,o=e.dynamic;if(e=r("viewport")){var a=e;e=new B(e.thisDep,e.contextDep,e.propDep,function(e,t){var n=a.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",n[2]),t.set(r,".viewportHeight",n[3]),n})}return{viewport:e,scissor_box:r("scissor.box")}}(e,a),c=C(e),u=function(e,t){var n=e.static,r=e.dynamic,i={};return re.forEach(function(e){function t(t,o){if(e in n){var s=t(n[e]);i[a]=L(function(){return s})}else if(e in r){var c=r[e];i[a]=z(c,function(e,t){return o(e,t,e.invoke(t,c))})}}var a=g(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t(function(e){return e},function(e,t,n){return n});case"depth.func":return t(function(e){return Ce[e]},function(e,t,n){return t.def(e.constants.compareFuncs,"[",n,"]")});case"depth.range":return t(function(e){return e},function(e,t,n){return[t.def("+",n,"[0]"),t=t.def("+",n,"[1]")]});case"blend.func":return t(function(e){return[_e["srcRGB"in e?e.srcRGB:e.src],_e["dstRGB"in e?e.dstRGB:e.dst],_e["srcAlpha"in e?e.srcAlpha:e.src],_e["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,t,n){function r(e,r){return t.def('"',e,r,'" in ',n,"?",n,".",e,r,":",n,".",e)}e=e.constants.blendFuncs;var i=r("src","RGB"),o=r("dst","RGB"),a=(i=t.def(e,"[",i,"]"),t.def(e,"[",r("src","Alpha"),"]"));return[i,o=t.def(e,"[",o,"]"),a,e=t.def(e,"[",r("dst","Alpha"),"]")]});case"blend.equation":return t(function(e){return"string"==typeof e?[Q[e],Q[e]]:"object"==typeof e?[Q[e.rgb],Q[e.alpha]]:void 0},function(e,t,n){var r=e.constants.blendEquations,i=t.def(),o=t.def();return(e=e.cond("typeof ",n,'==="string"')).then(i,"=",o,"=",r,"[",n,"];"),e.else(i,"=",r,"[",n,".rgb];",o,"=",r,"[",n,".alpha];"),t(e),[i,o]});case"blend.color":return t(function(e){return o(4,function(t){return+e[t]})},function(e,t,n){return o(4,function(e){return t.def("+",n,"[",e,"]")})});case"stencil.mask":return t(function(e){return 0|e},function(e,t,n){return t.def(n,"|0")});case"stencil.func":return t(function(e){return[Ce[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,n){return[e=t.def('"cmp" in ',n,"?",e.constants.compareFuncs,"[",n,".cmp]",":",7680),t.def(n,".ref|0"),t=t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return t(function(t){return["stencil.opBack"===e?1029:1028,Ee[t.fail||"keep"],Ee[t.zfail||"keep"],Ee[t.zpass||"keep"]]},function(t,n,r){function i(e){return n.def('"',e,'" in ',r,"?",o,"[",r,".",e,"]:",7680)}var o=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,i("fail"),i("zfail"),i("zpass")]});case"polygonOffset.offset":return t(function(e){return[0|e.factor,0|e.units]},function(e,t,n){return[t.def(n,".factor|0"),t=t.def(n,".units|0")]});case"cull.face":return t(function(e){var t=0;return"front"===e?t=1028:"back"===e&&(t=1029),t},function(e,t,n){return t.def(n,'==="front"?',1028,":",1029)});case"lineWidth":return t(function(e){return e},function(e,t,n){return n});case"frontFace":return t(function(e){return ke[e]},function(e,t,n){return t.def(n+'==="cw"?2304:2305')});case"colorMask":return t(function(e){return e.map(function(e){return!!e})},function(e,t,n){return o(4,function(e){return"!!"+n+"["+e+"]"})});case"sample.coverage":return t(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,n){return[t.def('"value" in ',n,"?+",n,".value:1"),t=t.def("!!",n,".invert")]})}}),i}(e),f=_(e),l=s.viewport;return l&&(u.viewport=l),(s=s[l=g("scissor.box")])&&(u[l]=s),(a={framebuffer:a,draw:c,shader:f,state:u,dirty:s=0<Object.keys(u).length}).profile=function(e){var t,n=e.static;if(e=e.dynamic,"profile"in n){var r=!!n.profile;(t=L(function(e,t){return r})).enable=r}else if("profile"in e){var i=e.profile;t=z(i,function(e,t){return e.invoke(t,i)})}return t}(e),a.uniforms=function(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var t,r=n[e];if("number"==typeof r||"boolean"==typeof r)t=L(function(){return r});else if("function"==typeof r){var a=r._reglType;"texture2d"===a||"textureCube"===a?t=L(function(e){return e.link(r)}):"framebuffer"!==a&&"framebufferCube"!==a||(t=L(function(e){return e.link(r.color[0])}))}else v(r)&&(t=L(function(e){return e.global.def("[",o(r.length,function(e){return r[e]}),"]")}));t.value=r,i[e]=t}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=z(t,function(e,n){return e.invoke(n,t)})}),i}(n),a.attributes=E(t),a.context=function(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=L(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=z(t,function(e,n){return e.invoke(n,t)})}),r}(r),a}function T(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach(function(o){t.save(r,"."+o),i(r,".",o,"=",n[o].append(e,t),";")}),t(i)}function S(e,t,n,r){var i,o=(s=e.shared).gl,a=s.framebuffer;K&&(i=t.def(s.extensions,".webgl_draw_buffers"));var s=(c=e.constants).drawBuffer,c=c.backBuffer;e=n?n.append(e,t):t.def(a,".next"),r||t("if(",e,"!==",a,".cur){"),t("if(",e,"){",o,".bindFramebuffer(",36160,",",e,".framebuffer);"),K&&t(i,".drawBuffersWEBGL(",s,"[",e,".colorAttachments.length]);"),t("}else{",o,".bindFramebuffer(",36160,",null);"),K&&t(i,".drawBuffersWEBGL(",c,");"),t("}",a,".cur=",e,";"),r||t("}")}function A(e,t,n){var r=e.shared,i=r.gl,a=e.current,s=e.next,c=r.current,u=r.next,f=e.cond(c,".dirty");re.forEach(function(t){var r,l;if(!((t=g(t))in n.state))if(t in s){r=s[t],l=a[t];var p=o(ee[t].length,function(e){return f.def(r,"[",e,"]")});f(e.cond(p.map(function(e,t){return e+"!=="+l+"["+t+"]"}).join("||")).then(i,".",oe[t],"(",p,");",p.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";"))}else r=f.def(u,".",t),p=e.cond(r,"!==",c,".",t),f(p),t in ie?p(e.cond(r).then(i,".enable(",ie[t],");").else(i,".disable(",ie[t],");"),c,".",t,"=",r,";"):p(i,".",oe[t],"(",r,");",c,".",t,"=",r,";")}),0===Object.keys(n.state).length&&f(c,".dirty=false;"),t(f)}function P(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;R(Object.keys(n)).forEach(function(i){var c=n[i];if(!r||r(c)){var u=c.append(e,t);if(ie[i]){var f=ie[i];M(c)?t(s,u?".enable(":".disable(",f,");"):t(e.cond(u).then(s,".enable(",f,");").else(s,".disable(",f,");")),t(a,".",i,"=",u,";")}else if(v(u)){var l=o[i];t(s,".",oe[i],"(",u,");",u.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";")}else t(s,".",oe[i],"(",u,");",a,".",i,"=",u,";")}})}function O(e,t){Z&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function I(e,t,n,r,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){e(u=t.def(),"=",o(),";"),"string"==typeof i?e(p,".count+=",i,";"):e(p,".count++;"),h&&(r?e(f=t.def(),"=",m,".getNumPendingQueries();"):e(m,".beginQuery(",p,");"))}function s(e){e(p,".cpuTime+=",o(),"-",u,";"),h&&(r?e(m,".pushScopeStats(",f,",",m,".getNumPendingQueries(),",p,");"):e(m,".endQuery();"))}function c(e){var n=t.def(d,".profile");t(d,".profile=",e,";"),t.exit(d,".profile=",n,";")}var u,f,l=e.shared,p=e.stats,d=l.current,m=l.timer;if(n=n.profile){if(M(n))return void(n.enable?(a(t),s(t.exit),c("true")):c("false"));c(n=n.append(e,t))}else n=t.def(d,".profile");a(l=e.block()),t("if(",n,"){",l,"}"),s(e=e.block()),t.exit("if(",n,"){",e,"}")}function U(e,t,n,r,i){function o(n,r,i){function o(){t("if(!",f,".buffer){",c,".enableVertexAttribArray(",u,");}");var n,o=i.type;n=i.size?t.def(i.size,"||",r):r,t("if(",f,".type!==",o,"||",f,".size!==",n,"||",d.map(function(e){return f+"."+e+"!=="+i[e]}).join("||"),"){",c,".bindBuffer(",34962,",",l,".buffer);",c,".vertexAttribPointer(",[u,n,o,i.normalized,i.stride,i.offset],");",f,".type=",o,";",f,".size=",n,";",d.map(function(e){return f+"."+e+"="+i[e]+";"}).join(""),"}"),Z&&(o=i.divisor,t("if(",f,".divisor!==",o,"){",e.instancing,".vertexAttribDivisorANGLE(",[u,o],");",f,".divisor=",o,";}"))}function s(){t("if(",f,".buffer){",c,".disableVertexAttribArray(",u,");","}if(",we.map(function(e,t){return f+"."+e+"!=="+p[t]}).join("||"),"){",c,".vertexAttrib4f(",u,",",p,");",we.map(function(e,t){return f+"."+e+"="+p[t]+";"}).join(""),"}")}var c=a.gl,u=t.def(n,".location"),f=t.def(a.attributes,"[",u,"]");n=i.state;var l=i.buffer,p=[i.x,i.y,i.z,i.w],d=["buffer","normalized","offset","stride"];1===n?o():2===n?s():(t("if(",n,"===",1,"){"),o(),t("}else{"),s(),t("}"))}var a=e.shared;r.forEach(function(r){var a,s=r.name,c=n.attributes[s];if(c){if(!i(c))return;a=c.append(e,t)}else{if(!i(Te))return;var u=e.scopeAttrib(s);a={},Object.keys(new X).forEach(function(e){a[e]=t.def(u,".",e)})}o(e.link(r),function(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(r.info.type),a)})}function F(e,n,r,i,a){for(var s,c=e.shared,u=c.gl,f=0;f<i.length;++f){var l,p=(m=i[f]).name,d=m.info.type,h=r.uniforms[p],m=e.link(m)+".location";if(h){if(!a(h))continue;if(M(h)){if(p=h.value,35678===d||35680===d)n(u,".uniform1i(",m,",",(d=e.link(p._texture||p.color[0]._texture))+".bind());"),n.exit(d,".unbind();");else if(35674===d||35675===d||35676===d)p=e.global.def("new Float32Array(["+Array.prototype.slice.call(p)+"])"),h=2,35675===d?h=3:35676===d&&(h=4),n(u,".uniformMatrix",h,"fv(",m,",false,",p,");");else{switch(d){case 5126:s="1f";break;case 35664:s="2f";break;case 35665:s="3f";break;case 35666:s="4f";break;case 35670:case 5124:s="1i";break;case 35671:case 35667:s="2i";break;case 35672:case 35668:s="3i";break;case 35673:s="4i";break;case 35669:s="4i"}n(u,".uniform",s,"(",m,",",v(p)?Array.prototype.slice.call(p):p,");")}continue}l=h.append(e,n)}else{if(!a(Te))continue;l=n.def(c.uniforms,"[",t.id(p),"]")}switch(35678===d?n("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}"):35680===d&&n("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}"),p=1,d){case 35678:case 35680:n(u,".uniform1i(",m,",",d=n.def(l,"._texture"),".bind());"),n.exit(d,".unbind();");continue;case 5124:case 35670:s="1i";break;case 35667:case 35671:s="2i",p=2;break;case 35668:case 35672:s="3i",p=3;break;case 35669:case 35673:s="4i",p=4;break;case 5126:s="1f";break;case 35664:s="2f",p=2;break;case 35665:s="3f",p=3;break;case 35666:s="4f",p=4;break;case 35674:s="Matrix2fv";break;case 35675:s="Matrix3fv";break;case 35676:s="Matrix4fv"}if(n(u,".uniform",s,"(",m,","),"M"===s.charAt(0)){m=Math.pow(d-35674+2,2);var g=e.global.def("new Float32Array(",m,")");n("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",o(m,function(e){return g+"["+e+"]="+l+"["+e+"]"}),",",g,")")}else n(1<p?o(p,function(e){return l+"["+e+"]"}):l);n(");")}}function N(e,t,n,r){function i(i){var o=p[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(l,".",i)}function o(){function e(){n(c,".drawElementsInstancedANGLE(",[h,v,g,m+"<<(("+g+"-5121)>>1)",s],");")}function t(){n(c,".drawArraysInstancedANGLE(",[h,m,v,s],");")}d?b?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}function a(){function e(){n(f+".drawElements("+[h,v,g,m+"<<(("+g+"-5121)>>1)"]+");")}function t(){n(f+".drawArrays("+[h,m,v]+");")}d?b?e():(n("if(",d,"){"),e(),n("}else{"),t(),n("}")):t()}var s,c,u=e.shared,f=u.gl,l=u.draw,p=r.draw,d=function(){var i=p.elements,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(l,".","elements"),i&&o("if("+i+")"+f+".bindBuffer(34963,"+i+".buffer.buffer);"),i}(),h=i("primitive"),m=i("offset"),v=function(){var i=p.count,o=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(o=n),i=i.append(e,o)):i=o.def(l,".","count"),i}();if("number"==typeof v){if(0===v)return}else n("if(",v,"){"),n.exit("}");Z&&(s=i("instances"),c=e.instancing);var g=d+".type",b=p.elements&&M(p.elements);Z&&("number"!=typeof s||0<=s)?"string"==typeof s?(n("if(",s,">0){"),o(),n("}else if(",s,"<0){"),a(),n("}")):o():a()}function V(e,t,n,r,i){return i=(t=w()).proc("body",i),Z&&(t.instancing=i.def(t.shared.extensions,".angle_instanced_arrays")),e(t,i,n,r),t.compile().body}function G(e,t,n,r){O(e,t),U(e,t,n,r.attributes,function(){return!0}),F(e,t,n,r.uniforms,function(){return!0}),N(e,t,t,n)}function Y(e,t,n,r){function i(){return!0}e.batchId="a1",O(e,t),U(e,t,n,r.attributes,i),F(e,t,n,r.uniforms,i),N(e,t,t,n)}function q(e,t,n,r){function i(e){return e.contextDep&&a||e.propDep}function o(e){return!i(e)}O(e,t);var a=n.contextDep,s=t.def(),c=t.def();e.shared.props=c,e.batchId=s;var u=e.scope(),f=e.scope();t(u.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",c,"=","a0","[",s,"];",f,"}",u.exit),n.needsContext&&T(e,f,n.context),n.needsFramebuffer&&S(e,f,n.framebuffer),P(e,f,n.state,i),n.profile&&i(n.profile)&&I(e,f,n,!1,!0),r?(U(e,u,n,r.attributes,o),U(e,f,n,r.attributes,i),F(e,u,n,r.uniforms,o),F(e,f,n,r.uniforms,i),N(e,u,f,n)):(t=e.global.def("{}"),r=n.shader.progVar.append(e,f),c=f.def(r,".id"),u=f.def(t,"[",c,"]"),f(e.shared.gl,".useProgram(",r,".program);","if(!",u,"){",u,"=",t,"[",c,"]=",e.link(function(t){return V(Y,e,n,t,2)}),"(",r,");}",u,".call(this,a0[",s,"],",s,");"))}function W(e,n){function r(t){var r=n.shader[t];r&&i.set(o.shader,"."+t,r.append(e,i))}var i=e.proc("scope",3);e.batchId="a2";var o=e.shared,a=o.current;T(e,i,n.context),n.framebuffer&&n.framebuffer.append(e,i),R(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,i);v(r)?r.forEach(function(n,r){i.set(e.next[t],"["+r+"]",n)}):i.set(o.next,"."+t,r)}),I(e,i,n,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(t){var r=n.draw[t];r&&i.set(o.draw,"."+t,""+r.append(e,i))}),Object.keys(n.uniforms).forEach(function(r){i.set(o.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,i))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,i),o=e.scopeAttrib(t);Object.keys(new X).forEach(function(e){i.set(o,"."+e,r[e])})}),r("vert"),r("frag"),0<Object.keys(n.state).length&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",e.shared.context,",a0,",e.batchId,");")}function $(e,t,n){var r=t.static[n];if(r&&function(e){if("object"==typeof e&&!v(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(H.isDynamic(e[t[n]]))return!0;return!1}}(r)){var i=e.global,o=Object.keys(r),a=!1,s=!1,c=!1,u=e.global.def("{}");o.forEach(function(t){var n=r[t];if(H.isDynamic(n))"function"==typeof n&&(n=r[t]=H.unbox(n)),t=z(n,null),a=a||t.thisDep,c=c||t.propDep,s=s||t.contextDep;else{switch(i(u,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}}),t.dynamic[n]=new H.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:c,ref:u,append:function(e,t){o.forEach(function(n){var i=r[n];H.isDynamic(i)&&(i=e.invoke(t,i),t(u,".",n,"=",i,";"))})}}),delete t.static[n]}}var X=f.Record,Q={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(Q.min=32775,Q.max=32776);var Z=n.angle_instanced_arrays,K=n.webgl_draw_buffers,ee={dirty:!0,profile:m.profile},te={},re=[],ie={},oe={};b("dither",3024),b("blend.enable",3042),y("blend.color","blendColor",[0,0,0,0]),y("blend.equation","blendEquationSeparate",[32774,32774]),y("blend.func","blendFuncSeparate",[1,0,1,0]),b("depth.enable",2929,!0),y("depth.func","depthFunc",513),y("depth.range","depthRange",[0,1]),y("depth.mask","depthMask",!0),y("colorMask","colorMask",[!0,!0,!0,!0]),b("cull.enable",2884),y("cull.face","cullFace",1029),y("frontFace","frontFace",2305),y("lineWidth","lineWidth",1),b("polygonOffset.enable",32823),y("polygonOffset.offset","polygonOffset",[0,0]),b("sample.alpha",32926),b("sample.enable",32928),y("sample.coverage","sampleCoverage",[1,!1]),b("stencil.enable",2960),y("stencil.mask","stencilMask",-1),y("stencil.func","stencilFunc",[519,0,-1]),y("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),y("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),b("scissor.enable",3089),y("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),y("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var ae={gl:e,context:d,strings:t,next:te,current:ee,draw:p,elements:a,buffer:i,shader:l,attributes:f.state,uniforms:u,framebuffer:c,extensions:n,timer:h,isBufferArgs:D},se={primTypes:ne,compareFuncs:Ce,blendFuncs:_e,blendEquations:Q,stencilOps:Ee,glTypes:J,orientationType:ke};K&&(se.backBuffer=[1029],se.drawBuffer=o(r.maxDrawbuffers,function(e){return 0===e?[0]:o(e,function(e){return 36064+e})}));var ce=0;return{next:te,current:ee,procs:function(){var e=w(),t=e.proc("poll"),n=e.proc("refresh"),i=e.block();t(i),n(i);var a,s=e.shared,c=s.gl,u=s.next,f=s.current;i(f,".dirty=false;"),S(e,t),S(e,n,null,!0),Z&&(a=e.link(Z));for(var l=0;l<r.maxAttributes;++l){var p=n.def(s.attributes,"[",l,"]"),d=e.cond(p,".buffer");d.then(c,".enableVertexAttribArray(",l,");",c,".bindBuffer(",34962,",",p,".buffer.buffer);",c,".vertexAttribPointer(",l,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(c,".disableVertexAttribArray(",l,");",c,".vertexAttrib4f(",l,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),n(d),Z&&n(a,".vertexAttribDivisorANGLE(",l,",",p,".divisor);")}return Object.keys(ie).forEach(function(r){var o=ie[r],a=i.def(u,".",r),s=e.block();s("if(",a,"){",c,".enable(",o,")}else{",c,".disable(",o,")}",f,".",r,"=",a,";"),n(s),t("if(",a,"!==",f,".",r,"){",s,"}")}),Object.keys(oe).forEach(function(r){var a,s,l=oe[r],p=ee[r],d=e.block();d(c,".",l,"("),v(p)?(l=p.length,a=e.global.def(u,".",r),s=e.global.def(f,".",r),d(o(l,function(e){return a+"["+e+"]"}),");",o(l,function(e){return s+"["+e+"]="+a+"["+e+"];"}).join("")),t("if(",o(l,function(e){return a+"["+e+"]!=="+s+"["+e+"]"}).join("||"),"){",d,"}")):(a=i.def(u,".",r),s=i.def(f,".",r),d(a,");",f,".",r,"=",a,";"),t("if(",a,"!==",s,"){",d,"}")),n(d)}),e.compile()}(),compile:function(e,t,n,r,i){var o=w();return o.stats=o.link(i),Object.keys(t.static).forEach(function(e){$(o,t,e)}),xe.forEach(function(t){$(o,e,t)}),n=k(e,t,n,r),function(e,t){var n=e.proc("draw",1);O(e,n),T(e,n,t.context),S(e,n,t.framebuffer),A(e,n,t),P(e,n,t.state),I(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)G(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return V(G,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}0<Object.keys(t.state).length&&n(e.shared.current,".dirty=true;")}(o,n),W(o,n),function(e,t){function n(e){return e.contextDep&&i||e.propDep}var r=e.proc("batch",2);e.batchId="0",O(e,r);var i=!1,o=!0;Object.keys(t.context).forEach(function(e){i=i||t.context[e].propDep}),i||(T(e,r,t.context),o=!1);var a=!1;if((s=t.framebuffer)?(s.propDep?i=a=!0:s.contextDep&&i&&(a=!0),a||S(e,r,s)):S(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(i=!0),A(e,r,t),P(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||I(e,r,t,!1,"a1"),t.contextDep=i,t.needsContext=o,t.needsFramebuffer=a,(o=t.shader.progVar).contextDep&&i||o.propDep)q(e,r,t,null);else if(o=o.append(e,r),r(e.shared.gl,".useProgram(",o,".program);"),t.shader.program)q(e,r,t,t.shader.program);else{var s=e.global.def("{}"),c=(a=r.def(o,".id"),r.def(s,"[",a,"]"));r(e.cond(c).then(c,".call(this,a0,a1);").else(c,"=",s,"[",a,"]=",e.link(function(n){return V(q,e,t,n,2)}),"(",o,");",c,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;")}(o,n),o.compile()}}}function U(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var F=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},N=0,H={DynamicVariable:e,define:function(n,r){return new e(n,t(r+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t,n){return"function"==typeof t?new e(0,t):t},accessor:t},V={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},G="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Y=s();Y.zero=s();var q=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063));var o=!!t.oes_texture_float;if(o){o=e.createTexture(),e.bindTexture(3553,o),e.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var a=e.createFramebuffer();if(e.bindFramebuffer(36160,a),e.framebufferTexture2D(36160,36064,3553,o,0),e.bindTexture(3553,null),36053!==e.checkFramebufferStatus(36160))o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var s=Y.allocType(5126,4);e.readPixels(0,0,1,1,6408,5126,s),e.getError()?o=!1:(e.deleteFramebuffer(a),e.deleteTexture(o),o=1===s[0]),Y.freeType(s)}}return s=!0,s=e.createTexture(),a=Y.allocType(5121,36),e.activeTexture(33984),e.bindTexture(34067,s),e.texImage2D(34069,0,6408,3,3,0,6408,5121,a),Y.freeType(a),e.bindTexture(34067,null),e.deleteTexture(s),s=!e.getError(),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:o,npotTextureCube:s}},W=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},$=function(e){return Object.keys(e).map(function(t){return e[t]})},X={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;switch(n=r||Y.allocType(n,i),t.length){case 0:break;case 1:for(r=t[0],t=0;t<r;++t)n[t]=e[t];break;case 2:for(r=t[0],t=t[1],o=i=0;o<r;++o)for(var a=e[o],s=0;s<t;++s)n[i++]=a[s];break;case 3:u(e,t[0],t[1],t[2],n,0);break;default:!function e(t,n,r,i,o){for(var a=1,s=r+1;s<n.length;++s)a*=n[s];var c=n[r];if(4==n.length-r){var f=n[r+1],l=n[r+2];for(n=n[r+3],s=0;s<c;++s)u(t[s],f,l,n,i,o),o+=a}else for(s=0;s<c;++s)e(t[s],n,r+1,i,o),o+=a}(e,t,0,n,0)}return n}},Q={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},J={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Z={dynamic:35048,stream:35040,static:35044},K=X.flatten,ee=X.shape,te=[];te[5120]=1,te[5122]=2,te[5124]=4,te[5121]=1,te[5123]=2,te[5125]=4,te[5126]=4;var ne={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},re=new Float32Array(1),ie=new Uint32Array(re.buffer),oe=[9984,9986,9985,9987],ae=[0,6409,6410,6407,6408],se={};se[6409]=se[6406]=se[6402]=1,se[34041]=se[6410]=2,se[6407]=se[35904]=3,se[6408]=se[35906]=4;var ce=g("HTMLCanvasElement"),ue=g("CanvasRenderingContext2D"),fe=g("ImageBitmap"),le=g("HTMLImageElement"),pe=g("HTMLVideoElement"),de=Object.keys(Q).concat([ce,ue,fe,le,pe]),he=[];he[5121]=1,he[5126]=4,he[36193]=2,he[5123]=2,he[5125]=4;var me=[];me[32854]=2,me[32855]=2,me[36194]=2,me[34041]=4,me[33776]=.5,me[33777]=.5,me[33778]=1,me[33779]=1,me[35986]=.5,me[35987]=1,me[34798]=1,me[35840]=.5,me[35841]=.25,me[35842]=.5,me[35843]=.25,me[36196]=.5;var ve=[];ve[32854]=2,ve[32855]=2,ve[36194]=2,ve[33189]=2,ve[36168]=1,ve[34041]=4,ve[35907]=4,ve[34836]=16,ve[34842]=8,ve[34843]=6;var ge=function(e,t,n,r,i){function o(e){this.id=u++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,i.profile&&(this.stats={size:0})}function a(t){var n=t.renderbuffer;e.bindRenderbuffer(36161,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete f[t.id],r.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907),t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),t.webgl_color_buffer_float&&(s.rgba32f=34836);var c=[];Object.keys(s).forEach(function(e){c[s[e]]=e});var u=0,f={};return o.prototype.decRef=function(){0>=--this.refCount&&a(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(f).forEach(function(t){e+=f[t].stats.size}),e}),{create:function(t,n){function a(t,n){var r=0,o=0,f=32854;if("object"==typeof t&&t?("shape"in t?(r=0|(o=t.shape)[0],o=0|o[1]):("radius"in t&&(r=o=0|t.radius),"width"in t&&(r=0|t.width),"height"in t&&(o=0|t.height)),"format"in t&&(f=s[t.format])):"number"==typeof t?(r=0|t,o="number"==typeof n?0|n:r):t||(r=o=1),r!==u.width||o!==u.height||f!==u.format)return a.width=u.width=r,a.height=u.height=o,u.format=f,e.bindRenderbuffer(36161,u.renderbuffer),e.renderbufferStorage(36161,f,r,o),i.profile&&(u.stats.size=ve[u.format]*u.width*u.height),a.format=c[u.format],a}var u=new o(e.createRenderbuffer());return f[u.id]=u,r.renderbufferCount++,a(t,n),a.resize=function(t,n){var r=0|t,o=0|n||r;return r===u.width&&o===u.height?a:(a.width=u.width=r,a.height=u.height=o,e.bindRenderbuffer(36161,u.renderbuffer),e.renderbufferStorage(36161,u.format,r,o),i.profile&&(u.stats.size=ve[u.format]*u.width*u.height),a)},a._reglType="renderbuffer",a._renderbuffer=u,i.profile&&(a.stats=u.stats),a.destroy=function(){u.decRef()},a},clear:function(){$(f).forEach(a)},restore:function(){$(f).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,t.renderbuffer),e.renderbufferStorage(36161,t.format,t.width,t.height)}),e.bindRenderbuffer(36161,null)}}},be=[];be[6408]=4,be[6407]=3;var ye=[];ye[5121]=1,ye[5126]=4,ye[36193]=2;var we=["x","y","z","w"],xe="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),_e={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ce={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ee={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ke={cw:2304,ccw:2305},Te=new B(!1,!1,!1,function(){});return function(e){function t(){if(0===X.length)_&&_.update(),K=null;else{K=V.next(t),l();for(var e=X.length-1;0<=e;--e){var n=X[e];n&&n(j,null,0)}v.flush(),_&&_.update()}}function n(){!K&&0<X.length&&(K=V.next(t))}function r(){K&&(V.cancel(t),K=null)}function o(e){e.preventDefault(),r(),Q.forEach(function(e){e()})}function a(e){v.getError(),b.restore(),M.restore(),R.restore(),L.restore(),z.restore(),N.restore(),_&&_.restore(),Y.procs.refresh(),n(),J.forEach(function(e){e()})}function s(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var i=e[r];H.isDynamic(i)?n[r]=H.unbox(i,r):t[r]=i}),{dynamic:n,static:t}}var n=t(e.context||{}),r=t(e.uniforms||{}),i=t(e.attributes||{}),o=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=F({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e));e={gpuTime:0,cpuTime:0,count:0};var a=(n=Y.compile(o,i,r,n,e)).draw,s=n.batch,c=n.scope,u=[];return F(function(e,t){var n;if("function"==typeof e)return c.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)c.call(this,null,t,n);else{if(!Array.isArray(e))return c.call(this,e,t,0);for(n=0;n<e.length;++n)c.call(this,e[n],t,n)}else if("number"==typeof e){if(0<e)return s.call(this,function(e){for(;u.length<e;)u.push(null);return u}(0|e),0|e)}else{if(!Array.isArray(e))return a.call(this,e);if(e.length)return s.call(this,e,e.length)}},{stats:e})}function c(e,t){var n=0;Y.procs.poll();var r=t.color;r&&(v.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(v.clearDepth(+t.depth),n|=256),"stencil"in t&&(v.clearStencil(0|t.stencil),n|=1024),v.clear(n)}function u(e){return X.push(e),n(),{cancel:function(){var t=U(X,e);X[t]=function e(){var t=U(X,e);X[t]=X[X.length-1],--X.length,0>=X.length&&r()}}}}function f(){var e=W.viewport,t=W.scissor_box;e[0]=e[1]=t[0]=t[1]=0,j.viewportWidth=j.framebufferWidth=j.drawingBufferWidth=e[2]=t[2]=v.drawingBufferWidth,j.viewportHeight=j.framebufferHeight=j.drawingBufferHeight=e[3]=t[3]=v.drawingBufferHeight}function l(){j.tick+=1,j.time=m(),f(),Y.procs.poll()}function p(){f(),Y.procs.refresh(),_&&_.update()}function m(){return(G()-C)/1e3}if(!(e=i(e)))return null;var v=e.gl,g=v.getContextAttributes();v.isContextLost();var b=function(e,t){function n(t){var n;t=t.toLowerCase();try{n=r[t]=e.getExtension(t)}catch(e){}return!!n}for(var r={},i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!n(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw Error("(regl): error restoring extension "+e)})}}}(v,e);if(!b)return null;var y=function(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}(),w={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},x=b.extensions,_=function(e,t){function n(e,t,n){var r=a.pop()||new function(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null};r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,s.push(r)}var r=t.ext_disjoint_timer_query;if(!r)return null;var i=[],o=[],a=[],s=[],c=[],u=[];return{beginQuery:function(e){var t=i.pop()||r.createQueryEXT();r.beginQueryEXT(35007,t),o.push(t),n(o.length-1,o.length,e)},endQuery:function(){r.endQueryEXT(35007)},pushScopeStats:n,update:function(){var e,t;if(0!==(e=o.length)){u.length=Math.max(u.length,e+1),c.length=Math.max(c.length,e+1),c[0]=0;var n=u[0]=0;for(t=e=0;t<o.length;++t){var f=o[t];r.getQueryObjectEXT(f,34919)?(n+=r.getQueryObjectEXT(f,34918),i.push(f)):o[e++]=f,c[t+1]=n,u[t+1]=e}for(o.length=e,t=e=0;t<s.length;++t){var l=(n=s[t]).startQueryIndex;f=n.endQueryIndex,n.sum+=c[f]-c[l],l=u[l],(f=u[f])===l?(n.stats.gpuTime+=n.sum/1e6,a.push(n)):(n.startQueryIndex=l,n.endQueryIndex=f,s[e++]=n)}s.length=e}},getNumPendingQueries:function(){return o.length},clear:function(){i.push.apply(i,o);for(var e=0;e<i.length;e++)r.deleteQueryEXT(i[e]);o.length=0,i.length=0},restore:function(){o.length=0,i.length=0}}}(0,x),C=G(),P=v.drawingBufferWidth,O=v.drawingBufferHeight,j={tick:0,time:0,viewportWidth:P,viewportHeight:O,framebufferWidth:P,framebufferHeight:O,drawingBufferWidth:P,drawingBufferHeight:O,pixelRatio:e.pixelRatio},D=q(v,x),R=(P=function(e,t,n,r){for(e=n.maxAttributes,t=Array(e),n=0;n<e;++n)t[n]=new T;return{Record:T,scope:{},state:t}}(v,x,D),d(v,w,e,P)),B=h(v,x,R,w),M=S(v,y,w,e),L=E(v,x,D,function(){Y.procs.poll()},j,w,e),z=ge(v,x,0,w,e),N=k(v,x,D,L,z,w),Y=I(v,y,x,D,R,B,0,N,{},P,M,{elements:null,primitive:4,count:-1,offset:0,instances:-1},j,_,e),W=(y=A(v,N,Y.procs.poll,j),Y.next),$=v.canvas,X=[],Q=[],J=[],Z=[e.onDestroy],K=null;$&&($.addEventListener("webglcontextlost",o,!1),$.addEventListener("webglcontextrestored",a,!1));var ee=N.setFBO=s({framebuffer:H.define.call(null,1,"framebuffer")});return p(),g=F(s,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ee(F({framebuffer:e.framebuffer.faces[t]},e),c);else ee(e,c);else c(0,e)},prop:H.define.bind(null,1),context:H.define.bind(null,2),this:H.define.bind(null,3),draw:s({}),buffer:function(e){return R.create(e,34962,!1,!1)},elements:function(e){return B.create(e,!1)},texture:L.create2D,cube:L.createCube,renderbuffer:z.create,framebuffer:N.create,framebufferCube:N.createCube,attributes:g,frame:u,on:function(e,t){var n;switch(e){case"frame":return u(t);case"lost":n=Q;break;case"restore":n=J;break;case"destroy":n=Z}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t){n[e]=n[n.length-1],n.pop();break}}}},limits:D,hasExtension:function(e){return 0<=D.extensions.indexOf(e.toLowerCase())},read:y,destroy:function(){X.length=0,r(),$&&($.removeEventListener("webglcontextlost",o),$.removeEventListener("webglcontextrestored",a)),M.clear(),N.clear(),z.clear(),L.clear(),B.clear(),R.clear(),_&&_.clear(),Z.forEach(function(e){e()})},_gl:v,_refresh:p,poll:function(){l(),_&&_.update()},now:m,stats:w}),e.onDone(null,g),g}},"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):r.createREGL=i()},{}],53:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},r.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{ssrc:t}};n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var f=r.matchPrefix(e,"b=");return f.length&&(0===f[0].indexOf("b=TIAS:")?f=parseInt(f[0].substr(7),10):0===f[0].indexOf("b=AS:")&&(f=parseInt(f[0].substr(5),10)),n.forEach(function(e){e.maxBitrate=f})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.exports=r},{}],54:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],55:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],56:[function(e,t,n){(function(t,r){var i=/%[sdj%]/g;n.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),c=r[n];n<o;c=r[++n])m(c)||!w(c)?a+=" "+c:a+=" "+s(c);return a},n.deprecate=function(e,i){if(b(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var o,a={};function s(e,t){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(t)?r.showHidden=t:t&&n._extend(r,t),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),f(r,e,r.depth)}function c(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function u(e,t){return e}function f(e,t,r){if(e.customInspect&&t&&C(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return g(i)||(i=f(e,i,r)),i}var o=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(v(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,t);if(o)return o;var a=Object.keys(t),s=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),_(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(t);if(0===a.length){if(C(t)){var c=t.name?": "+t.name:"";return e.stylize("[Function"+c+"]","special")}if(y(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(x(t))return e.stylize(Date.prototype.toString.call(t),"date");if(_(t))return l(t)}var u,w="",E=!1,k=["{","}"];(d(t)&&(E=!0,k=["[","]"]),C(t))&&(w=" [Function"+(t.name?": "+t.name:"")+"]");return y(t)&&(w=" "+RegExp.prototype.toString.call(t)),x(t)&&(w=" "+Date.prototype.toUTCString.call(t)),_(t)&&(w=" "+l(t)),0!==a.length||E&&0!=t.length?r<0?y(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=E?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)S(t,String(a))?o.push(p(e,t,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,n,r,i,!0))}),o}(e,t,r,s,a):a.map(function(n){return p(e,t,r,s,n,E)}),e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(u,w,k)):k[0]+w+k[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),S(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(n)?f(e,c.value,null):f(e,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),b(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function d(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return"number"==typeof e}function g(e){return"string"==typeof e}function b(e){return void 0===e}function y(e){return w(e)&&"[object RegExp]"===E(e)}function w(e){return"object"==typeof e&&null!==e}function x(e){return w(e)&&"[object Date]"===E(e)}function _(e){return w(e)&&("[object Error]"===E(e)||e instanceof Error)}function C(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function k(e){return e<10?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(b(o)&&(o=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var r=t.pid;a[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else a[e]=function(){};return a[e]},n.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=h,n.isNull=m,n.isNullOrUndefined=function(e){return null==e},n.isNumber=v,n.isString=g,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=b,n.isRegExp=y,n.isObject=w,n.isDate=x,n.isError=_,n.isFunction=C,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e("./support/isBuffer");var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[k(e.getHours()),k(e.getMinutes()),k(e.getSeconds())].join(":"),[e.getDate(),T[e.getMonth()],t].join(" ")),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":55,_process:51,inherits:54}],57:[function(e,t,n){"use strict";!function(){var n=e("./utils").log,r=e("./utils").browserDetails;t.exports.browserDetails=r,t.exports.extractVersion=e("./utils").extractVersion,t.exports.disableLog=e("./utils").disableLog;var i=e("./chrome/chrome_shim")||null,o=e("./edge/edge_shim")||null,a=e("./firefox/firefox_shim")||null,s=e("./safari/safari_shim")||null;switch(r.browser){case"opera":case"chrome":if(!i||!i.shimPeerConnection)return void n("Chrome shim is not included in this adapter release.");n("adapter.js shimming chrome."),t.exports.browserShim=i,i.shimGetUserMedia(),i.shimMediaStream(),i.shimSourceObject(),i.shimPeerConnection(),i.shimOnTrack();break;case"firefox":if(!a||!a.shimPeerConnection)return void n("Firefox shim is not included in this adapter release.");n("adapter.js shimming firefox."),t.exports.browserShim=a,a.shimGetUserMedia(),a.shimSourceObject(),a.shimPeerConnection(),a.shimOnTrack();break;case"edge":if(!o||!o.shimPeerConnection)return void n("MS edge shim is not included in this adapter release.");n("adapter.js shimming edge."),t.exports.browserShim=o,o.shimGetUserMedia(),o.shimPeerConnection();break;case"safari":if(!s)return void n("Safari shim is not included in this adapter release.");n("adapter.js shimming safari."),t.exports.browserShim=s,s.shimGetUserMedia();break;default:n("Unsupported browser!")}}()},{"./chrome/chrome_shim":58,"./edge/edge_shim":60,"./firefox/firefox_shim":62,"./safari/safari_shim":64,"./utils":65}],58:[function(e,t,n){"use strict";var r=e("../utils.js").log,i=e("../utils.js").browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r=new Event("track");r.track=n.track,r.receiver={track:n.track},r.streams=[e.stream],t.dispatchEvent(r)}),e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):this.src=""}}))},shimPeerConnection:function(){window.RTCPeerConnection=function(e,t){r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var a=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e,t){var n=new Map(Object.keys(e).map(function(t){return[t,e[t]]}));return t=t||e,Object.keys(t).forEach(function(e){n[e]=t[e]}),n};if(arguments.length>=2){return i.apply(this,[function(e){o[1](s(a(e)))},arguments[0]])}return new Promise(function(t,n){1===o.length&&"object"==typeof e?i.apply(r,[function(e){t(s(a(e)))},n]):i.apply(r,[function(e){t(s(a(e),e.result()))},n])}).then(t,n)},n},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),i.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":65,"./getusermedia":59}],59:[function(e,t,n){"use strict";var r=e("../utils.js").log;t.exports=function(){var e=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),(o={})[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if((t=JSON.parse(JSON.stringify(t)))&&t.audio&&(t.audio=e(t.audio)),t&&"object"==typeof t.video){var i=t.video.facingMode;if((i=i&&("object"==typeof i?i:{ideal:i}))&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete t.video.facingMode,"environment"===i.exact||"environment"===i.ideal))return navigator.mediaDevices.enumerateDevices().then(function(o){var a=(o=o.filter(function(e){return"videoinput"===e.kind})).find(function(e){return-1!==e.label.toLowerCase().indexOf("back")})||o.length&&o[o.length-1];return a&&(t.video.deviceId=i.exact?{exact:a.deviceId}:{ideal:a.deviceId}),t.video=e(t.video),r("chrome: "+JSON.stringify(t)),n(t)});t.video=e(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};navigator.getUserMedia=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};var i=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var o=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return o(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return i(e)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":65}],60:[function(e,t,n){"use strict";var r=e("sdp"),i=e("../utils").browserDetails,o={shimPeerConnection:function(){if(window.RTCIceGatherer){window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e});var e=Object.getOwnPropertyDescriptor(MediaStreamTrack.prototype,"enabled");Object.defineProperty(MediaStreamTrack.prototype,"enabled",{set:function(t){e.set.call(this,t);var n=new Event("enabled");n.enabled=t,this.dispatchEvent(n)}})}window.RTCPeerConnection=function(e){var t=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=n[e].bind(n)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}if(this.usingBundle=e&&"max-bundle"===e.bundlePolicy,e&&e.iceServers){var r=JSON.parse(JSON.stringify(e.iceServers));this.iceOptions.iceServers=r.filter(function(e){if(e&&e.urls){var t=e.urls;return"string"==typeof t&&(t=[t]),!!(t=t.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")||0===e.indexOf("stun:")&&i.version>=14393})[0])}return!1})}this._config=e,this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this,t=r.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){if(!n.candidate||0===Object.keys(n.candidate).length)for(var r=1;r<t.length;r++)-1===t[r].indexOf("\r\na=end-of-candidates\r\n")&&(t[r]+="a=end-of-candidates\r\n");else-1===n.candidate.candidate.indexOf("typ endOfCandidates")&&(t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n");(e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),n.candidate||"complete"===e.iceGatheringState)||e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state})&&(e.iceGatheringState="complete")}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.getConfiguration=function(){return this._config},window.RTCPeerConnection.prototype.addStream=function(e){var t=e.clone();e.getTracks().forEach(function(e,n){var r=t.getTracks()[n];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),this.localStreams.push(t),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var r=0;r<t.codecs.length;r++){var i=t.codecs[r];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate){i.numChannels=Math.min(e.numChannels,i.numChannels),n.codecs.push(i),i.rtcpFeedback=i.rtcpFeedback.filter(function(t){for(var n=0;n<e.rtcpFeedback.length;n++)if(e.rtcpFeedback[n].type===t.type&&e.rtcpFeedback[n].parameter===t.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var n=this,i=new RTCIceGatherer(n.iceOptions),o=new RTCIceTransport(i);i.onlocalcandidate=function(a){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var c=a.candidate,u=!c||0===Object.keys(c).length;u?(void 0===i.state&&(i.state="completed"),s.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(c.component="RTCP"===o.component?2:1,s.candidate.candidate=r.writeCandidate(c));var f=r.splitSections(n.localDescription.sdp);-1===s.candidate.candidate.indexOf("typ endOfCandidates")?f[s.candidate.sdpMLineIndex+1]+="a="+s.candidate.candidate+"\r\n":f[s.candidate.sdpMLineIndex+1]+="a=end-of-candidates\r\n",n.localDescription.sdp=f.join("");var l=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":n._localIceCandidatesBuffer.push(s),u&&l&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),n.dispatchEvent(s),null!==n.onicecandidate&&n.onicecandidate(s),l&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete")}},o.onicestatechange=function(){n._updateConnectionState()};var a=new RTCDtlsTransport(o);return a.ondtlsstatechange=function(){n._updateConnectionState()},a.onerror=function(){a.state="failed",n._updateConnectionState()},{iceGatherer:i,iceTransport:o,dtlsTransport:a}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var i=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:r.localCName},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&("video"===e.kind&&e.recvEncodingParameters&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),i.encodings=e.recvEncodingParameters,i.rtcp={cname:e.cname},e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t,n,i=this;if("offer"===e.type)this._pendingOffer&&(t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=r.splitSections(i.remoteDescription.sdp),n=t.shift();var o=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],s=a.iceGatherer,c=a.iceTransport,u=a.dtlsTransport,f=a.localCapabilities,l=a.remoteCapabilities;if(!("0"===e.split("\n",1)[0].split(" ",2)[1])&&!a.isDatachannel){var p=r.getIceParameters(e,n);if(o){var d=r.matchPrefix(e,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});d.length&&c.setRemoteCandidates(d)}var h=r.getDtlsParameters(e,n);o&&(h.role="server"),i.usingBundle&&0!==t||(c.start(s,p,o?"controlling":"controlled"),u.start(h));var m=i._getCommonCapabilities(f,l);i._transceive(a,m.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var a=arguments.length>1&&"function"==typeof arguments[1];if(a){var s=arguments[1];window.setTimeout(function(){s(),"new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),i._emitBufferedCandidates()},0)}var c=Promise.resolve();return c.then(function(){a||("new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),window.setTimeout(i._emitBufferedCandidates.bind(i),500))}),c},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,n=new MediaStream,i=[],o=r.splitSections(e.sdp),a=o.shift(),s=r.matchPrefix(a,"a=ice-lite").length>0;switch(this.usingBundle=r.matchPrefix(a,"a=group:BUNDLE ").length>0,o.forEach(function(o,c){var u=r.splitLines(o)[0].substr(2).split(" "),f=u[0],l="0"===u[1],p=r.getDirection(o,a),d=r.matchPrefix(o,"a=mid:");if(d=d.length?d[0].substr(6):r.generateIdentifier(),"application"!==f||"DTLS/SCTP"!==u[2]){var h,m,v,g,b,y,w,x,_,C,E,k,T,S=r.parseRtpParameters(o);l||(E=r.getIceParameters(o,a),(k=r.getDtlsParameters(o,a)).role="client"),x=r.parseRtpEncodingParameters(o);var A=r.matchPrefix(o,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];A&&(T=A.value);var P=r.matchPrefix(o,"a=end-of-candidates",a).length>0,O=r.matchPrefix(o,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});if("offer"!==e.type||l)"answer"!==e.type||l||(m=(h=t.transceivers[c]).iceGatherer,v=h.iceTransport,g=h.dtlsTransport,b=h.rtpSender,y=h.rtpReceiver,w=h.sendEncodingParameters,_=h.localCapabilities,t.transceivers[c].recvEncodingParameters=x,t.transceivers[c].remoteCapabilities=S,t.transceivers[c].cname=T,(s||P)&&O.length&&v.setRemoteCandidates(O),t.usingBundle&&0!==c||(v.start(m,E,"controlling"),g.start(k)),t._transceive(h,"sendrecv"===p||"recvonly"===p,"sendrecv"===p||"sendonly"===p),!y||"sendrecv"!==p&&"sendonly"!==p?delete h.rtpReceiver:(C=y.track,i.push([C,y]),n.addTrack(C)));else{var j,D=t.usingBundle&&c>0?{iceGatherer:t.transceivers[0].iceGatherer,iceTransport:t.transceivers[0].iceTransport,dtlsTransport:t.transceivers[0].dtlsTransport}:t._createIceAndDtlsTransports(d,c);if(P&&D.iceTransport.setRemoteCandidates(O),(_=RTCRtpReceiver.getCapabilities(f)).codecs=_.codecs.filter(function(e){return"rtx"!==e.name}),w=[{ssrc:1001*(2*c+2)}],C=(y=new RTCRtpReceiver(D.dtlsTransport,f)).track,i.push([C,y]),n.addTrack(C),t.localStreams.length>0&&t.localStreams[0].getTracks().length>=c)"audio"===f?j=t.localStreams[0].getAudioTracks()[0]:"video"===f&&(j=t.localStreams[0].getVideoTracks()[0]),j&&(b=new RTCRtpSender(j,D.dtlsTransport));t.transceivers[c]={iceGatherer:D.iceGatherer,iceTransport:D.iceTransport,dtlsTransport:D.dtlsTransport,localCapabilities:_,remoteCapabilities:S,rtpSender:b,rtpReceiver:y,kind:f,mid:d,cname:T,sendEncodingParameters:w,recvEncodingParameters:x},t._transceive(t.transceivers[c],!1,"sendrecv"===p||"sendonly"===p)}}else t.transceivers[c]={mid:d,isDatachannel:!0}}),this.remoteDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return n.getTracks().length&&(t.remoteStreams.push(n),window.setTimeout(function(){var e=new Event("addstream");e.stream=n,t.dispatchEvent(e),null!==t.onaddstream&&window.setTimeout(function(){t.onaddstream(e)},0),i.forEach(function(r){var i=r[0],o=r[1],a=new Event("track");a.track=i,a.receiver=o,a.streams=[n],t.dispatchEvent(e),null!==t.ontrack&&window.setTimeout(function(){t.ontrack(a)},0)})},0)),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var e=new Event("negotiationneeded");this.dispatchEvent(e),null!==this.onnegotiationneeded&&this.onnegotiationneeded(e)},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++,t[e.dtlsTransport.state]++}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0||t.checking>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":(t.connected>0||t.completed>0)&&(e="connected"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this.dispatchEvent(n),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(n)}},window.RTCPeerConnection.prototype.createOffer=function(){var e,t=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");1===arguments.length&&"function"!=typeof arguments[0]?e=arguments[0]:3===arguments.length&&(e=arguments[2]);var n=[],i=0,o=0;if(this.localStreams.length&&(i=this.localStreams[0].getAudioTracks().length,o=this.localStreams[0].getVideoTracks().length),e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(i=e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(o=e.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){n.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?i>0:o>0}),"audio"===e.kind?i--:"video"===e.kind&&o--});i>0||o>0;)i>0&&(n.push({kind:"audio",wantReceive:!0}),i--),o>0&&(n.push({kind:"video",wantReceive:!0}),o--);var a=r.writeSessionBoilerplate(),s=[];n.forEach(function(e,n){var i,o,a=e.track,c=e.kind,u=r.generateIdentifier(),f=t.usingBundle&&n>0?{iceGatherer:s[0].iceGatherer,iceTransport:s[0].iceTransport,dtlsTransport:s[0].dtlsTransport}:t._createIceAndDtlsTransports(u,n),l=RTCRtpSender.getCapabilities(c);l.codecs=l.codecs.filter(function(e){return"rtx"!==e.name}),l.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1")});var p=[{ssrc:1001*(2*n+1)}];a&&(i=new RTCRtpSender(a,f.dtlsTransport)),e.wantReceive&&(o=new RTCRtpReceiver(f.dtlsTransport,c)),s[n]={iceGatherer:f.iceGatherer,iceTransport:f.iceTransport,dtlsTransport:f.dtlsTransport,localCapabilities:l,remoteCapabilities:null,rtpSender:i,rtpReceiver:o,kind:c,mid:u,sendEncodingParameters:p,recvEncodingParameters:null}}),this.usingBundle&&(a+="a=group:BUNDLE "+s.map(function(e){return e.mid}).join(" ")+"\r\n"),n.forEach(function(e,n){var i=s[n];a+=r.writeMediaSection(i,i.localCapabilities,"offer",t.localStreams[0])}),this._pendingOffer=s;var c=new RTCSessionDescription({type:"offer",sdp:a});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,c),Promise.resolve(c)},window.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t=r.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n){if(n.isDatachannel)t+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+n.mid+"\r\n";else{var i=e._getCommonCapabilities(n.localCapabilities,n.remoteCapabilities);t+=r.writeMediaSection(n,i,"answer",e.localStreams[0])}});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){if(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var i=this.transceivers[t];if(i){var o=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===o.protocol&&(0===o.port||9===o.port))return;if("1"!==o.component)return;"endOfCandidates"===o.type&&(o={}),i.iceTransport.addRemoteCandidate(o);var a=r.splitSections(this.remoteDescription.sdp);a[t+1]+=(o.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=a.join("")}}else this.transceivers.forEach(function(e){e.iceTransport.addRemoteCandidate({})});return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(n){var r=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){r.set(t,e[t]),r[t]=e[t]})}),t&&window.setTimeout(t,0,r),n(r)})})}}};t.exports={shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":65,"./getusermedia":61,sdp:53}],61:[function(e,t,n){"use strict";t.exports=function(){var e=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return e(t).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],62:[function(e,t,n){"use strict";var r=e("../utils").browserDetails,i={shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(r.version<38&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var s={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(s.username=o.username,s.credential=o.credential),n.push(s)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;if(RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())},r.version<48){var t=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,n,r){return t.apply(this,[e||null]).then(function(e){return function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t}(e)}).then(n,r)}}}}};t.exports={shimOnTrack:i.shimOnTrack,shimSourceObject:i.shimSourceObject,shimPeerConnection:i.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":65,"./getusermedia":63}],63:[function(e,t,n){"use strict";var r=e("../utils").log,i=e("../utils").browserDetails;t.exports=function(){var e=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),i.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:function(e){return new Promise(function(n,r){t(e,n,r)})},addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},i.version<41){var n=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return n().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(i.version<49){var o=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return o(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){if(i.version<44)return t(e,n,r);console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),navigator.mediaDevices.getUserMedia(e).then(n,r)}}},{"../utils":65}],64:[function(e,t,n){"use strict";var r={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};t.exports={shimGetUserMedia:r.shimGetUserMedia}},{}],65:[function(e,t,n){"use strict";var r=!0,i={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={browser:null,version:null};if("undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1)}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2)}return e}};t.exports={log:i.log,disableLog:i.disableLog,browserDetails:i.detectBrowser(),extractVersion:i.extractVersion}},{}],66:[function(e,t,n){t.exports=function(e){return e({vert:"\n      precision highp float;\n      attribute vec3 vert1, vert2, offset;\n      uniform vec3 scale;\n      uniform mat4 uProjectionView;\n      void main () {\n        gl_Position = uProjectionView * vec4(scale * (vert1 + (vert2 - vert1) * offset - vec3(0, 0.5, 0.5)) + vec3(0, 0.5, 0.5), 1);\n      }",frag:"\n      precision highp float;\n      uniform vec4 color;\n      void main () {\n        gl_FragColor = color;\n      }",blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1}},depth:{enable:!0,mask:!1},attributes:{offset:{buffer:e.buffer(new Uint8Array([0,0,0,1,0,0,0,0,1,1,0,1,0,1,0,1,1,0,0,1,1,1,1,1,0,0,0,0,1,0,1,0,0,1,1,0,0,0,1,0,1,1,1,0,1,1,1,1,0,0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1,1,1,1,0,1,1,1])),divisor:0},vert1:{buffer:e.prop("aabbs"),offset:0,stride:24,divisor:1},vert2:{buffer:e.prop("aabbs"),offset:12,stride:24,divisor:1}},uniforms:{color:function(e,t){return t.color||[1,.2,.3,1]},scale:e.prop("scale")},primitive:"lines",instances:e.prop("count"),count:24})}},{}],67:[function(e,t,n){var r=e("getusermedia");t.exports=function(e){r({video:{width:640,height:480},audio:!1},function(t,n){if(t)return e&&e(t);var r=document.createElement("video");r.srcObject=n,r.addEventListener("loadedmetadata",function(){return r.play(),e&&e(null,r)})})}},{getusermedia:24}],68:[function(e,t,n){"use strict";var r=e("./regl-turntable-camera"),i=e("./interactions"),o=e("./texture-lookup-table"),a=e("fail-nicely"),s=e("./get-webcam"),c=e("controls-state"),u=e("controls-gui");"rreusser.github.io"===window.location.host&&"https:"!==window.location.protocol&&(window.location="https://rreusser.github.io/webcam-kmeans/");var f="\n  vec3 fromColorspace (vec3 yuv, float uvScale) {\n    // Careful. I fudged the colorspace to get things geometrically nice.\n    yuv.x += 0.5 / uvScale;\n    yuv.yz -= 0.5;\n    yuv.x *= uvScale;\n    return vec3(\n      yuv.x + yuv.z * 1.4,\n      yuv.x + yuv.y * -0.343 + yuv.z * -0.711,\n      yuv.x + yuv.y * 1.765\n    );\n  }\n",l="\n  vec3 toColorspace (vec3 rgb, float uvScale) {\n    // Careful. I fudged the colorspace to get things geometrically nice.\n    return vec3 (\n      (rgb.r * 0.299 + rgb.g * 0.587 + rgb.b * 0.114) / uvScale - 0.5 / uvScale,\n      (rgb.r * -0.169 + rgb.g * -0.331 + rgb.b * 0.5) + 0.5,\n      (rgb.r * 0.5 + rgb.g * -0.419 + rgb.b * -0.081) + 0.5\n    );\n  }\n",p="\n  vec3 toColorspace (vec3 rgb, float uvScale) {\n    rgb.x -= 0.5;\n    return rgb;\n  }\n",d="\n  vec3 fromColorspace (vec3 rgb, float uvScale) {\n    rgb.x += 0.5;\n    return rgb;\n  }\n",h=document.createElement("div");h.id="container",h.style.width="640px",h.style.height="540px",document.body.appendChild(h),e("insert-css")("\n@import url('https://fonts.googleapis.com/css?family=Fira+Sans+Condensed');\n\n.sketch-nav {\n  right: auto !important;\n  left: 0 !important;\n}\n\nbody, html {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  background-color: rgba(20, 20, 20, 1);\n}\n"),e("regl")({pixelRatio:Math.min(window.devicePixelRatio,1.5,2),extensions:["ANGLE_instanced_arrays","OES_texture_float"],attributes:{antialias:!1,stencil:!1,alpha:!1},onDone:a(function(t){return s(a(function(n){return function(t,n){t._gl.canvas.width,t._gl.canvas.height;var a=640,s=480,h=u(c({hi:c.Raw(function(e){return e("p",{style:"max-width: 270px"},"K-means in WebGL using ",e("a",{href:"https://en.wikipedia.org/wiki/Lloyd%27s_algorithm"},"Lloyd's Algorithm"),".")}),k:c.Slider(5,{min:2,max:20,label:"k"}).onChange(function(e){return x(h.k,h.colorSpace)}),colorSpace:c.Select("YUV",{options:["YUV","RGB"],label:"Color space"}).onChange(function(e){return x(h.k,h.colorSpace)}),uvScale:c.Slider(.5,{min:.01,max:1,step:.01,label:"Y scale"}),labelOpacity:c.Slider(.4,{min:0,max:1,step:.01,label:"Label opacity"}),fullPageVideo:c.Checkbox(!1,{label:"Full size video"})}),{containerCSS:"position:absolute; top:0; right:8px; min-width:300px; max-width:100%",theme:{fontFamily:"'Fira Sans Condensed', sans-serif"}});function m(e){return{fullPageVideo:e.fullPageVideo?1:0,labelOpacity:e.labelOpacity}}var v=m(h);var g=r(t,{center:[0,.5,.5],distance:1.5,phi:.3,theta:.3});i(g);var b=t.texture({data:n,flipY:!0,width:a,height:s}),y=new Array(2).fill(0).map(function(){return t.texture({type:"float",format:"rgba",width:h.k,height:1})}),w=y.map(function(e){return t.framebuffer({color:e})});function x(e){var t=C.length;if(e<C.length)C.length=e;else if(e>C.length)for(var n=t;n<e;n++)C[n]=[Math.random(),Math.random(),Math.random()];for(var n=0;n<y.length;n++)y[n]=y[n]({type:"float",format:"rgba",width:e,height:1}),w[n]=w[n]({color:y[n]});j=new Float32Array(4*e),D=D(j)}var _=function(e){for(var n={},r=0;r<e;r++)n["mean"+r]=t.prop("means["+r+"]");return n},C=(T=h.k,new Array(T).fill(0).map(function(e,t){return[Math.random(),Math.random(),Math.random()]})),E=o(a,s),k=t.buffer([-.5,0,0,.5,1,1]);var T;var S=t({viewport:{y:100},scissor:{enable:!0,box:{y:100}}}),A=e("./draw-aabbs")(t),P={},O={};var j=new Float32Array(4*h.k),D=t.buffer(j),R=-1/60,B=t.frame(function(e){e.tick;var r,i,o,c=e.time;try{var u=C.length,y=(r=u,i=h.colorSpace,(o="YUV"===i?O:P)[r]?o[r]:(o[r]={drawToScreen:t({vert:"\n          precision highp float;\n          attribute vec2 aUV;\n          uniform sampler2D src;//, uColorscale;\n          uniform mat4 uProjectionView;\n          uniform float uvScale, uLabel, uPointSize;\n          uniform vec2 uAspect;\n          uniform float uDisplayVideo;\n          varying vec3 vRGB, vMeanRGB;\n          "+new Array(r).fill(0).map(function(e,t){return"uniform vec3 mean"+t+";"}).join("\n")+"\n\n          "+("YUV"===i?l:p)+"\n          "+("YUV"===i?f:d)+"\n\n          float len (vec3 a, vec3 b) {\n            vec3 dx = a - b;\n            return dot(dx, dx);\n          }\n\n          void main () {\n            vRGB = texture2D(src, aUV).xyz;\n            vec3 yuv = toColorspace(vRGB, uvScale);\n\n            vec3 meanYUV = vec3(0);\n            float minLength = 10000.0;\n            float minIndex = -1.0;\n            float l;\n\n            "+new Array(r).fill(0).map(function(e,t){return"\n              if ((l = len(yuv, mean"+t+")) < minLength) {\n                meanYUV = mean"+t+";\n                minLength = l;\n                minIndex = "+t+".0;\n              }\n            "}).join("")+"\n\n            vMeanRGB = fromColorspace(meanYUV, uvScale);\n\n            vRGB = mix(vRGB, vMeanRGB, uLabel);\n\n            gl_Position = mix(\n              uProjectionView * vec4(yuv, 1),\n              vec4(\n                (vec2(-1, 1) * (aUV * 2.0 - 1.0)) * uAspect,\n                0.99, 1\n              ),\n              uDisplayVideo\n            );\n            gl_PointSize = uPointSize;\n          }\n        ",frag:"\n          precision highp float;\n          varying vec3 vRGB;\n          void main () {\n            gl_FragColor = vec4(vRGB, 1);\n          }\n        ",attributes:{aUV:t.buffer(E)},blend:{enable:!1,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"}},uniforms:Object.assign({uAspect:function(e){var t=a/s,n=window.innerWidth/(window.innerHeight-100);return t>n?[1,n/t]:[t/n,1]},uPointSize:function(e){return 2*e.pixelRatio},src:t.prop("video"),uDisplayVideo:t.prop("fullPageVideo"),uvScale:function(){return 1/h.uvScale},uLabel:function(){return v.labelOpacity}},_(r)),primitive:"points",depth:{enable:!0},count:a*s}),accumulate:t({vert:"\n          precision highp float;\n          attribute vec2 aUV;\n          uniform sampler2D src;\n          "+new Array(r).fill(0).map(function(e,t){return"uniform vec3 mean"+t+";"}).join("\n")+"\n          varying vec3 vYUV;\n          uniform float uvScale;\n          const float k = "+r+".0;\n\n          "+("YUV"===i?l:p)+"\n\n          float len (vec3 a, vec3 b) {\n            vec3 dx = a - b;\n            return dot(dx, dx);\n          }\n\n          void main () {\n            vYUV = toColorspace(texture2D(src, aUV).xyz, uvScale);\n\n            float minLength = 10000.0;\n            float minIndex = -1.0;\n            float l;\n            "+new Array(r).fill(0).map(function(e,t){return"\n              if ((l = len(vYUV, mean"+t+")) < minLength) { minLength = l; minIndex = "+t+".0; }\n            "}).join("")+"\n\n            gl_Position = vec4((minIndex + 0.5) / k * 2.0 - 1.0, 0.0, 0.0, 1.0);\n            gl_PointSize = 1.0;\n          }\n        ",frag:"\n          precision highp float;\n          varying vec3 vYUV;\n          void main () {\n            gl_FragColor = vec4(vYUV, 1);\n          }\n        ",blend:{enable:!0,func:{srcRGB:1,srcAlpha:1,dstRGB:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"}},attributes:{aUV:t.buffer(E)},uniforms:Object.assign({src:t.prop("video"),uvScale:function(){return 1/h.uvScale}},_(r)),primitive:"points",framebuffer:w[0],depth:{enable:!1},count:a*s}),drawMeansToScreen:t({vert:"\n          precision highp float;\n          attribute vec4 aColor;\n          uniform float uvScale, uPointSize;\n          varying vec3 vRGB;\n          uniform mat4 uProjectionView;\n\n          "+("YUV"===i?f:d)+"\n\n          void main () {\n            vec3 yuv = aColor.xyz;\n            vRGB = fromColorspace(yuv, uvScale);\n            gl_Position = uProjectionView * vec4(yuv, 1);\n            gl_PointSize = uPointSize;\n          }\n        ",frag:"\n          precision highp float;\n          varying vec3 vRGB;\n          void main () {\n            vec2 dx = gl_PointCoord.xy - 0.5;\n            float r = dot(dx, dx) * 4.0;\n            gl_FragColor = vec4(mix(\n              vRGB,\n              vec3(1, 0, 0),\n              smoothstep(0.3, 1.0, r)\n            ), smoothstep(1.0, 0.7, r));\n          }\n        ",attributes:{aColor:t.prop("buffer")},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"}},uniforms:{uPointSize:function(e){return 15*e.pixelRatio},uDisplayVideo:t.prop("fullPageVideo"),uvScale:function(){return 1/h.uvScale}},primitive:"points",depth:{enable:!1},count:r}),debugMeans:t({vert:"\n          precision highp float;\n          attribute vec2 xy;\n          attribute float kIndex;\n          attribute vec4 mean;\n          uniform float k;\n          uniform float uvScale;\n          varying vec3 vRGB;\n\n          "+("YUV"===i?f:d)+"\n\n          void main () {\n            vRGB = fromColorspace(mean.rgb, uvScale);\n            vec2 uv = xy;\n            uv.x += kIndex;;\n            uv.x /= k;\n            uv = uv * 2.0 - 1.0;\n            gl_Position = vec4(uv, 0, 1);\n          }\n        ",frag:"\n          precision highp float;\n          varying vec3 vRGB;\n          void main () {\n            gl_FragColor = vec4(vRGB, 1);\n          }\n        ",attributes:{xy:[0,0,1,0,0,1,1,1],kIndex:{buffer:new Uint8Array(new Array(r).fill(0).map(function(e,t){return t})),divisor:1},mean:{buffer:t.prop("means"),divisor:1}},uniforms:{uvScale:function(){return 1/h.uvScale},k:r},primitive:"triangle strip",depth:{enable:!1},instances:r,count:4,viewport:{height:100},scissor:{enable:!0,box:{height:100}}}),drawVideo:t({vert:"\n          precision highp float;\n          attribute vec2 aUV;\n          varying vec2 vUV;\n          uniform vec2 uAspect;\n          uniform vec2 uShift;\n          uniform float uScale;\n          void main () {\n            vUV = aUV ;\n            gl_Position = vec4((aUV + uShift) * uAspect * uScale - vec2(1, -1), 0, 1);\n          }\n        ",frag:"\n          precision highp float;\n          varying vec2 vUV;\n          uniform sampler2D src;\n          uniform float uvScale, uLabel;\n          uniform float uOpacity;\n\n          "+new Array(r).fill(0).map(function(e,t){return"uniform vec3 mean"+t+";"}).join("\n")+"\n\n          "+("YUV"===i?l:p)+"\n          "+("YUV"===i?f:d)+"\n\n          float len (vec3 a, vec3 b) {\n            vec3 dx = a - b;\n            return dot(dx, dx);\n          }\n\n          void main () {\n            vec3 rgb = texture2D(src, vec2(1.0 - vUV.x, vUV.y)).xyz;\n            vec3 yuv = toColorspace(rgb, uvScale);\n\n            float minLength = 10000.0;\n            float minIndex = -1.0;\n            vec3 meanYUV = vec3(0);\n            float l;\n\n            "+new Array(r).fill(0).map(function(e,t){return"\n              if ((l = len(yuv, mean"+t+")) < minLength) {\n                meanYUV = mean"+t+";\n                minLength = l;\n                minIndex = "+t+".0;\n              }\n            "}).join("")+"\n\n            vec3 meanRGB = fromColorspace(meanYUV, uvScale);\n\n            rgb = mix(rgb, meanRGB, uLabel);\n\n            gl_FragColor = vec4(rgb, uOpacity);\n          }\n        ",attributes:{aUV:[1,0,1,1,0,0,0,1]},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"}},uniforms:Object.assign({uShift:t.prop("shift"),uAspect:function(e,t){return[window.innerHeight/window.innerWidth,s/a]},src:t.prop("src"),uPointSize:function(e){return 2*e.pixelRatio},uOpacity:function(e,t){return 1-t.fullPageVideo},uvScale:function(){return 1/h.uvScale},uLabel:t.prop("labelOpacity"),uScale:t.prop("scale")},_(r)),primitive:"triangle strip",depth:{enable:!1},count:4})},o[r])),x=c-R;!function(e,t,n){var r=Math.exp(-n/.15);e||(e=m(t));e.fullPageVideo=e.fullPageVideo*r+t.fullPageVideo*(1-r),e.labelOpacity=e.labelOpacity*r+t.labelOpacity*(1-r)}(v,h,x),b.subimage(n),w[0].use(function(){t.clear({color:[0,0,0,0]}),y.accumulate({video:b,means:C}),t.read(j)}),function(e){var t=e.length/4,n=-1,r=!1;for(;!r;){r=!0;for(var i=0,o=0;i<t;i++,o+=4)if(e[o+3])n=i,e[o]/=e[o+3],e[o+1]/=e[o+3],e[o+2]/=e[o+3],e[o+3]=1;else if(r=!1,n>=0){var a=4*n;e[o]=e[a]+.001*(Math.random()-.5),e[o+1]=e[a+1]+.001*(Math.random()-.5),e[o+2]=e[a+2]+.001*(Math.random()-.5),e[o+3]=1}}}(j);for(var T=Math.exp(-x/.01),M=0,L=0;M<u;M++,L+=4)j[L]=C[M][0]=T*C[M][0]+(1-T)*j[L],j[L+1]=C[M][1]=T*C[M][1]+(1-T)*j[L+1],j[L+2]=C[M][2]=T*C[M][2]+(1-T)*j[L+2];D.subdata(j),g.tick(),g.setUniforms(function(){S(function(){t.clear({color:[.12,.12,.12,1]}),y.drawToScreen({video:b,fullPageVideo:v.fullPageVideo,means:C}),y.drawMeansToScreen({buffer:D,count:u}),A({aabbs:k,count:1,color:[1,1,1,1],scale:"YUV"===h.colorSpace?[h.uvScale,1,1]:[1,1,1]})}),y.debugMeans({means:D})}),v.fullPageVideo<.99999&&(y.drawVideo({shift:[0,-2],fullPageVideo:v.fullPageVideo,src:b,means:C,labelOpacity:1,scale:.75}),y.drawVideo({shift:[0,-1],fullPageVideo:v.fullPageVideo,src:b,means:C,labelOpacity:0,scale:.75})),R=c}catch(e){throw B.cancel(),e}})}(t,n)}))})})},{"./draw-aabbs":66,"./get-webcam":67,"./interactions":69,"./regl-turntable-camera":70,"./texture-lookup-table":71,"controls-gui":4,"controls-state":5,"fail-nicely":23,"insert-css":46,regl:52}],69:[function(e,t,n){"use strict";var r=e("gl-vec3/transformMat4"),i=e("normalized-interaction-events"),o=e("assert");t.exports=function(e,t){t=t||{};var n=e.element,s=null,c=null,u=null,f={defaultPrevented:!1};function l(){f.defaultPrevented=!1}function p(e){return e.defaultPrevented=f.defaultPrevented,e.preventDefault=function(){e.defaultPrevented=!0,f.defaultPrevented=!0},e}var d=[0,0,0],h=[0,0];return i(n).on("wheel",function(t){t.originalEvent.preventDefault(),e.zoom(t.x0,t.y0,Math.exp(-t.dy)-1)}).on("mousedown",function(e){l(),e=p(e),s&&s(e),e.originalEvent.preventDefault()}).on("mousemove",function(t){t=p(t),u&&u(t),t.defaultPrevented||t.active&&1===t.buttons&&(t.mods.alt?(e.zoom(t.x0,t.y0,Math.exp(t.dy)-1),t.originalEvent.preventDefault()):t.mods.shift?(e.pan(t.dx,t.dy),t.originalEvent.preventDefault()):t.mods.meta?(e.pivot(t.dx,t.dy),t.originalEvent.preventDefault()):(e.rotate(-t.dx*a,-t.dy*a),t.originalEvent.preventDefault()))}).on("mouseup",function(e){e.originalEvent.preventDefault(),l(),e=p(e),c&&c(e)}).on("touchstart",function(e){e.originalEvent.preventDefault(),e=p(e),s&&s(e)}).on("touchmove",function(t){t=p(t),u&&u(t),t.defaultPrevented||t.active&&(e.rotate(-t.dx*a,-t.dy*a),t.originalEvent.preventDefault())}).on("touchend",function(e){e.originalEvent.preventDefault(),l(),e=p(e),c&&c(e)}).on("pinchmove",function(n){n.active&&(function(e){d[0]=e.x,d[1]=e.y,d[2]=0,t.invViewportShift&&r(d,d,invViewportShift),h[0]=d[0],h[1]=d[1]}(n),e.zoom(h[0],h[1],1-n.zoomx),e.pan(n.dx,n.dy),n.originalEvent.preventDefault())}).on("pinchstart",function(e){e.originalEvent.preventDefault()}),s=t.onStart,u=t.onMove,c=t.onEnd,{setInteractions:function(e){o(e),s=e.onStart,c=e.onEnd,u=e.onMove}}};var a=.75*Math.PI},{assert:1,"gl-vec3/transformMat4":27,"normalized-interaction-events":50}],70:[function(e,t,n){"use strict";var r=e("gl-mat4/create"),i=e("gl-mat4/multiply"),o=e("inertial-turntable-camera");e("normalized-interaction-events"),Math.PI;t.exports=function(e,t){var n=e._gl.canvas;function a(){return n.clientWidth/n.clientHeight}var s=o(Object.assign({},{aspectRatio:a()},t||{})),c=r(),u=e({context:{projection:function(){return s.state.projection},view:function(){return s.state.view},viewInv:function(){return s.state.viewInv},eye:function(){return s.state.eye}},uniforms:{uProjectionView:function(e){return i(c,e.projection,e.view)},uView:e.context("view"),uEye:e.context("eye")}});function f(e,t){t||(t=e,e={}),s.tick(e),u(function(){t(s.state,s.params)})}return f.taint=s.taint,f.resize=s.resize,f.tick=s.tick,f.setUniforms=u,f.rotate=s.rotate,f.pan=s.pan,f.pivot=s.pivot,f.zoom=s.zoom,Object.defineProperties(f,{state:{get:function(){return s.state},set:function(e){s.state=e}},params:{get:function(){return s.params},set:function(e){s.params=e}},element:{get:function(){return n}}}),window.addEventListener("resize",function(){s.resize(a())},!1),f}},{"gl-mat4/create":25,"gl-mat4/multiply":26,"inertial-turntable-camera":30,"normalized-interaction-events":50}],71:[function(e,t,n){t.exports=function(e,t,n){for(var r=e*t*(n=n||2),i=new Float32Array(r),o=0,a=0;a<r;o++,a+=n)i[a]=(o%e+.5)/e,i[a+1]=(.5+(o/e|0))/t;return i}},{}]},{},[68]);